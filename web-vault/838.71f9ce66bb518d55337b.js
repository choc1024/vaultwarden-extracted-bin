"use strict";(self.webpackChunk_bitwarden_web_vault=self.webpackChunk_bitwarden_web_vault||[]).push([[838],{47064:function(e,i,t){t.d(i,{G:function(){return d}});var n=t(58691),o=t(85762),l=t(8111),s=t(99721),r=t(78627),c=t(4871),a=function(e,i,t,n){return new(t||(t=Promise))((function(o,l){function s(e){try{c(n.next(e))}catch(i){l(i)}}function r(e){try{c(n.throw(e))}catch(i){l(i)}}function c(e){var i;e.done?o(e.value):(i=e.value,i instanceof t?i:new t((function(e){e(i)}))).then(s,r)}c((n=n.apply(e,i||[])).next())}))};class d{constructor(e,i,t,n,o){this.router=e,this.organizationService=i,this.platformUtilsService=t,this.i18nService=n,this.syncService=o}canActivate(e,i){var t;return a(this,void 0,void 0,(function*(){null==(yield this.syncService.getLastSync())&&(yield this.syncService.fullSync(!1));const o=yield this.organizationService.get(e.params.organizationId);if(null==o)return this.router.createUrlTree(["/"]);if(!o.isOwner&&!o.enabled)return this.platformUtilsService.showToast("error",null,this.i18nService.t("organizationIsDisabled")),this.router.createUrlTree(["/"]);const l=null===(t=e.data)||void 0===t?void 0:t.organizationPermissions;if(!(null==l||l(o))){const e=i.root.queryParamMap.get("itemId")||i.root.queryParamMap.get("cipherId");return e?this.router.createUrlTree(["/vault"],{queryParams:{itemId:e}}):(this.platformUtilsService.showToast("error",null,this.i18nService.t("accessDenied")),(0,n.gW)(o)?this.router.createUrlTree(["/organizations",o.id]):this.router.createUrlTree(["/"]))}return!0}))}}d.ɵfac=function(e){return new(e||d)(o.LFG(l.F0),o.LFG(n.Mn),o.LFG(s.P),o.LFG(r.D),o.LFG(c._))},d.ɵprov=o.Yz7({token:d,factory:d.ɵfac,providedIn:"root"})},56992:function(e,i,t){t.d(i,{S:function(){return r}});var n=t(58691),o=t(85762),l=t(8111),s=function(e,i,t,n){return new(t||(t=Promise))((function(o,l){function s(e){try{c(n.next(e))}catch(i){l(i)}}function r(e){try{c(n.throw(e))}catch(i){l(i)}}function c(e){var i;e.done?o(e.value):(i=e.value,i instanceof t?i:new t((function(e){e(i)}))).then(s,r)}c((n=n.apply(e,i||[])).next())}))};class r{constructor(e,i){this.router=e,this.organizationService=i}canActivate(e,i){var t;return s(this,void 0,void 0,(function*(){const o=yield this.organizationService.get(e.params.organizationId),l=null===(t=e.data)||void 0===t?void 0:t.autoRedirectCallback;if(l){let e=l(o);return"string"==typeof e&&(e=[e]),this.router.createUrlTree([i.url,...e])}return(0,n.gW)(o)?this.router.createUrlTree(["/organizations",o.id]):this.router.createUrlTree(["/"])}))}}r.ɵfac=function(e){return new(e||r)(o.LFG(l.F0),o.LFG(n.Mn))},r.ɵprov=o.Yz7({token:r,factory:r.ɵfac,providedIn:"root"})},33287:function(e,i,t){t.d(i,{Z:function(){return P}});var n=t(28783),o=t(19576),l=t(53883),s=t(2138),r=t(69269),c=t(71146),a=t(85762),d=t(55602),u=t(78627),h=t(99721),p=t(66459),g=t(47244),f=t(65071),m=t(14494),b=t(28508),v=t(33245),U=t(98205),A=t(46246),C=t(36338),Z=t(81974),x=t(29465),w=t(18362),_=t(11512),y=t(54735),T=t(50941),S=t(26361),I=t(82933),q=function(e,i,t,n){return new(t||(t=Promise))((function(o,l){function s(e){try{c(n.next(e))}catch(i){l(i)}}function r(e){try{c(n.throw(e))}catch(i){l(i)}}function c(e){var i;e.done?o(e.value):(i=e.value,i instanceof t?i:new t((function(e){e(i)}))).then(s,r)}c((n=n.apply(e,i||[])).next())}))};function z(e,i){if(1&e&&(a.TgZ(0,"small",18),a._uU(1),a.qZA()),2&e){const e=a.oxw();a.xp6(1),a.Oqu(e.name)}}function E(e,i){1&e&&(a.TgZ(0,"div"),a._uU(1),a.ALo(2,"i18n"),a.qZA()),2&e&&(a.xp6(1),a.hij("\n      ",a.lcZ(2,1,"noEventsInList"),"\n    "))}function M(e,i){1&e&&(a.TgZ(0,"th",21),a._uU(1),a.ALo(2,"i18n"),a.qZA()),2&e&&(a.xp6(1),a.Oqu(a.lcZ(2,1,"member")))}function F(e,i){if(1&e&&(a.TgZ(0,"td",21),a._uU(1,"\n            "),a.TgZ(2,"span",29),a._uU(3),a.qZA(),a._uU(4,"\n          "),a.qZA()),2&e){const e=a.oxw().$implicit;a.xp6(2),a.s9C("appA11yTitle",e.userEmail),a.xp6(1),a.Oqu(e.userName)}}function J(e,i){if(1&e&&(a.TgZ(0,"tr",26),a._uU(1,"\n          "),a.TgZ(2,"td",21),a._uU(3),a.ALo(4,"date"),a.qZA(),a._uU(5,"\n          "),a.TgZ(6,"td",21),a._uU(7,"\n            "),a._UZ(8,"i",27),a._uU(9,"\n            "),a.TgZ(10,"span",22),a._uU(11),a.qZA(),a._uU(12,"\n          "),a.qZA(),a._uU(13,"\n          "),a.YNc(14,F,5,2,"td",23),a._uU(15,"\n          "),a._UZ(16,"td",28),a._uU(17,"\n        "),a.qZA()),2&e){const e=i.$implicit,t=a.oxw(3);a.xp6(3),a.Oqu(a.xi3(4,10,e.date,"medium")),a.xp6(5),a.Gre("tw-text-muted bwi bwi-lg ",e.appIcon,""),a.hYB("title","",e.appName,", ",e.ip,""),a.xp6(3),a.AsE("",e.appName,", ",e.ip,""),a.xp6(3),a.Q6J("ngIf",t.showUser),a.xp6(2),a.Q6J("innerHTML",e.message,a.oJD)}}function L(e,i){if(1&e&&(a._uU(0,"\n        "),a.YNc(1,J,18,13,"tr",25),a.ALo(2,"async"),a._uU(3,"\n      ")),2&e){const e=i.$implicit;a.xp6(1),a.Q6J("ngForOf",a.lcZ(2,1,e))}}function Y(e,i){if(1&e&&(a.TgZ(0,"bit-table",19),a._uU(1,"\n      "),a.ynx(2,20),a._uU(3,"\n        "),a.TgZ(4,"tr"),a._uU(5,"\n          "),a.TgZ(6,"th",21),a._uU(7),a.ALo(8,"i18n"),a.qZA(),a._uU(9,"\n          "),a.TgZ(10,"th",21),a._uU(11,"\n            "),a.TgZ(12,"span",22),a._uU(13),a.ALo(14,"i18n"),a.qZA(),a._uU(15,"\n          "),a.qZA(),a._uU(16,"\n          "),a.YNc(17,M,3,3,"th",23),a._uU(18,"\n          "),a.TgZ(19,"th",21),a._uU(20),a.ALo(21,"i18n"),a.qZA(),a._uU(22,"\n        "),a.qZA(),a._uU(23,"\n      "),a.BQk(),a._uU(24,"\n      "),a.YNc(25,L,4,3,"ng-template",24),a._uU(26,"\n    "),a.qZA()),2&e){const e=a.oxw();a.Q6J("dataSource",e.dataSource),a.xp6(7),a.Oqu(a.lcZ(8,5,"timestamp")),a.xp6(6),a.Oqu(a.lcZ(14,7,"client")),a.xp6(4),a.Q6J("ngIf",e.showUser),a.xp6(3),a.Oqu(a.lcZ(21,9,"event"))}}function k(e,i){if(1&e&&(a.TgZ(0,"button",30),a._uU(1),a.ALo(2,"i18n"),a.qZA()),2&e){const e=a.oxw();a.Q6J("bitAction",e.loadMoreEvents),a.xp6(1),a.hij("\n      ",a.lcZ(2,2,"loadMore"),"\n    ")}}class N{get name(){return this.params.name}get showUser(){var e;return null!==(e=this.params.showUser)&&void 0!==e&&e}constructor(e,i,t,n,o,l,r,c,a,d){this.params=e,this.apiService=i,this.i18nService=t,this.eventService=n,this.platformUtilsService=o,this.userNamePipe=l,this.logService=r,this.organizationUserService=c,this.formBuilder=a,this.validationService=d,this.loading=!0,this.dataSource=new s.G,this.filterFormGroup=this.formBuilder.group({start:[""],end:[""]}),this.orgUsersUserIdMap=new Map,this.orgUsersIdMap=new Map,this.loadMoreEvents=()=>q(this,void 0,void 0,(function*(){yield this.loadEvents(!1)})),this.refreshEvents=()=>q(this,void 0,void 0,(function*(){yield this.loadEvents(!0)}))}ngOnInit(){return q(this,void 0,void 0,(function*(){const e=this.eventService.getDefaultDateFilters();this.filterFormGroup.setValue({start:e[0],end:e[1]}),yield this.load()}))}load(){return q(this,void 0,void 0,(function*(){try{if(this.showUser){(yield this.organizationUserService.getAllUsers(this.params.organizationId)).data.forEach((e=>{const i=this.userNamePipe.transform(e);this.orgUsersIdMap.set(e.id,{name:i,email:e.email}),this.orgUsersUserIdMap.set(e.userId,{name:i,email:e.email})}))}yield this.loadEvents(!0)}catch(e){this.logService.error(e),this.validationService.showError(e)}this.loading=!1}))}loadEvents(e){return q(this,void 0,void 0,(function*(){let i,t=null;try{t=this.eventService.formatDateFilters(this.filterFormGroup.value.start,this.filterFormGroup.value.end)}catch(o){return void this.platformUtilsService.showToast("error",this.i18nService.t("errorOccurred"),this.i18nService.t("invalidDateRange"))}i="user"===this.params.entity&&this.params.providerId?yield this.apiService.getEventsProviderUser(this.params.providerId,this.params.entityId,t[0],t[1],e?null:this.continuationToken):"user"===this.params.entity?yield this.apiService.getEventsOrganizationUser(this.params.organizationId,this.params.entityId,t[0],t[1],e?null:this.continuationToken):yield this.apiService.getEventsCipher(this.params.entityId,t[0],t[1],e?null:this.continuationToken),this.continuationToken=i.continuationToken;const n=yield Promise.all(i.data.map((e=>q(this,void 0,void 0,(function*(){const i=null==e.actingUserId?e.userId:e.actingUserId,t=yield this.eventService.getEventInfo(e),n=this.showUser&&null!=i&&this.orgUsersUserIdMap.has(i)?this.orgUsersUserIdMap.get(i):null;return new l.Y({message:t.message,humanReadableMessage:t.humanReadableMessage,appIcon:t.appIcon,appName:t.appName,userId:i,userName:null!=n?n.name:this.showUser?this.i18nService.t("unknown"):null,userEmail:null!=n?n.email:this.showUser?"":null,date:e.date,ip:e.ipAddress,type:e.type,installationId:e.installationId,systemUser:e.systemUser,serviceAccountId:e.serviceAccountId})})))));!e&&null!=this.dataSource.data&&this.dataSource.data.length>0?this.dataSource.data=this.dataSource.data.concat(n):this.dataSource.data=n}))}}N.ɵfac=function(e){return new(e||N)(a.Y36(n.Kt),a.Y36(d.s),a.Y36(u.D),a.Y36(r.PO),a.Y36(h.P),a.Y36(o.z),a.Y36(p.$),a.Y36(g.t),a.Y36(f.qu),a.Y36(m.R))},N.ɵcmp=a.Xpm({type:N,selectors:[["ng-component"]],standalone:!0,features:[a.jDz],decls:68,vars:28,consts:[["dialogSize","large",3,"loading"],["bitDialogTitle",""],["class","tw-text-muted",4,"ngIf"],["bitDialogContent",""],[3,"formGroup","bitSubmit"],[1,"tw-flex","tw-items-center","tw-space-x-2"],["for","start",1,"tw-sr-only"],["bitInput","","type","datetime-local","id","start","formControlName","start",3,"placeholder"],[1,"tw-mx-2"],["for","end",1,"tw-sr-only"],["bitInput","","type","datetime-local","id","end","formControlName","end",3,"placeholder"],["type","submit","bitButton","","buttonType","primary","bitFormButton",""],["aria-hidden","true",1,"bwi","bwi-refresh","bwi-fw"],[4,"ngIf"],[3,"dataSource",4,"ngIf"],["bitButton","","buttonType","secondary","block","","type","button",3,"bitAction",4,"ngIf"],["bitDialogFooter",""],["bitButton","","buttonType","secondary","type","button","bitDialogClose",""],[1,"tw-text-muted"],[3,"dataSource"],["header",""],["bitCell",""],[1,"tw-sr-only"],["bitCell","",4,"ngIf"],["body",""],["bitRow","",4,"ngFor","ngForOf"],["bitRow",""],["aria-hidden","true",3,"title"],["bitCell","",3,"innerHTML"],[3,"appA11yTitle"],["bitButton","","buttonType","secondary","block","","type","button",3,"bitAction"]],template:function(e,i){1&e&&(a.TgZ(0,"bit-dialog",0),a._uU(1,"\n  "),a.TgZ(2,"span",1),a._uU(3),a.ALo(4,"i18n"),a.YNc(5,z,2,1,"small",2),a._uU(6,"\n  "),a.qZA(),a._uU(7,"\n  "),a.TgZ(8,"div",3),a._uU(9,"\n    "),a.TgZ(10,"form",4),a._uU(11,"\n      "),a.TgZ(12,"div",5),a._uU(13,"\n        "),a.TgZ(14,"div"),a._uU(15,"\n          "),a.TgZ(16,"label",6),a._uU(17),a.ALo(18,"i18n"),a.qZA(),a._uU(19,"\n          "),a.TgZ(20,"span"),a._uU(21,"\n            "),a._UZ(22,"input",7),a.ALo(23,"i18n"),a._uU(24,"\n          "),a.qZA(),a._uU(25,"\n        "),a.qZA(),a._uU(26,"\n        "),a.TgZ(27,"span",8),a._uU(28,"-"),a.qZA(),a._uU(29,"\n        "),a.TgZ(30,"div"),a._uU(31,"\n          "),a.TgZ(32,"label",9),a._uU(33),a.ALo(34,"i18n"),a.qZA(),a._uU(35,"\n          "),a.TgZ(36,"span"),a._uU(37,"\n            "),a._UZ(38,"input",10),a.ALo(39,"i18n"),a._uU(40,"\n          "),a.qZA(),a._uU(41,"\n        "),a.qZA(),a._uU(42,"\n        "),a.TgZ(43,"button",11),a._uU(44,"\n          "),a._UZ(45,"i",12),a._uU(46),a.ALo(47,"i18n"),a.qZA(),a._uU(48,"\n      "),a.qZA(),a._uU(49,"\n    "),a.qZA(),a._uU(50,"\n    "),a._UZ(51,"hr"),a._uU(52,"\n    "),a.YNc(53,E,3,3,"div",13),a._uU(54,"\n    "),a.YNc(55,Y,27,11,"bit-table",14),a._uU(56,"\n    "),a.YNc(57,k,3,4,"button",15),a._uU(58,"\n  "),a.qZA(),a._uU(59,"\n  "),a.ynx(60,16),a._uU(61,"\n    "),a.TgZ(62,"button",17),a._uU(63),a.ALo(64,"i18n"),a.qZA(),a._uU(65,"\n  "),a.BQk(),a._uU(66,"\n"),a.qZA(),a._uU(67,"\n")),2&e&&(a.Q6J("loading",i.loading),a.xp6(3),a.hij("\n    ",a.lcZ(4,14,"eventLogs"),"\n    "),a.xp6(2),a.Q6J("ngIf",i.name),a.xp6(5),a.Q6J("formGroup",i.filterFormGroup)("bitSubmit",i.refreshEvents),a.xp6(7),a.Oqu(a.lcZ(18,16,"startDate")),a.xp6(5),a.s9C("placeholder",a.lcZ(23,18,"startDate")),a.xp6(11),a.Oqu(a.lcZ(34,20,"endDate")),a.xp6(5),a.s9C("placeholder",a.lcZ(39,22,"endDate")),a.xp6(8),a.hij("\n          ",a.lcZ(47,24,"refresh"),"\n        "),a.xp6(7),a.Q6J("ngIf",!i.dataSource.data||!i.dataSource.data.length),a.xp6(2),a.Q6J("ngIf",null==i.dataSource||null==i.dataSource.data?null:i.dataSource.data.length),a.xp6(2),a.Q6J("ngIf",i.continuationToken),a.xp6(6),a.hij("\n      ",a.lcZ(64,26,"close"),"\n    "))},dependencies:[c.m,b.sg,b.O5,f._Y,f.Fj,f.JJ,f.JL,f.sg,f.u,v.B,U.Q,A.b,C.u,Z.r,x.a,w.f,_.G,y.a,T.Y,S.v,y.f,b.Ov,b.uU,I.C],encapsulation:2});const P=(e,i)=>e.open(N,i)},71838:function(e,i,t){t.r(i),t.d(i,{OrganizationModule:function(){return Kn}});var n,o,l=t(71146),s=t(63078),r=t(8111),c=t(66463),a=t(58691),d=t(47064),u=t(56992),h=t(53193),p=t(85762),g=t(59554),f=t(54019),m=t(80060),b=t(30359),v=t(33031),U=t(59260),A=t(59157),C=t(92786),Z=t(68362),x=t(70032),w=t(19887),_=t(5712),y=t(27646),T=t(68134),S=t(54193),I=t(28783),q=t(65071),z=t(84598),E=t(92716),M=t(79596),F=t(59281),J=t(25679),L=t(88409),Y=t(14309),k=t(55602),N=t(47244),P=t(78627),O=t(99721),$=t(66459),D=t(73369),G=t(62357),Q=t(65254),V=t(47724),B=t(28508),R=t(33245),j=t(98205),H=t(46246),K=t(36338),W=t(81974),X=t(29465),ee=t(18362),ie=t(24637),te=t(11512),ne=t(36179),oe=t(44358),le=t(21656),se=t(17731),re=t(26536),ce=t(36689),ae=t(82933),de=function(e,i,t,n){return new(t||(t=Promise))((function(o,l){function s(e){try{c(n.next(e))}catch(i){l(i)}}function r(e){try{c(n.throw(e))}catch(i){l(i)}}function c(e){var i;e.done?o(e.value):(i=e.value,i instanceof t?i:new t((function(e){e(i)}))).then(s,r)}c((n=n.apply(e,i||[])).next())}))};function ue(e,i){if(1&e&&(p.TgZ(0,"span",11),p._uU(1),p.qZA()),2&e){const e=p.oxw();p.xp6(1),p.Oqu(null==e.group?null:e.group.name)}}function he(e,i){1&e&&(p.TgZ(0,"div"),p._uU(1,"\n        "),p._UZ(2,"i",12),p.ALo(3,"i18n"),p._uU(4,"\n        "),p.TgZ(5,"span",13),p._uU(6),p.ALo(7,"i18n"),p.qZA(),p._uU(8,"\n      "),p.qZA()),2&e&&(p.xp6(2),p.s9C("title",p.lcZ(3,2,"loading")),p.xp6(4),p.Oqu(p.lcZ(7,4,"loading")))}function pe(e,i){1&e&&(p.TgZ(0,"span"),p._uU(1),p.ALo(2,"i18n"),p.qZA()),2&e&&(p.xp6(1),p.hij("\n              ",p.lcZ(2,1,"restrictedGroupAccessDesc"),"\n            "))}function ge(e,i){1&e&&(p.TgZ(0,"span"),p._uU(1),p.ALo(2,"i18n"),p.qZA()),2&e&&(p.xp6(1),p.hij("\n              ",p.lcZ(2,1,"restrictedCollectionAssignmentDesc"),"\n            "))}function fe(e,i){1&e&&(p.TgZ(0,"div",20),p._uU(1,"\n            "),p._UZ(2,"input",21),p._uU(3,"\n            "),p.TgZ(4,"label",22),p._uU(5),p.ALo(6,"i18n"),p.qZA(),p._uU(7,"\n            "),p.TgZ(8,"p",23),p._uU(9),p.ALo(10,"i18n"),p.qZA(),p._uU(11,"\n          "),p.qZA()),2&e&&(p.xp6(5),p.Oqu(p.lcZ(6,2,"accessAllCollectionsDesc")),p.xp6(4),p.Oqu(p.lcZ(10,4,"accessAllCollectionsHelp")))}function me(e,i){if(1&e&&(p.ynx(0),p._uU(1,"\n            "),p._UZ(2,"bit-access-selector",24),p.ALo(3,"i18n"),p.ALo(4,"i18n"),p.ALo(5,"i18n"),p.ALo(6,"async"),p._uU(7,"\n          "),p.BQk()),2&e){const e=p.oxw(2);p.xp6(2),p.Q6J("items",e.collections)("permissionMode",e.PermissionMode.Edit)("columnHeader",p.lcZ(3,6,"collection"))("selectorLabelText",p.lcZ(4,8,"selectCollections"))("emptySelectionText",p.lcZ(5,10,"noCollectionsAdded"))("flexibleCollectionsEnabled",p.lcZ(6,12,e.flexibleCollectionsEnabled$))}}function be(e,i){if(1&e){const e=p.EpF();p.TgZ(0,"bit-tab-group",14),p.NdJ("selectedIndexChange",(function(i){p.CHM(e);const t=p.oxw();return p.KtG(t.tabIndex=i)})),p._uU(1,"\n        "),p.TgZ(2,"bit-tab",15),p.ALo(3,"i18n"),p._uU(4,"\n          "),p.TgZ(5,"bit-form-field"),p._uU(6,"\n            "),p.TgZ(7,"bit-label"),p._uU(8),p.ALo(9,"i18n"),p.qZA(),p._uU(10,"\n            "),p._UZ(11,"input",16),p._uU(12,"\n            "),p.TgZ(13,"bit-hint"),p._uU(14),p.ALo(15,"i18n"),p.qZA(),p._uU(16,"\n          "),p.qZA(),p._uU(17,"\n          "),p.TgZ(18,"bit-form-field"),p._uU(19,"\n            "),p.TgZ(20,"bit-label"),p._uU(21),p.ALo(22,"i18n"),p.qZA(),p._uU(23,"\n            "),p._UZ(24,"input",17),p._uU(25,"\n            "),p.TgZ(26,"bit-hint"),p._uU(27),p.ALo(28,"i18n"),p.qZA(),p._uU(29,"\n          "),p.qZA(),p._uU(30,"\n        "),p.qZA(),p._uU(31,"\n\n        "),p.TgZ(32,"bit-tab",15),p.ALo(33,"i18n"),p._uU(34,"\n          "),p.TgZ(35,"p"),p._uU(36),p.ALo(37,"i18n"),p.YNc(38,pe,3,3,"span",5),p.ALo(39,"async"),p._uU(40,"\n          "),p.qZA(),p._uU(41,"\n          "),p._UZ(42,"bit-access-selector",18),p.ALo(43,"i18n"),p.ALo(44,"i18n"),p.ALo(45,"i18n"),p.ALo(46,"async"),p._uU(47,"\n        "),p.qZA(),p._uU(48,"\n\n        "),p.TgZ(49,"bit-tab",15),p.ALo(50,"i18n"),p._uU(51,"\n          "),p.TgZ(52,"p"),p._uU(53),p.ALo(54,"i18n"),p.YNc(55,ge,3,3,"span",5),p.ALo(56,"async"),p._uU(57,"\n          "),p.qZA(),p._uU(58,"\n          "),p.YNc(59,fe,12,6,"div",19),p.ALo(60,"async"),p._uU(61,"\n          "),p.YNc(62,me,8,14,"ng-container",5),p._uU(63,"\n        "),p.qZA(),p._uU(64,"\n      "),p.qZA()}if(2&e){const e=p.oxw();p.Q6J("selectedIndex",e.tabIndex),p.xp6(2),p.s9C("label",p.lcZ(3,21,"groupInfo")),p.xp6(6),p.Oqu(p.lcZ(9,23,"name")),p.xp6(6),p.Oqu(p.xi3(15,25,"characterMaximum",100)),p.xp6(7),p.Oqu(p.lcZ(22,28,"externalId")),p.xp6(6),p.Oqu(p.lcZ(28,30,"externalIdDesc")),p.xp6(5),p.s9C("label",p.lcZ(33,32,"members")),p.xp6(4),p.hij("\n            ",p.lcZ(37,34,"editGroupMembersDesc"),"\n            "),p.xp6(2),p.Q6J("ngIf",p.lcZ(39,36,e.cannotAddSelfToGroup$)),p.xp6(4),p.Q6J("items",e.members)("showMemberRoles",!0)("permissionMode",e.PermissionMode.Hidden)("columnHeader",p.lcZ(43,38,"member"))("selectorLabelText",p.lcZ(44,40,"selectMembers"))("emptySelectionText",p.lcZ(45,42,"noMembersAdded"))("flexibleCollectionsEnabled",p.lcZ(46,44,e.flexibleCollectionsEnabled$)),p.xp6(7),p.s9C("label",p.lcZ(50,46,"collections")),p.xp6(4),p.hij("\n            ",p.lcZ(54,48,"editGroupCollectionsDesc"),"\n            "),p.xp6(2),p.Q6J("ngIf",!p.lcZ(56,50,e.canAssignAccessToAnyCollection$)),p.xp6(4),p.Q6J("ngIf",!p.lcZ(60,52,e.flexibleCollectionsEnabled$)),p.xp6(3),p.Q6J("ngIf",!e.groupForm.value.accessAll)}}!function(e){e[e.Info=0]="Info",e[e.Members=1]="Members",e[e.Collections=2]="Collections"}(n||(n={})),function(e){e.Saved="saved",e.Canceled="canceled",e.Deleted="deleted"}(o||(o={}));class ve{get groupId(){return this.params.groupId}get organizationId(){return this.params.organizationId}get editMode(){return null!=this.groupId}get orgMembers$(){return(0,U.D)(this.organizationUserService.getAllUsers(this.organizationId)).pipe((0,C.U)((e=>e.data.map((e=>{var i;return{id:e.id,type:Y.zD.Member,email:e.email,role:e.type,listName:(null===(i=e.name)||void 0===i?void 0:i.length)>0?`${e.name} (${e.email})`:e.email,labelName:e.name||e.email,status:e.status,userId:e.userId}})))))}constructor(e,i,t,l,r,c,a,d,u,h,p,g,m,b,Z){var x;this.params=e,this.dialogRef=i,this.apiService=t,this.organizationUserService=l,this.groupService=r,this.i18nService=c,this.platformUtilsService=a,this.logService=d,this.formBuilder=u,this.changeDetectorRef=h,this.dialogService=p,this.organizationService=g,this.configService=m,this.accountService=b,this.collectionAdminService=Z,this.organization$=this.organizationService.get$(this.organizationId).pipe((0,z.d)({refCount:!0})),this.flexibleCollectionsEnabled$=this.organization$.pipe((0,C.U)((e=>null==e?void 0:e.flexibleCollections))),this.flexibleCollectionsV1Enabled$=this.configService.getFeatureFlag$(F.T.FlexibleCollectionsV1),this.PermissionMode=Y.R9,this.ResultType=o,this.loading=!0,this.collections=[],this.members=[],this.groupForm=this.formBuilder.group({accessAll:[!1],name:["",[q.kI.required,q.kI.maxLength(100)]],externalId:this.formBuilder.control({value:"",disabled:!0}),members:[[]],collections:[[]]}),this.destroy$=new f.x,this.orgCollections$=(0,U.D)(this.collectionAdminService.getAll(this.organizationId)).pipe((0,z.d)({refCount:!0,bufferSize:1})),this.groupDetails$=(0,E.of)(this.editMode).pipe((0,A.b)((e=>e?(0,v.a)([this.groupService.get(this.organizationId,this.groupId),this.apiService.getGroupUsers(this.organizationId,this.groupId)]).pipe((0,C.U)((([e,i])=>(e.members=i,e))),(0,M.K)((e=>(e instanceof J.i?this.logService.error(e.message):this.logService.error(e.toString()),(0,E.of)(void 0))))):(0,E.of)(void 0))),(0,z.d)({refCount:!0,bufferSize:1})),this.allowAdminAccessToAllCollectionItems$=(0,v.a)([this.organization$,this.flexibleCollectionsV1Enabled$]).pipe((0,C.U)((([e,i])=>!i||!e.flexibleCollections||e.allowAdminAccessToAllCollectionItems))),this.canAssignAccessToAnyCollection$=(0,v.a)([this.organization$,this.flexibleCollectionsV1Enabled$,this.allowAdminAccessToAllCollectionItems$]).pipe((0,C.U)((([e,i,t])=>e.canEditAnyCollection(i)||e.permissions.manageGroups&&t))),this.cannotAddSelfToGroup$=(0,v.a)([this.allowAdminAccessToAllCollectionItems$,this.groupDetails$]).pipe((0,C.U)((([e,i])=>!e&&null!=i))),this.submit=()=>de(this,void 0,void 0,(function*(){var e,i;if(this.groupForm.markAllAsTouched(),this.groupForm.invalid)return void(this.tabIndex!==n.Info&&this.platformUtilsService.showToast("error",null,this.i18nService.t("fieldOnTabRequiresAttention",this.i18nService.t("groupInfo"))));const t=new s.Rq;t.id=this.groupId,t.organizationId=this.organizationId;const l=this.groupForm.value;t.name=l.name,t.accessAll=l.accessAll,t.members=null!==(i=null===(e=l.members)||void 0===e?void 0:e.map((e=>e.id)))&&void 0!==i?i:[],t.accessAll||(t.collections=l.collections.map((e=>(0,Y.E2)(e)))),yield this.groupService.save(t),this.platformUtilsService.showToast("success",null,this.i18nService.t(this.editMode?"editedGroupId":"createdGroupId",l.name)),this.dialogRef.close(o.Saved)})),this.delete=()=>de(this,void 0,void 0,(function*(){if(!this.editMode)return;if(!(yield this.dialogService.openSimpleDialog({title:this.group.name,content:{key:"deleteGroupConfirmation"},type:"warning"})))return!1;yield this.groupService.delete(this.organizationId,this.groupId),this.platformUtilsService.showToast("success",null,this.i18nService.t("deletedGroupId",this.group.name)),this.dialogRef.close(o.Deleted)})),this.tabIndex=null!==(x=e.initialTab)&&void 0!==x?x:n.Info}ngOnInit(){this.loading=!0,this.title=this.i18nService.t(this.editMode?"editGroup":"newGroup"),(0,v.a)([this.orgCollections$,this.orgMembers$,this.groupDetails$,this.cannotAddSelfToGroup$,this.accountService.activeAccount$,this.organization$,this.flexibleCollectionsV1Enabled$]).pipe((0,Z.R)(this.destroy$)).subscribe((([e,i,t,n,o,l,s])=>{var r;if(this.members=i,this.group=t,this.collections=function(e,i,t,n){return e.map((e=>{var o;const l=null!==(o=null==n?void 0:n.collections.find((i=>i.id==e.id)))&&void 0!==o?o:void 0;return{id:e.id,type:Y.zD.Collection,labelName:e.name,listName:e.name,readonly:!e.canEditGroupAccess(i,t),readonlyPermission:l?(0,Y.d4)(l):void 0}})).filter((e=>!e.readonly||(null==n?void 0:n.collections.some((i=>i.id==e.id)))))}(e,l,s,t),null!=this.group&&(this.changeDetectorRef.detectChanges(),this.groupForm.patchValue({name:this.group.name,externalId:this.group.externalId,accessAll:this.group.accessAll,members:this.group.members.map((e=>({id:e,type:Y.zD.Member}))),collections:Ue(t,this.collections)})),n){const e=null===(r=this.members.find((e=>e.userId===o.id)))||void 0===r?void 0:r.id,i=this.groupForm.value.members.some((i=>i.id===e));null==e||i||(this.members=this.members.filter((i=>i.id!==e)))}this.loading=!1}))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}function Ue(e,i){return e.collections.filter((e=>!i.find((i=>i.id==e.id)).readonly)).map((e=>({id:e.id,type:Y.zD.Collection,permission:(0,Y.d4)(e)})))}ve.ɵfac=function(e){return new(e||ve)(p.Y36(I.Kt),p.Y36(I.zj),p.Y36(k.s),p.Y36(N.t),p.Y36(s.My),p.Y36(P.D),p.Y36(O.P),p.Y36($.$),p.Y36(q.qu),p.Y36(p.sBO),p.Y36(D.x),p.Y36(a.Mn),p.Y36(Q.E),p.Y36(V.BR),p.Y36(L.m))},ve.ɵcmp=p.Xpm({type:ve,selectors:[["app-group-add-edit"]],decls:32,vars:18,consts:[[3,"formGroup","bitSubmit"],["dialogSize","large",3,"disablePadding"],["bitDialogTitle",""],["class","tw-text-sm tw-normal-case tw-text-muted",4,"ngIf"],["bitDialogContent",""],[4,"ngIf"],[3,"selectedIndex","selectedIndexChange",4,"ngIf"],["bitDialogFooter",""],["bitButton","","buttonType","primary","bitFormButton","","type","submit"],["bitButton","","buttonType","secondary","type","button",3,"bitDialogClose"],["type","button","buttonType","danger","bitIconButton","bwi-trash","bitFormButton","",1,"tw-ml-auto",3,"bitAction","appA11yTitle"],[1,"tw-text-sm","tw-normal-case","tw-text-muted"],["aria-hidden","true",1,"bwi","bwi-spinner","bwi-spin","text-muted",3,"title"],[1,"sr-only"],[3,"selectedIndex","selectedIndexChange"],[3,"label"],["bitInput","","appAutofocus","","type","text","formControlName","name"],["bitInput","","type","text","formControlName","externalId"],["formControlName","members",3,"items","showMemberRoles","permissionMode","columnHeader","selectorLabelText","emptySelectionText","flexibleCollectionsEnabled"],["class","tw-my-3",4,"ngIf"],[1,"tw-my-3"],["type","checkbox","formControlName","accessAll","id","accessAll"],["for","accessAll",1,"tw-mb-0","tw-text-lg"],[1,"tw-my-0","tw-text-muted"],["formControlName","collections",3,"items","permissionMode","columnHeader","selectorLabelText","emptySelectionText","flexibleCollectionsEnabled"]],template:function(e,i){1&e&&(p.TgZ(0,"form",0),p._uU(1,"\n  "),p.TgZ(2,"bit-dialog",1),p._uU(3,"\n    "),p.TgZ(4,"span",2),p._uU(5),p.YNc(6,ue,2,1,"span",3),p._uU(7,"\n    "),p.qZA(),p._uU(8,"\n    "),p.TgZ(9,"div",4),p._uU(10,"\n      "),p.YNc(11,he,9,6,"div",5),p._uU(12,"\n\n      "),p.YNc(13,be,65,54,"bit-tab-group",6),p._uU(14,"\n    "),p.qZA(),p._uU(15,"\n    "),p.ynx(16,7),p._uU(17,"\n      "),p.TgZ(18,"button",8),p._uU(19),p.ALo(20,"i18n"),p.qZA(),p._uU(21,"\n      "),p.TgZ(22,"button",9),p._uU(23),p.ALo(24,"i18n"),p.qZA(),p._uU(25,"\n      "),p._UZ(26,"button",10),p.ALo(27,"i18n"),p._uU(28,"\n    "),p.BQk(),p._uU(29,"\n  "),p.qZA(),p._uU(30,"\n"),p.qZA(),p._uU(31,"\n")),2&e&&(p.Q6J("formGroup",i.groupForm)("bitSubmit",i.submit),p.xp6(2),p.Q6J("disablePadding",!i.loading),p.xp6(3),p.hij("\n      ",i.title,"\n      "),p.xp6(1),p.Q6J("ngIf",i.editMode),p.xp6(5),p.Q6J("ngIf",i.loading),p.xp6(2),p.Q6J("ngIf",!i.loading),p.xp6(6),p.hij("\n        ",p.lcZ(20,12,"save"),"\n      "),p.xp6(3),p.Q6J("bitDialogClose",i.ResultType.Canceled),p.xp6(1),p.hij("\n        ",p.lcZ(24,14,"cancel"),"\n      "),p.xp6(3),p.Q6J("bitAction",i.delete)("appA11yTitle",p.lcZ(27,16,"delete")))},dependencies:[B.O5,q._Y,q.Fj,q.Wl,q.JJ,q.JL,q.sg,q.u,R.B,G.U,j.Q,H.b,K.u,W.r,X.a,ee.f,ie.d,te.G,ne.u,oe.M,le.Q,se.Q,re.i,ce.f,B.Ov,ae.C],encapsulation:2});var Ae=t(51430),Ce=t(31754),Ze=t(8724),xe=t(1874),we=t(7172),_e=t(12492),ye=t(73974),Te=t(26194),Se=t(44234),Ie=t(54735),qe=t(50941),ze=t(26361),Ee=t(94239),Me=t(58618),Fe=function(e,i,t,n){return new(t||(t=Promise))((function(o,l){function s(e){try{c(n.next(e))}catch(i){l(i)}}function r(e){try{c(n.throw(e))}catch(i){l(i)}}function c(e){var i;e.done?o(e.value):(i=e.value,i instanceof t?i:new t((function(e){e(i)}))).then(s,r)}c((n=n.apply(e,i||[])).next())}))};const Je=["addEdit"],Le=["usersTemplate"];function Ye(e,i){1&e&&(p.ynx(0),p._uU(1,"\n  "),p._UZ(2,"i",5),p.ALo(3,"i18n"),p._uU(4,"\n  "),p.TgZ(5,"span",6),p._uU(6),p.ALo(7,"i18n"),p.qZA(),p._uU(8,"\n"),p.BQk()),2&e&&(p.xp6(2),p.s9C("title",p.lcZ(3,2,"loading")),p.xp6(4),p.Oqu(p.lcZ(7,4,"loading")))}function ke(e,i){1&e&&(p.TgZ(0,"p"),p._uU(1),p.ALo(2,"i18n"),p.qZA()),2&e&&(p.xp6(1),p.Oqu(p.lcZ(2,1,"noGroupsInList")))}function Ne(e,i){if(1&e&&p._UZ(0,"bit-badge-list",32),2&e){const e=p.oxw().$implicit;p.Q6J("items",e.collectionNames)("maxItems",3)}}function Pe(e,i){1&e&&(p.TgZ(0,"span"),p._uU(1),p.ALo(2,"i18n"),p.qZA()),2&e&&(p.xp6(1),p.Oqu(p.lcZ(2,1,"all")))}function Oe(e,i){if(1&e){const e=p.EpF();p.TgZ(0,"tr",22),p._uU(1,"\n        "),p.TgZ(2,"td",23),p.NdJ("click",(function(){const i=p.CHM(e).$implicit,t=p.oxw(4);return p.KtG(t.check(i))})),p._uU(3,"\n          "),p.TgZ(4,"input",24),p.NdJ("ngModelChange",(function(i){const t=p.CHM(e).$implicit;return p.KtG(t.checked=i)})),p.qZA(),p._uU(5,"\n        "),p.qZA(),p._uU(6,"\n        "),p.TgZ(7,"td",25),p.NdJ("click",(function(){const i=p.CHM(e).$implicit,t=p.oxw(4);return p.KtG(t.edit(i))})),p._uU(8,"\n          "),p.TgZ(9,"button",26),p._uU(10),p.qZA(),p._uU(11,"\n        "),p.qZA(),p._uU(12,"\n        "),p.TgZ(13,"td",23),p.NdJ("click",(function(){const i=p.CHM(e).$implicit,t=p.oxw(4);return p.KtG(t.edit(i,t.ModalTabType.Collections))})),p._uU(14,"\n          "),p.YNc(15,Ne,1,2,"bit-badge-list",27),p._uU(16,"\n          "),p.YNc(17,Pe,3,3,"span",3),p._uU(18,"\n        "),p.qZA(),p._uU(19,"\n        "),p.TgZ(20,"td",13),p._uU(21,"\n          "),p._UZ(22,"button",15),p.ALo(23,"i18n"),p._uU(24,"\n\n          "),p.TgZ(25,"bit-menu",null,28),p._uU(27,"\n            "),p.TgZ(28,"button",17),p.NdJ("click",(function(){const i=p.CHM(e).$implicit,t=p.oxw(4);return p.KtG(t.edit(i))})),p._uU(29,"\n              "),p._UZ(30,"i",29),p._uU(31),p.ALo(32,"i18n"),p.qZA(),p._uU(33,"\n            "),p.TgZ(34,"button",17),p.NdJ("click",(function(){const i=p.CHM(e).$implicit,t=p.oxw(4);return p.KtG(t.edit(i,t.ModalTabType.Members))})),p._uU(35,"\n              "),p._UZ(36,"i",30),p._uU(37),p.ALo(38,"i18n"),p.qZA(),p._uU(39,"\n            "),p.TgZ(40,"button",17),p.NdJ("click",(function(){const i=p.CHM(e).$implicit,t=p.oxw(4);return p.KtG(t.edit(i,t.ModalTabType.Collections))})),p._uU(41,"\n              "),p._UZ(42,"i",31),p._uU(43),p.ALo(44,"i18n"),p.qZA(),p._uU(45,"\n            "),p.TgZ(46,"button",17),p.NdJ("click",(function(){const i=p.CHM(e).$implicit,t=p.oxw(4);return p.KtG(t.delete(i))})),p._uU(47,"\n              "),p.TgZ(48,"span",18),p._UZ(49,"i",19),p._uU(50),p.ALo(51,"i18n"),p.qZA(),p._uU(52,"\n            "),p.qZA(),p._uU(53,"\n          "),p.qZA(),p._uU(54,"\n        "),p.qZA(),p._uU(55,"\n      "),p.qZA()}if(2&e){const e=i.$implicit,t=p.MAs(26);p.xp6(4),p.Q6J("ngModel",e.checked),p.xp6(6),p.hij("\n            ",e.details.name,"\n          "),p.xp6(5),p.Q6J("ngIf",!e.details.accessAll),p.xp6(2),p.Q6J("ngIf",e.details.accessAll),p.xp6(5),p.s9C("appA11yTitle",p.lcZ(23,10,"options")),p.Q6J("bitMenuTriggerFor",t),p.xp6(9),p.hij(" ",p.lcZ(32,12,"editInfo"),"\n            "),p.xp6(6),p.hij(" ",p.lcZ(38,14,"members"),"\n            "),p.xp6(6),p.hij(" ",p.lcZ(44,16,"collections"),"\n            "),p.xp6(7),p.hij(" ",p.lcZ(51,18,"delete"),"")}}function $e(e,i){if(1&e&&(p._uU(0,"\n      "),p.YNc(1,Oe,56,20,"tr",21),p._uU(2,"\n    ")),2&e){const e=p.oxw(3);p.xp6(1),p.Q6J("ngForOf",e.visibleGroups)}}function De(e,i){if(1&e){const e=p.EpF();p.TgZ(0,"bit-table",8),p.NdJ("scrolled",(function(){p.CHM(e);const i=p.oxw(2);return p.KtG(i.loadMore())})),p._uU(1,"\n    "),p.ynx(2,9),p._uU(3,"\n      "),p.TgZ(4,"tr"),p._uU(5,"\n        "),p.TgZ(6,"th",10),p._uU(7,"\n          "),p.TgZ(8,"input",11),p.NdJ("change",(function(i){p.CHM(e);const t=p.oxw(2);return p.KtG(t.toggleAllVisible(i))})),p.qZA(),p._uU(9,"\n          "),p.TgZ(10,"label",12),p._uU(11),p.ALo(12,"i18n"),p.qZA(),p._uU(13,"\n        "),p.qZA(),p._uU(14,"\n        "),p.TgZ(15,"th",13),p._uU(16),p.ALo(17,"i18n"),p.qZA(),p._uU(18,"\n        "),p.TgZ(19,"th",13),p._uU(20),p.ALo(21,"i18n"),p.qZA(),p._uU(22,"\n        "),p.TgZ(23,"th",14),p._uU(24,"\n          "),p._UZ(25,"button",15),p.ALo(26,"i18n"),p._uU(27,"\n\n          "),p.TgZ(28,"bit-menu",null,16),p._uU(30,"\n            "),p.TgZ(31,"button",17),p.NdJ("click",(function(){p.CHM(e);const i=p.oxw(2);return p.KtG(i.deleteAllSelected())})),p._uU(32,"\n              "),p.TgZ(33,"span",18),p._UZ(34,"i",19),p._uU(35),p.ALo(36,"i18n"),p.qZA(),p._uU(37,"\n            "),p.qZA(),p._uU(38,"\n          "),p.qZA(),p._uU(39,"\n        "),p.qZA(),p._uU(40,"\n      "),p.qZA(),p._uU(41,"\n    "),p.BQk(),p._uU(42,"\n    "),p.YNc(43,$e,3,1,"ng-template",20),p._uU(44,"\n  "),p.qZA()}if(2&e){const e=p.MAs(29),i=p.oxw(2);p.Q6J("infiniteScrollDistance",1)("infiniteScrollDisabled",!i.isPaging()),p.xp6(11),p.Oqu(p.lcZ(12,8,"all")),p.xp6(5),p.Oqu(p.lcZ(17,10,"name")),p.xp6(4),p.Oqu(p.lcZ(21,12,"collections")),p.xp6(5),p.s9C("appA11yTitle",p.lcZ(26,14,"options")),p.Q6J("bitMenuTriggerFor",e),p.xp6(10),p.hij(" ",p.lcZ(36,16,"delete"),"")}}function Ge(e,i){if(1&e&&(p.ynx(0),p._uU(1,"\n  "),p.YNc(2,ke,3,3,"p",3),p._uU(3,"\n  "),p.YNc(4,De,45,18,"bit-table",7),p._uU(5,"\n"),p.BQk()),2&e){const e=p.oxw();p.xp6(2),p.Q6J("ngIf",!e.visibleGroups.length),p.xp6(2),p.Q6J("ngIf",e.visibleGroups.length)}}function Qe(e,i){}class Ve{get searchText(){return this._searchText$.value}set searchText(e){this._searchText$.next(e),this.updateSearchedGroups()}get visibleGroups(){return this.isPaging()?this.pagedGroups:this.isSearching?this.searchedGroups:this.groups}constructor(e,i,t,o,l,s,r,c,a,d){this.apiService=e,this.groupService=i,this.route=t,this.i18nService=o,this.dialogService=l,this.platformUtilsService=s,this.searchService=r,this.logService=c,this.collectionService=a,this.searchPipe=d,this.loading=!0,this.didScroll=!1,this.pageSize=100,this.ModalTabType=n,this.pagedGroupsCount=0,this._searchText$=new g.X(""),this.destroy$=new f.x,this.refreshGroups$=new g.X(null),this.isSearching=!1}ngOnInit(){return Fe(this,void 0,void 0,(function*(){this.route.params.pipe((0,m.b)((e=>this.organizationId=e.organizationId)),(0,b.w)((()=>(0,v.a)([(0,U.D)(this.apiService.getCollections(this.organizationId)).pipe((0,A.b)((e=>this.toCollectionMap(e)))),this.refreshGroups$.pipe((0,b.w)((()=>this.groupService.getAll(this.organizationId))))]))),(0,C.U)((([e,i])=>i.sort(y.c.getSortFunction(this.i18nService,"name")).map((i=>{var t;return{id:i.id,name:i.name,details:i,checked:!1,collectionNames:i.collections.map((i=>{var t;return null===(t=e[i.id])||void 0===t?void 0:t.name})).sort(null===(t=this.i18nService.collator)||void 0===t?void 0:t.compare)}})))),(0,Z.R)(this.destroy$)).subscribe((e=>{this.groups=e,this.resetPaging(),this.updateSearchedGroups(),this.loading=!1})),this.route.queryParams.pipe((0,w.P)(),(0,A.b)((e=>Fe(this,void 0,void 0,(function*(){this.searchText=e.search})))),(0,Z.R)(this.destroy$)).subscribe(),this._searchText$.pipe((0,b.w)((e=>this.searchService.isSearchable(e))),(0,Z.R)(this.destroy$)).subscribe((e=>{this.isSearching=e}))}))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadMore(){if(!this.groups||this.groups.length<=this.pageSize)return;const e=this.pagedGroups.length;let i=this.pageSize;0===e&&this.pagedGroupsCount>this.pageSize&&(i=this.pagedGroupsCount),this.groups.length>e&&(this.pagedGroups=this.pagedGroups.concat(this.groups.slice(e,e+i))),this.pagedGroupsCount=this.pagedGroups.length,this.didScroll=this.pagedGroups.length>this.pageSize}edit(e,i=n.Info){return Fe(this,void 0,void 0,(function*(){const t=(n=this.dialogService,l={data:{initialTab:i,organizationId:this.organizationId,groupId:null!=e?e.details.id:null}},n.open(ve,l));var n,l;const s=yield(0,x.n)(t.closed);s==o.Saved?this.refreshGroups$.next():s==o.Deleted&&this.removeGroup(e.details.id)}))}add(){this.edit(null)}delete(e){return Fe(this,void 0,void 0,(function*(){if(!(yield this.dialogService.openSimpleDialog({title:e.details.name,content:{key:"deleteGroupConfirmation"},type:"warning"})))return!1;try{yield this.groupService.delete(this.organizationId,e.details.id),this.platformUtilsService.showToast("success",null,this.i18nService.t("deletedGroupId",e.details.name)),this.removeGroup(e.details.id)}catch(i){this.logService.error(i)}}))}deleteAllSelected(){return Fe(this,void 0,void 0,(function*(){const e=this.groups.filter((e=>e.checked));if(0==e.length)return;const i=e.map((e=>e.details.name)).join(", ");if(!(yield this.dialogService.openSimpleDialog({title:{key:"deleteMultipleGroupsConfirmation",placeholders:[e.length.toString()]},content:i,type:"warning"})))return!1;try{yield this.groupService.deleteMany(this.organizationId,e.map((e=>e.details.id))),this.platformUtilsService.showToast("success",null,this.i18nService.t("deletedManyGroups",e.length.toString())),e.forEach((e=>this.removeGroup(e.details.id)))}catch(t){this.logService.error(t)}}))}resetPaging(){this.pagedGroups=[],this.loadMore()}check(e){e.checked=!e.checked}toggleAllVisible(e){this.visibleGroups.forEach((i=>i.checked=e.target.checked))}isPaging(){const e=this.isSearching;return e&&this.didScroll&&this.resetPaging(),!e&&this.groups&&this.groups.length>this.pageSize}removeGroup(e){const i=this.groups.findIndex((i=>i.details.id===e));i>-1&&(this.groups.splice(i,1),this.resetPaging(),this.updateSearchedGroups())}toCollectionMap(e){return Fe(this,void 0,void 0,(function*(){const i=e.data.map((e=>new S.F(new T.Z(e)))),t=yield this.collectionService.decryptMany(i),n={};return t.forEach((e=>n[e.id]=e)),n}))}updateSearchedGroups(){this.isSearching&&(this.searchedGroups=this.searchPipe.transform(this.groups,this.searchText,(e=>e.details.name),(e=>e.details.id)))}}Ve.ɵfac=function(e){return new(e||Ve)(p.Y36(k.s),p.Y36(s.My),p.Y36(r.gz),p.Y36(P.D),p.Y36(D.x),p.Y36(O.P),p.Y36(Ae.o),p.Y36($.$),p.Y36(Ce.a),p.Y36(_.C))},Ve.ɵcmp=p.Xpm({type:Ve,selectors:[["app-org-groups"]],viewQuery:function(e,i){if(1&e&&(p.Gf(Je,7,p.s_b),p.Gf(Le,7,p.s_b)),2&e){let e;p.iGM(e=p.CRH())&&(i.addEditModalRef=e.first),p.iGM(e=p.CRH())&&(i.usersModalRef=e.first)}},decls:19,vars:9,consts:[[1,"tw-w-80",3,"placeholder","ngModel","ngModelChange"],["bitButton","","type","button","buttonType","primary",3,"click"],["aria-hidden","true",1,"bwi","bwi-plus","bwi-fw"],[4,"ngIf"],["addEdit",""],["aria-hidden","true",1,"bwi","bwi-spinner","bwi-spin","text-muted",3,"title"],[1,"sr-only"],["infinite-scroll","",3,"infiniteScrollDistance","infiniteScrollDisabled","scrolled",4,"ngIf"],["infinite-scroll","",3,"infiniteScrollDistance","infiniteScrollDisabled","scrolled"],["header",""],["bitCell","",1,"tw-w-20"],["type","checkbox","bitCheckbox","","id","selectAll",1,"tw-mr-2",3,"change"],["for","selectAll",1,"tw-mb-0","!tw-font-bold","!tw-text-muted"],["bitCell",""],["bitCell","",1,"tw-w-10"],["type","button","bitIconButton","bwi-ellipsis-v","size","small",3,"bitMenuTriggerFor","appA11yTitle"],["headerMenu",""],["type","button","bitMenuItem","",3,"click"],[1,"tw-text-danger"],["aria-hidden","true",1,"bwi","bwi-trash"],["body",""],["bitRow","",4,"ngFor","ngForOf"],["bitRow",""],["bitCell","",1,"tw-cursor-pointer",3,"click"],["type","checkbox","bitCheckbox","",3,"ngModel","ngModelChange"],["bitCell","",1,"tw-cursor-pointer","tw-font-bold",3,"click"],["type","button","bitLink",""],["variant","secondary",3,"items","maxItems",4,"ngIf"],["rowMenu",""],["aria-hidden","true",1,"bwi","bwi-pencil-square"],["aria-hidden","true",1,"bwi","bwi-user"],["aria-hidden","true",1,"bwi","bwi-collection"],["variant","secondary",3,"items","maxItems"]],template:function(e,i){1&e&&(p.TgZ(0,"app-header"),p._uU(1,"\n  "),p.TgZ(2,"bit-search",0),p.NdJ("ngModelChange",(function(e){return i.searchText=e})),p.ALo(3,"i18n"),p.qZA(),p._uU(4,"\n  "),p.TgZ(5,"button",1),p.NdJ("click",(function(){return i.add()})),p._uU(6,"\n    "),p._UZ(7,"i",2),p._uU(8),p.ALo(9,"i18n"),p.qZA(),p._uU(10,"\n"),p.qZA(),p._uU(11,"\n\n"),p.YNc(12,Ye,9,6,"ng-container",3),p._uU(13,"\n"),p.YNc(14,Ge,6,2,"ng-container",3),p._uU(15,"\n"),p.YNc(16,Qe,0,0,"ng-template",null,4,p.W1O),p._uU(18,"\n")),2&e&&(p.xp6(2),p.Q6J("placeholder",p.lcZ(3,5,"searchGroups"))("ngModel",i.searchText),p.xp6(6),p.hij("\n    ",p.lcZ(9,7,"newGroup"),"\n  "),p.xp6(4),p.Q6J("ngIf",i.loading),p.xp6(2),p.Q6J("ngIf",!i.loading&&i.visibleGroups))},dependencies:[B.sg,B.O5,q.Wl,q.JJ,q.On,Ze.Ry,R.B,xe.b,W.r,we.b,le.Q,_e._,ye.M,Te.t,Se.e,Ie.a,qe.Y,ze.v,Ie.f,Ee.g,Me.k,ae.C],encapsulation:2});var Be=t(82421),Re=t(40857),je=t(98002),He=t(27420),Ke=t(7357),We=t(85921),Xe=t(63391),ei=t(21151),ii=t(74690),ti=t(35504),ni=t(66997),oi=t(40925),li=t(63339);function si(e,i){if(1&e){const e=p.EpF();p.TgZ(0,"button",3),p.NdJ("click",(function(){p.CHM(e);const i=p.oxw();return p.KtG(i.viewCollectionClicked.emit({readonly:!1,tab:i.collectionDialogTabType.Info}))})),p._uU(1,"\n      "),p._UZ(2,"i",4),p._uU(3),p.ALo(4,"i18n"),p.qZA()}2&e&&(p.xp6(3),p.hij(" ",p.lcZ(4,1,"editCollection"),"\n    "))}function ri(e,i){if(1&e){const e=p.EpF();p.TgZ(0,"button",3),p.NdJ("click",(function(){p.CHM(e);const i=p.oxw();return p.KtG(i.viewCollectionClicked.emit({readonly:!0,tab:i.collectionDialogTabType.Access}))})),p._uU(1,"\n      "),p._UZ(2,"i",5),p._uU(3),p.ALo(4,"i18n"),p.qZA()}2&e&&(p.xp6(3),p.hij(" ",p.lcZ(4,1,"viewAccess"),"\n    "))}const ci=ni.W4`<svg xmlns="http://www.w3.org/2000/svg" width="120" height="120" viewBox="10 -10 120 140" fill="none">
  <rect class="tw-stroke-secondary-600" width="134" height="86" x="3" y="31.485" stroke-width="6" rx="11"/>
  <path class="tw-fill-secondary-600" d="M123.987 20.15H14.779a3.114 3.114 0 0 1-2.083-.95 3.036 3.036 0 0 1 0-4.208 3.125 3.125 0 0 1 2.083-.951h109.208c.792.043 1.536.38 2.083.95a3.035 3.035 0 0 1 0 4.208 3.115 3.115 0 0 1-2.083.95Zm-6.649-14.041h-95.91a3.114 3.114 0 0 1-2.082-.95 3.036 3.036 0 0 1-.848-2.105c0-.782.306-1.538.848-2.104A3.125 3.125 0 0 1 21.43 0h95.909c.791.043 1.535.38 2.082.95.547.57.849 1.322.849 2.104a3.05 3.05 0 0 1-.849 2.104 3.115 3.115 0 0 1-2.082.95ZM95.132 74.407A42.317 42.317 0 0 0 83.59 65.43l8.799-8.657a1.59 1.59 0 0 0 .004-2.27 1.641 1.641 0 0 0-2.298-.004l-9.64 9.479a28.017 28.017 0 0 0-10.483-2.13c-14.323 0-24.814 12.342-25.298 12.89a2.431 2.431 0 0 0-.675 1.64c-.01.612.215 1.203.626 1.66a43.981 43.981 0 0 0 11.873 9.485l-8.806 8.658a1.601 1.601 0 0 0-.499 1.138 1.602 1.602 0 0 0 1.008 1.5 1.651 1.651 0 0 0 1.255-.009c.199-.085.379-.205.528-.359l9.634-9.443a27.16 27.16 0 0 0 10.359 2.158c14.323 0 24.753-12.086 25.23-12.63a2.983 2.983 0 0 0-.078-4.128h.002ZM49.204 77.82a1.82 1.82 0 0 1-.43-.6 1.767 1.767 0 0 1-.152-.72 1.778 1.778 0 0 1 .582-1.32c3.857-3.564 11.782-9.686 20.77-9.676 2.564.037 5.105.508 7.508 1.395l-3.291 3.235a7.793 7.793 0 0 0-5.02-1.226 7.746 7.746 0 0 0-4.676 2.18 7.528 7.528 0 0 0-1 9.563l-4.199 4.143a43.135 43.135 0 0 1-10.092-6.974Zm26.059-1.318a5.19 5.19 0 0 1-1.557 3.68 5.326 5.326 0 0 1-3.733 1.521c-.82-.005-1.63-.2-2.359-.57l7.067-6.952c.377.718.575 1.513.582 2.321Zm-10.58 0a5.136 5.136 0 0 1 .673-2.555 5.204 5.204 0 0 1 1.862-1.897 5.302 5.302 0 0 1 5.172-.146l-7.096 6.977a5.06 5.06 0 0 1-.61-2.379Zm26.053 1.331c-3.857 3.56-11.779 9.677-20.763 9.677a22.723 22.723 0 0 1-7.454-1.369l3.292-3.226a7.793 7.793 0 0 0 4.995 1.192 7.734 7.734 0 0 0 4.642-2.176 7.524 7.524 0 0 0 1.033-9.506l4.224-4.168a43.258 43.258 0 0 1 10.02 6.945 1.788 1.788 0 0 1 .585 1.313 1.788 1.788 0 0 1-.577 1.318h.003Z"/>
</svg>`;class ai{constructor(){this.icon=ci,this.collectionDialogTabType=ii.sn,this.canEditCollection=!1,this.canViewCollectionInfo=!1,this.viewCollectionClicked=new p.vpe}}ai.ɵfac=function(e){return new(e||ai)},ai.ɵcmp=p.Xpm({type:ai,selectors:[["collection-access-restricted"]],inputs:{canEditCollection:"canEditCollection",canViewCollectionInfo:"canViewCollectionInfo"},outputs:{viewCollectionClicked:"viewCollectionClicked"},standalone:!0,features:[p.jDz],decls:10,vars:6,consts:[[1,"tw-mt-2","tw-block",3,"icon"],["slot","title",1,"tw-mt-4","tw-block"],["slot","button","bitButton","","buttonType","secondary","type","button",3,"click",4,"ngIf"],["slot","button","bitButton","","buttonType","secondary","type","button",3,"click"],["aria-hidden","true",1,"bwi","bwi-pencil-square"],["aria-hidden","true",1,"bwi","bwi-users"]],template:function(e,i){1&e&&(p.TgZ(0,"bit-no-items",0),p._uU(1,"\n    "),p.TgZ(2,"span",1),p._uU(3),p.ALo(4,"i18n"),p.qZA(),p._uU(5,"\n    "),p.YNc(6,si,5,3,"button",2),p._uU(7,"\n    "),p.YNc(8,ri,5,3,"button",2),p._uU(9,"\n  "),p.qZA()),2&e&&(p.Q6J("icon",i.icon),p.xp6(3),p.Oqu(p.lcZ(4,4,"collectionAccessRestricted")),p.xp6(3),p.Q6J("ngIf",i.canEditCollection),p.xp6(2),p.Q6J("ngIf",!i.canEditCollection&&i.canViewCollectionInfo))},dependencies:[l.m,B.O5,W.r,ae.C,oi.h,je.t,li.M],encapsulation:2});var di=t(16857),ui=t(6242),hi=t(75028),pi=t(98913),gi=t(56110),fi=t(36957),mi=t(62212),bi=t(23031),vi=t(92236),Ui=t(46811),Ai=function(e,i,t,n){return new(t||(t=Promise))((function(o,l){function s(e){try{c(n.next(e))}catch(i){l(i)}}function r(e){try{c(n.throw(e))}catch(i){l(i)}}function c(e){var i;e.done?o(e.value):(i=e.value,i instanceof t?i:new t((function(e){e(i)}))).then(s,r)}c((n=n.apply(e,i||[])).next())}))};class Ci extends mi.n{constructor(e,i,t,n,o,l,s){super(e,i,t,n,o,l,s),this.destroy$=new f.x,this._collections=new gi.t(1),this.filteredCollections$=this._collections.asObservable(),this.collectionTree$=this.filteredCollections$.pipe((0,C.U)((e=>this.buildCollectionTree(e))))}reloadCollections(e){return Ai(this,void 0,void 0,(function*(){this._collections.next(e)}))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}Ci.ɵfac=function(e){return new(e||Ci)(p.LFG(a.Mn),p.LFG(bi.s),p.LFG(vi.u),p.LFG(Ui.d),p.LFG(P.D),p.LFG(fi.X9),p.LFG(Ce.a))},Ci.ɵprov=p.Yz7({token:Ci,factory:Ci.ɵfac});class Zi{}Zi.ɵfac=function(e){return new(e||Zi)},Zi.ɵmod=p.oAB({type:Zi}),Zi.ɵinj=p.cJS({providers:[{provide:hi.n,useClass:Ci}],imports:[pi.d,He.t]});var xi=t(8241),wi=t(99042),_i=t(67775),yi=t(72591),Ti=t(27027),Si=t(61374),Ii=t(51303),qi=t(34961),zi=t(72285),Ei=t(39194),Mi=t(83505),Fi=t(25406),Ji=t(33287),Li=t(27643),Yi=t(95607),ki=t(91480),Ni=t(17475),Pi=t(37417),Oi=t(95638),$i=t(4003),Di=t(16776),Gi=t(75230),Qi=t(24415),Vi=t(61265),Bi=t(19572),Ri=t(77140),ji=t(76528),Hi=t(58172),Ki=t(53481),Wi=t(384),Xi=t(24610),et=t(2051),it=function(e,i,t,n){return new(t||(t=Promise))((function(o,l){function s(e){try{c(n.next(e))}catch(i){l(i)}}function r(e){try{c(n.throw(e))}catch(i){l(i)}}function c(e){var i;e.done?o(e.value):(i=e.value,i instanceof t?i:new t((function(e){e(i)}))).then(s,r)}c((n=n.apply(e,i||[])).next())}))};function tt(e,i){if(1&e&&(p.TgZ(0,"small"),p._uU(1),p.qZA()),2&e){const e=p.oxw();p.xp6(1),p.Oqu(e.cipher.name)}}function nt(e,i){1&e&&p._UZ(0,"i",24)}function ot(e,i){1&e&&p._UZ(0,"i",25)}function lt(e,i){if(1&e){const e=p.EpF();p.TgZ(0,"div",26),p._uU(1,"\n                    "),p.TgZ(2,"a",27),p._uU(3,"\n                      "),p._UZ(4,"i",28),p.ALo(5,"i18n"),p._uU(6,"\n                      "),p.TgZ(7,"span",29),p._uU(8),p.ALo(9,"i18n"),p.qZA()(),p._uU(10,"\n                    "),p.TgZ(11,"button",30,31),p.NdJ("click",(function(){p.CHM(e);const i=p.oxw().$implicit,t=p.oxw(2);return p.KtG(t.reupload(i))})),p._uU(13),p.ALo(14,"i18n"),p.qZA(),p._uU(15,"\n                  "),p.qZA()}if(2&e){const e=p.MAs(12),i=p.oxw().$implicit,t=p.oxw(2);p.xp6(4),p.s9C("title",p.lcZ(5,5,"attachmentFixDescription")),p.xp6(4),p.Oqu(p.lcZ(9,7,"attachmentFixDescription")),p.xp6(3),p.Q6J("appApiAction",t.reuploadPromises[i.id])("disabled",e.loading),p.xp6(2),p.hij("\n                      ",p.lcZ(14,9,"fix"),"\n                    ")}}function st(e,i){if(1&e){const e=p.EpF();p.TgZ(0,"td",32),p._uU(1,"\n                "),p.TgZ(2,"button",33,34),p.NdJ("click",(function(){p.CHM(e);const i=p.oxw().$implicit,t=p.oxw(2);return p.KtG(t.delete(i))})),p.ALo(4,"i18n"),p._uU(5,"\n                  "),p._UZ(6,"i",35),p._uU(7,"\n                  "),p._UZ(8,"i",36),p.ALo(9,"i18n"),p._uU(10,"\n                "),p.qZA(),p._uU(11,"\n              "),p.qZA()}if(2&e){const e=p.MAs(3),i=p.oxw().$implicit,t=p.oxw(2);p.xp6(2),p.s9C("appA11yTitle",p.lcZ(4,6,"delete")),p.Q6J("appApiAction",t.deletePromises[i.id])("disabled",e.loading),p.xp6(4),p.Q6J("hidden",e.loading),p.xp6(2),p.s9C("title",p.lcZ(9,8,"loading")),p.Q6J("hidden",!e.loading)}}function rt(e,i){if(1&e){const e=p.EpF();p.TgZ(0,"tr"),p._uU(1,"\n              "),p.TgZ(2,"td",16),p._uU(3,"\n                "),p.YNc(4,nt,1,0,"i",17),p._uU(5,"\n                "),p.YNc(6,ot,1,0,"i",18),p._uU(7,"\n              "),p.qZA(),p._uU(8,"\n              "),p.TgZ(9,"td",19),p._uU(10,"\n                "),p.TgZ(11,"div",20),p._uU(12,"\n                  "),p.TgZ(13,"a",21),p.NdJ("click",(function(){const i=p.CHM(e).$implicit,t=p.oxw(2);return p.KtG(t.download(i))})),p._uU(14),p.qZA(),p._uU(15,"\n                  "),p.YNc(16,lt,16,11,"div",22),p._uU(17,"\n                "),p.qZA(),p._uU(18,"\n                "),p.TgZ(19,"small"),p._uU(20),p.qZA(),p._uU(21,"\n              "),p.qZA(),p._uU(22,"\n              "),p.YNc(23,st,12,10,"td",23),p._uU(24,"\n            "),p.qZA()}if(2&e){const e=i.$implicit,t=p.oxw(2);p.xp6(4),p.Q6J("ngIf",!e.downloading),p.xp6(2),p.Q6J("ngIf",e.downloading),p.xp6(8),p.Oqu(e.fileName),p.xp6(2),p.Q6J("ngIf",t.showFixOldAttachments(e)),p.xp6(4),p.Oqu(e.sizeName),p.xp6(3),p.Q6J("ngIf",!t.viewOnly)}}function ct(e,i){if(1&e&&(p.TgZ(0,"table",14),p._uU(1,"\n          "),p.TgZ(2,"tbody"),p._uU(3,"\n            "),p.YNc(4,rt,25,6,"tr",15),p._uU(5,"\n          "),p.qZA(),p._uU(6,"\n        "),p.qZA()),2&e){const e=p.oxw();p.xp6(4),p.Q6J("ngForOf",e.cipher.attachments)}}function at(e,i){1&e&&(p.TgZ(0,"div"),p._uU(1,"\n          "),p.TgZ(2,"h3"),p._uU(3),p.ALo(4,"i18n"),p.qZA(),p._uU(5,"\n          "),p.TgZ(6,"label",37),p._uU(7),p.ALo(8,"i18n"),p.qZA(),p._uU(9,"\n          "),p._UZ(10,"input",38),p._uU(11,"\n          "),p.TgZ(12,"small",39),p._uU(13),p.ALo(14,"i18n"),p.qZA(),p._uU(15,"\n        "),p.qZA()),2&e&&(p.xp6(3),p.Oqu(p.lcZ(4,3,"newAttachment")),p.xp6(4),p.Oqu(p.lcZ(8,5,"file")),p.xp6(6),p.Oqu(p.lcZ(14,7,"maxFileSize")))}function dt(e,i){if(1&e&&(p.TgZ(0,"button",40),p._uU(1,"\n          "),p._UZ(2,"i",41),p.ALo(3,"i18n"),p._uU(4,"\n          "),p.TgZ(5,"span"),p._uU(6),p.ALo(7,"i18n"),p.qZA(),p._uU(8,"\n        "),p.qZA()),2&e){p.oxw();const e=p.MAs(5);p.Q6J("disabled",e.loading),p.xp6(2),p.s9C("title",p.lcZ(3,3,"loading")),p.xp6(4),p.Oqu(p.lcZ(7,5,"save"))}}class ut extends Ri.t{constructor(e,i,t,n,o,l,s,r,c,a,d){super(e,i,t,n,o,l,s,r,c,a),this.configService=d,this.viewOnly=!1,this.flexibleCollectionsV1Enabled=!1,this.restrictProviderAccess=!1}ngOnInit(){const e=Object.create(null,{ngOnInit:{get:()=>super.ngOnInit}});return it(this,void 0,void 0,(function*(){yield e.ngOnInit.call(this),this.flexibleCollectionsV1Enabled=yield(0,wi.z)(this.configService.getFeatureFlag$(F.T.FlexibleCollectionsV1)),this.restrictProviderAccess=yield(0,wi.z)(this.configService.getFeatureFlag$(F.T.RestrictProviderAccess))}))}reupload(e){const i=Object.create(null,{reuploadCipherAttachment:{get:()=>super.reuploadCipherAttachment}});return it(this,void 0,void 0,(function*(){this.organization.canEditAllCiphers(this.flexibleCollectionsV1Enabled,this.restrictProviderAccess)&&this.showFixOldAttachments(e)&&(yield i.reuploadCipherAttachment.call(this,e,!0))}))}loadCipher(){const e=Object.create(null,{loadCipher:{get:()=>super.loadCipher}});return it(this,void 0,void 0,(function*(){if(!this.organization.canEditAllCiphers(this.flexibleCollectionsV1Enabled,this.restrictProviderAccess))return yield e.loadCipher.call(this);const i=yield this.apiService.getCipherAdmin(this.cipherId);return new Bi.t(new Vi.O(i))}))}saveCipherAttachment(e){return this.cipherService.saveAttachmentWithServer(this.cipherDomain,e,this.organization.canEditAllCiphers(this.flexibleCollectionsV1Enabled,this.restrictProviderAccess))}deleteCipherAttachment(e){return this.organization.canEditAllCiphers(this.flexibleCollectionsV1Enabled,this.restrictProviderAccess)?this.apiService.deleteCipherAttachmentAdmin(this.cipherId,e):super.deleteCipherAttachment(e)}showFixOldAttachments(e){return null==e.key&&this.organization.canEditAllCiphers(this.flexibleCollectionsV1Enabled,this.restrictProviderAccess)}}ut.ɵfac=function(e){return new(e||ut)(p.Y36(vi.u),p.Y36(P.D),p.Y36(ji.$),p.Y36(Hi.b),p.Y36(O.P),p.Y36(k.s),p.Y36($.$),p.Y36(Ki._),p.Y36(D.x),p.Y36(Wi.M),p.Y36(Q.E))},ut.ɵcmp=p.Xpm({type:ut,selectors:[["app-org-vault-attachments"]],features:[p.qOj],decls:42,vars:14,consts:[["role","dialog","aria-modal","true","aria-labelledby","attachmentsTitle",1,"modal","fade"],["role","document",1,"modal-dialog","modal-dialog-scrollable"],["ngNativeValidate","",1,"modal-content",3,"appApiAction","ngSubmit"],["form",""],[1,"modal-header"],["id","attachmentsTitle",1,"modal-title"],[4,"ngIf"],["type","button","data-dismiss","modal",1,"close",3,"appA11yTitle"],["aria-hidden","true"],[1,"modal-body"],["class","table table-hover table-list",4,"ngIf"],[1,"modal-footer"],["type","submit","class","btn btn-primary btn-submit",3,"disabled",4,"ngIf"],["type","button","data-dismiss","modal",1,"btn","btn-outline-secondary"],[1,"table","table-hover","table-list"],[4,"ngFor","ngForOf"],[1,"table-list-icon"],["class","bwi bwi-fw bwi-lg bwi-file","aria-hidden","true",4,"ngIf"],["class","bwi bwi-spinner bwi-lg bwi-fw bwi-spin","aria-hidden","true",4,"ngIf"],[1,"wrap"],[1,"d-flex"],["href","#","appStopClick","",3,"click"],["class","ml-2",4,"ngIf"],["class","table-list-options",4,"ngIf"],["aria-hidden","true",1,"bwi","bwi-fw","bwi-lg","bwi-file"],["aria-hidden","true",1,"bwi","bwi-spinner","bwi-lg","bwi-fw","bwi-spin"],[1,"ml-2"],["href","https://bitwarden.com/help/attachments/#fixing-old-attachments","target","_blank","rel","noreferrer"],["aria-hidden","true",1,"bwi","bwi-exclamation-triangle","text-warning",3,"title"],[1,"sr-only"],["type","button",1,"btn","btn-outline-primary","btn-sm","m-0","py-0","px-2",3,"appApiAction","disabled","click"],["reuploadBtn",""],[1,"table-list-options"],["type","button","appStopClick","",1,"btn","btn-outline-danger",3,"appA11yTitle","appApiAction","disabled","click"],["deleteBtn",""],["aria-hidden","true",1,"bwi","bwi-trash","bwi-lg","bwi-fw",3,"hidden"],["aria-hidden","true",1,"bwi","bwi-spinner","bwi-spin","bwi-lg","bwi-fw",3,"hidden","title"],["for","file",1,"sr-only"],["type","file","id","file","name","file","required","",1,"form-control-file"],[1,"form-text","text-muted"],["type","submit",1,"btn","btn-primary","btn-submit",3,"disabled"],["aria-hidden","true",1,"bwi","bwi-spinner","bwi-spin",3,"title"]],template:function(e,i){1&e&&(p.TgZ(0,"div",0),p._uU(1,"\n  "),p.TgZ(2,"div",1),p._uU(3,"\n    "),p.TgZ(4,"form",2,3),p.NdJ("ngSubmit",(function(){return i.submit()})),p._uU(6,"\n      "),p.TgZ(7,"div",4),p._uU(8,"\n        "),p.TgZ(9,"h1",5),p._uU(10),p.ALo(11,"i18n"),p.YNc(12,tt,2,1,"small",6),p._uU(13,"\n        "),p.qZA(),p._uU(14,"\n        "),p.TgZ(15,"button",7),p.ALo(16,"i18n"),p._uU(17,"\n          "),p.TgZ(18,"span",8),p._uU(19,"×"),p.qZA(),p._uU(20,"\n        "),p.qZA(),p._uU(21,"\n      "),p.qZA(),p._uU(22,"\n      "),p.TgZ(23,"div",9),p._uU(24,"\n        "),p.YNc(25,ct,7,1,"table",10),p._uU(26,"\n        "),p.YNc(27,at,16,9,"div",6),p._uU(28,"\n      "),p.qZA(),p._uU(29,"\n      "),p.TgZ(30,"div",11),p._uU(31,"\n        "),p.YNc(32,dt,9,7,"button",12),p._uU(33,"\n        "),p.TgZ(34,"button",13),p._uU(35),p.ALo(36,"i18n"),p.qZA(),p._uU(37,"\n      "),p.qZA(),p._uU(38,"\n    "),p.qZA(),p._uU(39,"\n  "),p.qZA(),p._uU(40,"\n"),p.qZA(),p._uU(41,"\n")),2&e&&(p.xp6(4),p.Q6J("appApiAction",i.formPromise),p.xp6(6),p.hij("\n          ",p.lcZ(11,8,"attachments"),"\n          "),p.xp6(2),p.Q6J("ngIf",i.cipher),p.xp6(3),p.s9C("appA11yTitle",p.lcZ(16,10,"close")),p.xp6(10),p.Q6J("ngIf",i.cipher&&i.cipher.hasAttachments),p.xp6(2),p.Q6J("ngIf",!i.viewOnly),p.xp6(5),p.Q6J("ngIf",!i.viewOnly),p.xp6(3),p.hij("\n          ",p.lcZ(36,12,"close"),"\n        "))},dependencies:[B.sg,B.O5,q.JL,q.F,R.B,Xi.b,et.O,ae.C],encapsulation:2});var ht,pt=t(6378),gt=function(e,i,t,n){return new(t||(t=Promise))((function(o,l){function s(e){try{c(n.next(e))}catch(i){l(i)}}function r(e){try{c(n.throw(e))}catch(i){l(i)}}function c(e){var i;e.done?o(e.value):(i=e.value,i instanceof t?i:new t((function(e){e(i)}))).then(s,r)}c((n=n.apply(e,i||[])).next())}))};function ft(e,i){if(1&e&&(p.TgZ(0,"p"),p._uU(1),p.ALo(2,"i18n"),p.qZA()),2&e){const e=p.oxw();p.xp6(1),p.hij("\n      ",p.Dn7(2,1,"bulkCollectionAssignmentWarning",e.totalItemCount,e.readonlyItemCount),"\n    ")}}function mt(e,i){if(1&e){const e=p.EpF();p.TgZ(0,"tr",16),p._uU(1,"\n          "),p.TgZ(2,"td",9),p._uU(3,"\n            "),p._UZ(4,"i",17),p._uU(5),p.qZA(),p._uU(6,"\n          "),p.TgZ(7,"td",18),p._uU(8,"\n            "),p.TgZ(9,"button",19),p.NdJ("click",(function(){const i=p.CHM(e).index,t=p.oxw(2);return p.KtG(t.unselectCollection(i))})),p.ALo(10,"i18n"),p.qZA(),p._uU(11,"\n          "),p.qZA(),p._uU(12,"\n        "),p.qZA()}if(2&e){const e=i.$implicit;p.xp6(5),p.hij("\n            ",e.labelName,"\n          "),p.xp6(4),p.hYB("appA11yTitle","",p.lcZ(10,3,"remove")," ",e.labelName,"")}}function bt(e,i){1&e&&(p.TgZ(0,"tr"),p._uU(1,"\n          "),p.TgZ(2,"td",9),p._uU(3),p.ALo(4,"i18n"),p.qZA(),p._uU(5,"\n        "),p.qZA()),2&e&&(p.xp6(3),p.hij("\n            ",p.lcZ(4,1,"noCollectionsAssigned"),"\n          "))}function vt(e,i){if(1&e&&(p._uU(0,"\n        "),p.YNc(1,mt,13,5,"tr",15),p._uU(2,"\n        "),p.YNc(3,bt,6,3,"tr",4),p._uU(4,"\n      ")),2&e){const e=p.oxw();p.xp6(1),p.Q6J("ngForOf",e.selectedCollections),p.xp6(2),p.Q6J("ngIf",0==e.selectedCollections.length)}}!function(e){e.Saved="saved",e.Canceled="canceled"}(ht||(ht={}));class Ut{constructor(e,i,t,n,o,l,s){this.params=e,this.dialogRef=i,this.cipherService=t,this.i18nService=n,this.platformUtilsService=o,this.configService=l,this.organizationService=s,this.availableCollections=[],this.selectedCollections=[],this.editableItems=[],this.destroy$=new f.x,this.pluralize=(e,i,t)=>`${e} ${this.i18nService.t(1===e?i:t)}`,this.sortItems=(e,i)=>this.i18nService.collator.compare(e.labelName,i.labelName),this.submit=()=>gt(this,void 0,void 0,(function*(){if(!this.isValid)return;const e=this.editableItems.map((e=>e.id));this.selectedCollections.length>0&&(yield this.cipherService.bulkUpdateCollectionsWithServer(this.params.organizationId,e,this.selectedCollections.map((e=>e.id)),!1)),null!=this.params.activeCollection&&null==this.selectedCollections.find((e=>e.id===this.params.activeCollection.id))&&(yield this.cipherService.bulkUpdateCollectionsWithServer(this.params.organizationId,e,[this.params.activeCollection.id],!0)),this.platformUtilsService.showToast("success",null,this.i18nService.t("successfullyAssignedCollections")),this.dialogRef.close(ht.Saved)}))}ngOnInit(){return gt(this,void 0,void 0,(function*(){if(null==this.params.ciphers||this.params.ciphers.length<1)return this.platformUtilsService.showToast("error",null,this.i18nService.t("nothingSelected")),void this.dialogRef.close(ht.Canceled);const e=yield this.configService.getFeatureFlag(F.T.FlexibleCollectionsV1),i=yield this.configService.getFeatureFlag(F.T.RestrictProviderAccess);if((yield this.organizationService.get(this.params.organizationId)).canEditAllCiphers(e,i)?this.editableItems=this.params.ciphers:this.editableItems=this.params.ciphers.filter((e=>e.edit)),this.editableItemCount=this.editableItems.length,0==this.editableItemCount)return this.platformUtilsService.showToast("error",null,this.i18nService.t("missingPermissions")),void this.dialogRef.close(ht.Canceled);this.totalItemCount=this.params.ciphers.length,this.readonlyItemCount=this.totalItemCount-this.editableItemCount,this.availableCollections=this.params.availableCollections.map((e=>({icon:"bwi-collection",id:e.id,labelName:e.name,listName:e.name}))),this.params.activeCollection&&this.selectCollections([{icon:"bwi-collection",id:this.params.activeCollection.id,labelName:this.params.activeCollection.name,listName:this.params.activeCollection.name}])}))}selectCollections(e){this.selectedCollections=[...this.selectedCollections,...e].sort(this.sortItems),this.availableCollections=this.availableCollections.filter((i=>!e.find((e=>e.id===i.id))))}unselectCollection(e){const i=this.selectedCollections.splice(e,1);this.availableCollections=[...this.availableCollections,...i].sort(this.sortItems)}get isValid(){return null!=this.params.activeCollection||this.selectedCollections.length>0}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static open(e,i){return e.open(Ut,i)}}Ut.ɵfac=function(e){return new(e||Ut)(p.Y36(I.Kt),p.Y36(I.zj),p.Y36(vi.u),p.Y36(P.D),p.Y36(O.P),p.Y36(Q.E),p.Y36(a.Mn))},Ut.ɵcmp=p.Xpm({type:Ut,selectors:[["app-bulk-collection-assignment-dialog"]],standalone:!0,features:[p.jDz],decls:56,vars:24,consts:[["dialogSize","large"],["bitDialogTitle",""],[1,"tw-text-sm","tw-normal-case","tw-text-muted"],["bitDialogContent",""],[4,"ngIf"],[1,"tw-flex"],[1,"tw-grow"],[1,"tw-w-full",3,"baseItems","removeSelectedItems","onItemsConfirmed"],["header",""],["bitCell",""],["bitCell","",1,"tw-w-20"],["body",""],["bitDialogFooter",""],["type","submit","bitButton","","buttonType","primary",3,"bitAction","disabled"],["type","button","bitButton","","buttonType","secondary","bitDialogClose",""],["bitRow","",4,"ngFor","ngForOf"],["bitRow",""],["aria-hidden","true",1,"bwi","bwi-collection"],["bitCell","",1,"tw-text-right"],["type","button","bitIconButton","bwi-close","buttonType","muted",3,"appA11yTitle","click"]],template:function(e,i){1&e&&(p.TgZ(0,"bit-dialog",0),p._uU(1,"\n  "),p.TgZ(2,"span",1),p._uU(3),p.ALo(4,"i18n"),p.TgZ(5,"span",2),p._uU(6),p.qZA(),p._uU(7,"\n  "),p.qZA(),p._uU(8,"\n\n  "),p.TgZ(9,"div",3),p._uU(10,"\n    "),p.TgZ(11,"p"),p._uU(12),p.ALo(13,"i18n"),p.qZA(),p._uU(14,"\n\n    "),p.YNc(15,ft,3,5,"p",4),p._uU(16,"\n\n    "),p.TgZ(17,"div",5),p._uU(18,"\n      "),p.TgZ(19,"bit-form-field",6),p._uU(20,"\n        "),p.TgZ(21,"bit-label"),p._uU(22),p.ALo(23,"i18n"),p.qZA(),p._uU(24,"\n        "),p.TgZ(25,"bit-multi-select",7),p.NdJ("onItemsConfirmed",(function(e){return i.selectCollections(e)})),p.qZA(),p._uU(26,"\n      "),p.qZA(),p._uU(27,"\n    "),p.qZA(),p._uU(28,"\n\n    "),p.TgZ(29,"bit-table"),p._uU(30,"\n      "),p.ynx(31,8),p._uU(32,"\n        "),p.TgZ(33,"td",9),p._uU(34),p.ALo(35,"i18n"),p.qZA(),p._uU(36,"\n        "),p._UZ(37,"td",10),p._uU(38,"\n      "),p.BQk(),p._uU(39,"\n      "),p.YNc(40,vt,5,2,"ng-template",11),p._uU(41,"\n    "),p.qZA(),p._uU(42,"\n  "),p.qZA(),p._uU(43,"\n\n  "),p.ynx(44,12),p._uU(45,"\n    "),p.TgZ(46,"button",13),p._uU(47),p.ALo(48,"i18n"),p.qZA(),p._uU(49,"\n    "),p.TgZ(50,"button",14),p._uU(51),p.ALo(52,"i18n"),p.qZA(),p._uU(53,"\n  "),p.BQk(),p._uU(54,"\n"),p.qZA(),p._uU(55,"\n")),2&e&&(p.xp6(3),p.hij("\n    ",p.lcZ(4,12,"assignToCollections"),"\n    "),p.xp6(3),p.hij("\n      ",i.pluralize(i.editableItemCount,"item","items"),"\n    "),p.xp6(6),p.Oqu(p.lcZ(13,14,"bulkCollectionAssignmentDialogDescription")),p.xp6(3),p.Q6J("ngIf",i.readonlyItemCount>0),p.xp6(7),p.Oqu(p.lcZ(23,16,"selectCollectionsToAssign")),p.xp6(3),p.Q6J("baseItems",i.availableCollections)("removeSelectedItems",!0),p.xp6(9),p.Oqu(p.lcZ(35,18,"assignToTheseCollections")),p.xp6(12),p.Q6J("bitAction",i.submit)("disabled",!i.isValid),p.xp6(1),p.hij("\n      ",p.lcZ(48,20,"assign"),"\n    "),p.xp6(4),p.hij("\n      ",p.lcZ(52,22,"cancel"),"\n    "))},dependencies:[l.m,B.sg,B.O5,R.B,j.Q,W.r,X.a,ee.f,ie.d,pt.O,ne.u,le.Q,Ie.a,qe.Y,ze.v,Ie.f,ae.C],encapsulation:2});var At,Ct=function(e,i,t,n){return new(t||(t=Promise))((function(o,l){function s(e){try{c(n.next(e))}catch(i){l(i)}}function r(e){try{c(n.throw(e))}catch(i){l(i)}}function c(e){var i;e.done?o(e.value):(i=e.value,i instanceof t?i:new t((function(e){e(i)}))).then(s,r)}c((n=n.apply(e,i||[])).next())}))};function Zt(e,i){if(1&e&&(p._UZ(0,"bit-access-selector",10),p.ALo(1,"i18n"),p.ALo(2,"i18n"),p.ALo(3,"i18n"),p.ALo(4,"i18n"),p.ALo(5,"async")),2&e){const e=p.oxw();p.Q6J("permissionMode",e.PermissionMode.Edit)("items",e.accessItems)("columnHeader",p.lcZ(1,7,"groupSlashMemberColumnHeader"))("selectorLabelText",p.lcZ(2,9,"selectGroupsAndMembers"))("selectorHelpText",p.lcZ(3,11,"userPermissionOverrideHelperDesc"))("emptySelectionText",p.lcZ(4,13,"noMembersOrGroupsAdded"))("flexibleCollectionsEnabled",p.lcZ(5,15,e.flexibleCollectionsEnabled$))}}function xt(e,i){if(1&e&&(p._UZ(0,"bit-access-selector",11),p.ALo(1,"i18n"),p.ALo(2,"i18n"),p.ALo(3,"i18n"),p.ALo(4,"async")),2&e){const e=p.oxw();p.Q6J("permissionMode",e.PermissionMode.Edit)("items",e.accessItems)("columnHeader",p.lcZ(1,6,"memberColumnHeader"))("selectorLabelText",p.lcZ(2,8,"selectMembers"))("emptySelectionText",p.lcZ(3,10,"noMembersAdded"))("flexibleCollectionsEnabled",p.lcZ(4,12,e.flexibleCollectionsEnabled$))}}!function(e){e.Saved="saved",e.Canceled="canceled"}(At||(At={}));class wt{constructor(e,i,t,n,o,l,s,r,c){this.params=e,this.dialogRef=i,this.formBuilder=t,this.organizationService=n,this.groupService=o,this.organizationUserService=l,this.platformUtilsService=s,this.i18nService=r,this.collectionAdminService=c,this.flexibleCollectionsEnabled$=this.organizationService.get$(this.params.organizationId).pipe((0,C.U)((e=>null==e?void 0:e.flexibleCollections))),this.PermissionMode=Y.R9,this.formGroup=this.formBuilder.group({access:[[]]}),this.loading=!0,this.accessItems=[],this.destroy$=new f.x,this.submit=()=>Ct(this,void 0,void 0,(function*(){const e=this.formGroup.controls.access.value.filter((e=>e.type===Y.zD.Member)).map(Y.E2),i=this.formGroup.controls.access.value.filter((e=>e.type===Y.zD.Group)).map(Y.E2);yield this.collectionAdminService.bulkAssignAccess(this.organization.id,this.params.collections.map((e=>e.id)),e,i),this.platformUtilsService.showToast("success",null,this.i18nService.t("editedCollections")),this.dialogRef.close(At.Saved)})),this.numCollections=this.params.collections.length;const a=this.organizationService.get$(this.params.organizationId),d=a.pipe((0,b.w)((e=>e.useGroups?this.groupService.getAll(e.id):(0,E.of)([]))));(0,v.a)([a,d,this.organizationUserService.getAllUsers(this.params.organizationId)]).pipe((0,Z.R)(this.destroy$)).subscribe((([e,i,t])=>{this.organization=e,this.accessItems=[].concat(i.map(Y.hs),t.data.map(Y.XL)),this.loading=!1}))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static open(e,i){return e.open(wt,i)}}wt.ɵfac=function(e){return new(e||wt)(p.Y36(I.Kt),p.Y36(I.zj),p.Y36(q.qu),p.Y36(a.Mn),p.Y36(s.lT),p.Y36(N.t),p.Y36(O.P),p.Y36(P.D),p.Y36(L.m))},wt.ɵcmp=p.Xpm({type:wt,selectors:[["app-bulk-collections-dialog"]],standalone:!0,features:[p.jDz],decls:32,vars:18,consts:[[3,"formGroup","bitSubmit"],["dialogSize","large",3,"loading"],["bitDialogTitle",""],[1,"tw-text-sm","tw-normal-case","tw-text-muted"],["bitDialogContent",""],["formControlName","access",3,"permissionMode","items","columnHeader","selectorLabelText","selectorHelpText","emptySelectionText","flexibleCollectionsEnabled",4,"ngIf"],["formControlName","access",3,"permissionMode","items","columnHeader","selectorLabelText","emptySelectionText","flexibleCollectionsEnabled",4,"ngIf"],["bitDialogFooter",""],["type","submit","bitButton","","bitFormButton","","buttonType","primary"],["type","button","bitButton","","bitFormButton","","buttonType","secondary","bitDialogClose",""],["formControlName","access",3,"permissionMode","items","columnHeader","selectorLabelText","selectorHelpText","emptySelectionText","flexibleCollectionsEnabled"],["formControlName","access",3,"permissionMode","items","columnHeader","selectorLabelText","emptySelectionText","flexibleCollectionsEnabled"]],template:function(e,i){1&e&&(p.TgZ(0,"form",0),p._uU(1,"\n  "),p.TgZ(2,"bit-dialog",1),p._uU(3,"\n    "),p.TgZ(4,"span",2),p._uU(5),p.ALo(6,"i18n"),p.TgZ(7,"span",3),p._uU(8),p.ALo(9,"i18n"),p.qZA(),p._uU(10,"\n    "),p.qZA(),p._uU(11,"\n\n    "),p.TgZ(12,"div",4),p._uU(13,"\n      "),p.YNc(14,Zt,6,17,"bit-access-selector",5),p._uU(15,"\n      "),p.YNc(16,xt,5,14,"bit-access-selector",6),p._uU(17,"\n    "),p.qZA(),p._uU(18,"\n\n    "),p.ynx(19,7),p._uU(20,"\n      "),p.TgZ(21,"button",8),p._uU(22),p.ALo(23,"i18n"),p.qZA(),p._uU(24,"\n      "),p.TgZ(25,"button",9),p._uU(26),p.ALo(27,"i18n"),p.qZA(),p._uU(28,"\n    "),p.BQk(),p._uU(29,"\n  "),p.qZA(),p._uU(30,"\n"),p.qZA(),p._uU(31,"\n")),2&e&&(p.Q6J("formGroup",i.formGroup)("bitSubmit",i.submit),p.xp6(2),p.Q6J("loading",i.loading),p.xp6(3),p.hij("\n      ",p.lcZ(6,10,"assignCollectionAccess"),"\n      "),p.xp6(3),p.AsE("\n        ",i.numCollections," ",p.lcZ(9,12,1==i.numCollections?"collection":"collections"),"\n      "),p.xp6(6),p.Q6J("ngIf",null==i.organization?null:i.organization.useGroups),p.xp6(2),p.Q6J("ngIf",!(null!=i.organization&&i.organization.useGroups)),p.xp6(6),p.hij("\n        ",p.lcZ(23,14,"save"),"\n      "),p.xp6(4),p.hij("\n        ",p.lcZ(27,16,"cancel"),"\n      "))},dependencies:[l.m,B.O5,q._Y,q.JJ,q.JL,q.sg,q.u,H.b,K.u,W.r,X.a,ee.f,B.Ov,ae.C,Y.k4,ce.f],encapsulation:2});var _t=t(43898),yt=t(12963),Tt=function(e,i,t,n){return new(t||(t=Promise))((function(o,l){function s(e){try{c(n.next(e))}catch(i){l(i)}}function r(e){try{c(n.throw(e))}catch(i){l(i)}}function c(e){var i;e.done?o(e.value):(i=e.value,i instanceof t?i:new t((function(e){e(i)}))).then(s,r)}c((n=n.apply(e,i||[])).next())}))};function St(e,i){if(1&e&&(p.TgZ(0,"small"),p._uU(1),p.qZA()),2&e){const e=p.oxw();p.xp6(1),p.Oqu(e.cipher.name)}}function It(e,i){if(1&e){const e=p.EpF();p.TgZ(0,"div",10),p._uU(1,"\n          "),p.TgZ(2,"button",11),p.NdJ("click",(function(){p.CHM(e);const i=p.oxw();return p.KtG(i.selectAll(!0))})),p._uU(3),p.ALo(4,"i18n"),p.qZA(),p._uU(5,"\n          "),p.TgZ(6,"button",11),p.NdJ("click",(function(){p.CHM(e);const i=p.oxw();return p.KtG(i.selectAll(!1))})),p._uU(7),p.ALo(8,"i18n"),p.qZA(),p._uU(9,"\n        "),p.qZA()}2&e&&(p.xp6(3),p.hij("\n            ",p.lcZ(4,2,"selectAll"),"\n          "),p.xp6(4),p.hij("\n            ",p.lcZ(8,4,"unselectAll"),"\n          "))}function qt(e,i){1&e&&(p.TgZ(0,"div"),p._uU(1),p.ALo(2,"i18n"),p.qZA()),2&e&&(p.xp6(1),p.hij("\n        ",p.lcZ(2,1,"noCollectionsInList"),"\n      "))}function zt(e,i){if(1&e){const e=p.EpF();p.TgZ(0,"tr",14),p.NdJ("click",(function(){const i=p.CHM(e).$implicit,t=p.oxw(3);return p.KtG(t.check(i))})),p._uU(1,"\n            "),p.TgZ(2,"td",15),p._uU(3,"\n              "),p.TgZ(4,"input",16),p.NdJ("ngModelChange",(function(i){const t=p.CHM(e).$implicit;return p.KtG(t.checked=i)})),p.qZA(),p._uU(5),p.qZA(),p._uU(6,"\n          "),p.qZA()}if(2&e){const e=i.$implicit,t=i.index,n=p.oxw(3);p.xp6(4),p.MGl("name","Collection[",t,"].Checked"),p.Q6J("ngModel",e.checked)("disabled",!e.canEditItems(n.organization,n.flexibleCollectionsV1Enabled,n.restrictProviderAccess)),p.xp6(1),p.hij("\n              ",e.name,"\n            ")}}function Et(e,i){if(1&e&&(p._uU(0,"\n          "),p.YNc(1,zt,7,4,"tr",13),p._uU(2,"\n        ")),2&e){const e=p.oxw(2);p.xp6(1),p.Q6J("ngForOf",e.collections)}}function Mt(e,i){1&e&&(p.TgZ(0,"bit-table"),p._uU(1,"\n        "),p.YNc(2,Et,3,1,"ng-template",12),p._uU(3,"\n      "),p.qZA())}class Ft extends Ni.Ur{constructor(e,i,t,n,o,l,s,r,c,a){super(e,i,t,n,o,s,r,c,a),this.apiService=l,this.dialogRef=c,this.allowSelectNone=!0,this.collectionIds=null==a?void 0:a.collectionIds,this.collections=null==a?void 0:a.collections,this.organization=null==a?void 0:a.organization,this.cipherId=null==a?void 0:a.cipherId}loadCipher(){const e=Object.create(null,{loadCipher:{get:()=>super.loadCipher}});return Tt(this,void 0,void 0,(function*(){if(!this.organization.canEditAllCiphers(this.flexibleCollectionsV1Enabled,this.restrictProviderAccess)&&0!==this.collectionIds.length)return yield e.loadCipher.call(this);const i=yield this.apiService.getCipherAdmin(this.cipherId);return new Bi.t(new Vi.O(i))}))}loadCipherCollections(){return this.organization.canViewAllCollections?this.collectionIds:super.loadCipherCollections()}loadCollections(){return this.organization.canViewAllCollections?Promise.resolve(this.collections):super.loadCollections()}saveCollections(){if(this.organization.canEditAllCiphers(this.flexibleCollectionsV1Enabled,this.restrictProviderAccess)||0===this.collectionIds.length){const e=new _t.L(this.cipherDomain.collectionIds);return this.apiService.putCipherCollectionsAdmin(this.cipherId,e)}return super.saveCollections()}}Ft.ɵfac=function(e){return new(e||Ft)(p.Y36(Ce.a),p.Y36(O.P),p.Y36(P.D),p.Y36(vi.u),p.Y36(a.Mn),p.Y36(k.s),p.Y36($.$),p.Y36(Q.E),p.Y36(I.zj),p.Y36(I.Kt))},Ft.ɵcmp=p.Xpm({type:Ft,selectors:[["app-org-vault-collections"]],features:[p.qOj],decls:43,vars:19,consts:[[3,"ngSubmit"],["bitDialogTitle",""],[4,"ngIf"],["bitDialogContent",""],[1,"tw-flex"],[1,"tw-mb-1","tw-block","tw-font-semibold","tw-text-main"],["class","tw-ml-auto tw-flex",4,"ngIf"],["bitDialogFooter",""],["bitButton","","buttonType","primary","type","submit"],["bitButton","","bitDialogClose","","buttonType","secondary","type","button"],[1,"tw-ml-auto","tw-flex"],["bitLink","","type","button",1,"tw-px-2",3,"click"],["body",""],["bitRow","",3,"click",4,"ngFor","ngForOf"],["bitRow","",3,"click"],["bitCell",""],["type","checkbox","bitCheckbox","","appStopProp","",3,"ngModel","name","disabled","ngModelChange"]],template:function(e,i){1&e&&(p.TgZ(0,"form",0),p.NdJ("ngSubmit",(function(){return i.submit()})),p._uU(1,"\n  "),p.TgZ(2,"bit-dialog"),p._uU(3,"\n    "),p.TgZ(4,"span",1),p._uU(5),p.ALo(6,"i18n"),p.YNc(7,St,2,1,"small",2),p._uU(8,"\n    "),p.qZA(),p._uU(9,"\n    "),p.ynx(10,3),p._uU(11,"\n      "),p.TgZ(12,"p"),p._uU(13),p.ALo(14,"i18n"),p.qZA(),p._uU(15,"\n      "),p.TgZ(16,"div",4),p._uU(17,"\n        "),p.TgZ(18,"label",5),p._uU(19),p.ALo(20,"i18n"),p.qZA(),p._uU(21,"\n        "),p.YNc(22,It,10,6,"div",6),p._uU(23,"\n      "),p.qZA(),p._uU(24,"\n      "),p.YNc(25,qt,3,3,"div",2),p._uU(26,"\n      "),p.YNc(27,Mt,4,0,"bit-table",2),p._uU(28,"\n    "),p.BQk(),p._uU(29,"\n    "),p.ynx(30,7),p._uU(31,"\n      "),p.TgZ(32,"button",8),p._uU(33),p.ALo(34,"i18n"),p.qZA(),p._uU(35,"\n      "),p.TgZ(36,"button",9),p._uU(37),p.ALo(38,"i18n"),p.qZA(),p._uU(39,"\n    "),p.BQk(),p._uU(40,"\n  "),p.qZA(),p._uU(41,"\n"),p.qZA(),p._uU(42,"\n")),2&e&&(p.xp6(5),p.hij("\n      ",p.lcZ(6,9,"collections"),"\n      "),p.xp6(2),p.Q6J("ngIf",i.cipher),p.xp6(6),p.Oqu(p.lcZ(14,11,"collectionsDesc")),p.xp6(6),p.Oqu(p.lcZ(20,13,"collections")),p.xp6(3),p.Q6J("ngIf",i.collections&&i.collections.length),p.xp6(3),p.Q6J("ngIf",!i.collections||!i.collections.length),p.xp6(2),p.Q6J("ngIf",i.collections&&i.collections.length),p.xp6(6),p.hij("\n        ",p.lcZ(34,15,"save"),"\n      "),p.xp6(4),p.hij("\n        ",p.lcZ(38,17,"cancel"),"\n      "))},dependencies:[B.sg,B.O5,q._Y,q.Wl,q.JJ,q.JL,q.On,q.F,yt._,W.r,we.b,X.a,ee.f,_e._,Ie.a,qe.Y,ze.v,Ie.f,ae.C],encapsulation:2});var Jt=t(4871),Lt=t(94572),Yt=t(7323),kt=t(87483),Nt=t(8067),Pt=(t(27263),t(30276)),Ot=t(26187),$t=function(e,i,t,n){return new(t||(t=Promise))((function(o,l){function s(e){try{c(n.next(e))}catch(i){l(i)}}function r(e){try{c(n.throw(e))}catch(i){l(i)}}function c(e){var i;e.done?o(e.value):(i=e.value,i instanceof t?i:new t((function(e){e(i)}))).then(s,r)}c((n=n.apply(e,i||[])).next())}))};function Dt(e,i){1&e&&(p.TgZ(0,"div",3),p._uU(1,"\n    "),p._UZ(2,"i",4),p._uU(3,"\n  "),p.qZA())}function Gt(e,i){if(1&e&&(p.ynx(0),p._uU(1,"\n        "),p.TgZ(2,"div",12),p._uU(3,"\n          "),p.TgZ(4,"app-filter-section",13),p._uU(5," "),p.qZA(),p._uU(6,"\n        "),p.qZA(),p._uU(7,"\n      "),p.BQk()),2&e){const e=i.$implicit,t=p.oxw(2);p.xp6(4),p.Q6J("activeFilter",t.activeFilter)("section",e)}}function Qt(e,i){if(1&e){const e=p.EpF();p.TgZ(0,"div"),p._uU(1,"\n    "),p.TgZ(2,"div",5),p._uU(3),p.ALo(4,"i18n"),p.TgZ(5,"a",6),p.ALo(6,"i18n"),p._uU(7,"\n        "),p._UZ(8,"i",7),p._uU(9,"\n      "),p.qZA(),p._uU(10,"\n    "),p.qZA(),p._uU(11,"\n    "),p.TgZ(12,"div",8),p._uU(13,"\n      "),p.TgZ(14,"div",9),p._uU(15,"\n        "),p.TgZ(16,"bit-search",10),p.NdJ("ngModelChange",(function(i){p.CHM(e);const t=p.oxw();return p.KtG(t.searchText=i)}))("ngModelChange",(function(i){p.CHM(e);const t=p.oxw();return p.KtG(t.onSearchTextChanged(i))})),p.ALo(17,"i18n"),p.qZA(),p._uU(18,"\n      "),p.qZA(),p._uU(19,"\n      "),p.YNc(20,Gt,8,2,"ng-container",11),p._uU(21,"\n    "),p.qZA(),p._uU(22,"\n  "),p.qZA()}if(2&e){const e=p.oxw();p.xp6(3),p.hij("\n      ",p.lcZ(4,5,"filters"),"\n      "),p.xp6(2),p.s9C("appA11yTitle",p.lcZ(6,7,"learnMore")),p.xp6(11),p.s9C("placeholder",p.lcZ(17,9,e.searchPlaceholder)),p.Q6J("ngModel",e.searchText),p.xp6(4),p.Q6J("ngForOf",e.filtersList)}}class Vt extends Pt.P{set organization(e){e&&e!==this._organization&&(this._organization=e,this.vaultFilterService.setOrganizationFilter(this._organization))}constructor(e,i,t,n){super(e,i,t,n),this.vaultFilterService=e,this.policyService=i,this.i18nService=t,this.platformUtilsService=n}ngOnInit(){return $t(this,void 0,void 0,(function*(){this.filters=yield this.buildAllFilters(),this.activeFilter.selectedCipherTypeNode||(this.activeFilter.resetFilter(),this.activeFilter.selectedCollectionNode=yield this.getDefaultFilter()),this.isLoaded=!0}))}ngOnChanges(e){return $t(this,void 0,void 0,(function*(){e.organization&&(this.filters=yield this.buildAllFilters())}))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}removeCollapsibleCollection(){return $t(this,void 0,void 0,(function*(){const e=yield(0,wi.z)(this.vaultFilterService.collapsedFilterNodes$);e.delete("AllCollections"),yield this.vaultFilterService.setCollapsedFilterNodes(e)}))}addCollectionFilter(){return $t(this,void 0,void 0,(function*(){this.removeCollapsibleCollection();return{data$:this.vaultFilterService.buildTypeTree({id:"AllCollections",name:"collections",type:"all",icon:"bwi-collection"},[{id:"AllCollections",name:"Collections",type:"all",icon:"bwi-collection"}]),header:{showHeader:!1,isSelectable:!0},action:this.applyCollectionFilter}}))}buildAllFilters(){const e=Object.create(null,{addCollectionFilter:{get:()=>super.addCollectionFilter}});var i;return $t(this,void 0,void 0,(function*(){const t={};return t.typeFilter=yield this.addTypeFilter(["favorites"]),(null===(i=this._organization)||void 0===i?void 0:i.flexibleCollections)?t.collectionFilter=yield this.addCollectionFilter():t.collectionFilter=yield e.addCollectionFilter.call(this),t.trashFilter=yield this.addTrashFilter(),t}))}getDefaultFilter(){var e;return $t(this,void 0,void 0,(function*(){return yield(0,wi.z)(null===(e=this.filters)||void 0===e?void 0:e.collectionFilter.data$)}))}}Vt.ɵfac=function(e){return new(e||Vt)(p.Y36(hi.n),p.Y36(Ui.d),p.Y36(P.D),p.Y36(O.P))},Vt.ɵcmp=p.Xpm({type:Vt,selectors:[["app-organization-vault-filter"]],inputs:{organization:"organization"},features:[p.qOj,p.TTD],decls:7,vars:2,consts:[[1,"card","vault-filters"],["class","container loading-spinner",4,"ngIf"],[4,"ngIf"],[1,"container","loading-spinner"],["aria-hidden","true",1,"bwi","bwi-spinner","bwi-spin","bwi-3x"],[1,"card-header","d-flex"],["href","https://bitwarden.com/help/searching-vault/","target","_blank","rel","noreferrer",1,"ml-auto",3,"appA11yTitle"],["aria-hidden","true",1,"bwi","bwi-question-circle"],[1,"card-body"],[1,"tw-mb-4"],["id","search","autocomplete","off","appAutofocus","",3,"placeholder","ngModel","ngModelChange"],[4,"ngFor","ngForOf"],[1,"filter"],[3,"activeFilter","section"]],template:function(e,i){1&e&&(p.TgZ(0,"div",0),p._uU(1,"\n  "),p.YNc(2,Dt,4,0,"div",1),p._uU(3,"\n  "),p.YNc(4,Qt,23,11,"div",2),p._uU(5,"\n"),p.qZA(),p._uU(6,"\n")),2&e&&(p.xp6(2),p.Q6J("ngIf",!i.isLoaded),p.xp6(2),p.Q6J("ngIf",i.isLoaded))},dependencies:[B.sg,B.O5,q.JJ,q.On,R.B,G.U,Ot.n,Ee.g,ae.C],encapsulation:2});var Bt=t(53707),Rt=t(22221),jt=t(98797),Ht=t(65777),Kt=t(98583),Wt=t(8427),Xt=t(93814),en=function(e,i,t,n){return new(t||(t=Promise))((function(o,l){function s(e){try{c(n.next(e))}catch(i){l(i)}}function r(e){try{c(n.throw(e))}catch(i){l(i)}}function c(e){var i;e.done?o(e.value):(i=e.value,i instanceof t?i:new t((function(e){e(i)}))).then(s,r)}c((n=n.apply(e,i||[])).next())}))};function tn(e,i){1&e&&(p.TgZ(0,"span"),p._uU(1),p.ALo(2,"lowercase"),p.ALo(3,"i18n"),p.qZA()),2&e&&(p.xp6(1),p.hij("\n        ",p.lcZ(2,1,p.lcZ(3,3,"vault")),"\n      "))}function nn(e,i){1&e&&(p.TgZ(0,"span"),p._uU(1),p.ALo(2,"lowercase"),p.ALo(3,"i18n"),p.qZA()),2&e&&(p.xp6(1),p.hij("\n        ",p.lcZ(2,1,p.lcZ(3,3,"collections")),"\n      "))}const on=function(){return[]},ln=function(e){return{collectionId:e}};function sn(e,i){if(1&e&&(p.TgZ(0,"bit-breadcrumb",9),p._uU(1),p.qZA()),2&e){const e=i.$implicit;p.Q6J("route",p.DdM(3,on))("queryParams",p.VKq(4,ln,e.id)),p.xp6(1),p.hij("\n        ",e.name,"\n      ")}}const rn=function(e){return{organizationId:e,collectionId:null}};function cn(e,i){if(1&e&&(p.TgZ(0,"bit-breadcrumbs",6),p._uU(1,"\n    "),p.TgZ(2,"bit-breadcrumb",7),p._uU(3),p.YNc(4,tn,4,5,"span",3),p._uU(5,"\n      "),p.YNc(6,nn,4,5,"span",3),p._uU(7,"\n    "),p.qZA(),p._uU(8,"\n\n    "),p.ynx(9),p._uU(10,"\n      "),p.YNc(11,sn,2,6,"bit-breadcrumb",8),p._uU(12,"\n    "),p.BQk(),p._uU(13,"\n  "),p.qZA()),2&e){const e=p.oxw();p.xp6(2),p.Q6J("route",p.DdM(6,on))("queryParams",p.VKq(7,rn,e.organization.id)),p.xp6(1),p.hij("\n      ",e.organization.name,"\n      "),p.xp6(1),p.Q6J("ngIf",!e.organization.flexibleCollections),p.xp6(2),p.Q6J("ngIf",e.organization.flexibleCollections),p.xp6(5),p.Q6J("ngForOf",e.collections)}}function an(e,i){if(1&e){const e=p.EpF();p.ynx(0),p._uU(1,"\n          "),p.TgZ(2,"button",13),p.NdJ("click",(function(){p.CHM(e);const i=p.oxw(2);return p.KtG(i.editCollection(i.CollectionDialogTabType.Info,!1))})),p._uU(3,"\n            "),p._UZ(4,"i",14),p._uU(5),p.ALo(6,"i18n"),p.qZA(),p._uU(7,"\n          "),p.TgZ(8,"button",13),p.NdJ("click",(function(){p.CHM(e);const i=p.oxw(2);return p.KtG(i.editCollection(i.CollectionDialogTabType.Access,!1))})),p._uU(9,"\n            "),p._UZ(10,"i",15),p._uU(11),p.ALo(12,"i18n"),p.qZA(),p._uU(13,"\n        "),p.BQk()}2&e&&(p.xp6(5),p.hij("\n            ",p.lcZ(6,2,"editInfo"),"\n          "),p.xp6(6),p.hij("\n            ",p.lcZ(12,4,"access"),"\n          "))}function dn(e,i){if(1&e){const e=p.EpF();p.ynx(0),p._uU(1,"\n          "),p.TgZ(2,"button",13),p.NdJ("click",(function(){p.CHM(e);const i=p.oxw(2);return p.KtG(i.editCollection(i.CollectionDialogTabType.Info,!0))})),p._uU(3,"\n            "),p._UZ(4,"i",14),p._uU(5),p.ALo(6,"i18n"),p.qZA(),p._uU(7,"\n          "),p.TgZ(8,"button",13),p.NdJ("click",(function(){p.CHM(e);const i=p.oxw(2);return p.KtG(i.editCollection(i.CollectionDialogTabType.Access,!0))})),p._uU(9,"\n            "),p._UZ(10,"i",15),p._uU(11),p.ALo(12,"i18n"),p.qZA(),p._uU(13,"\n        "),p.BQk()}2&e&&(p.xp6(5),p.hij("\n            ",p.lcZ(6,2,"viewInfo"),"\n          "),p.xp6(6),p.hij("\n            ",p.lcZ(12,4,"viewAccess"),"\n          "))}function un(e,i){if(1&e){const e=p.EpF();p.TgZ(0,"button",13),p.NdJ("click",(function(){p.CHM(e);const i=p.oxw(2);return p.KtG(i.deleteCollection())})),p._uU(1,"\n          "),p.TgZ(2,"span",16),p._uU(3,"\n            "),p._UZ(4,"i",17),p._uU(5),p.ALo(6,"i18n"),p.qZA(),p._uU(7,"\n        "),p.qZA()}2&e&&(p.xp6(5),p.hij("\n            ",p.lcZ(6,1,"delete"),"\n          "))}function hn(e,i){if(1&e&&(p.ynx(0),p._uU(1,"\n      "),p._UZ(2,"button",10),p._uU(3,"\n      "),p.TgZ(4,"bit-menu",null,11),p._uU(6,"\n        "),p.YNc(7,an,14,6,"ng-container",3),p._uU(8,"\n        "),p.YNc(9,dn,14,6,"ng-container",3),p._uU(10,"\n        "),p.YNc(11,un,8,3,"button",12),p._uU(12,"\n      "),p.qZA(),p._uU(13,"\n    "),p.BQk()),2&e){const e=p.MAs(5),i=p.oxw();p.xp6(2),p.Q6J("bitMenuTriggerFor",e),p.xp6(5),p.Q6J("ngIf",i.canEditCollection),p.xp6(2),p.Q6J("ngIf",!i.canEditCollection&&i.canViewCollectionInfo),p.xp6(2),p.Q6J("ngIf",i.canDeleteCollection)}}function pn(e,i){1&e&&(p.TgZ(0,"small"),p._uU(1,"\n      "),p._UZ(2,"i",18),p.ALo(3,"i18n"),p._uU(4,"\n      "),p.TgZ(5,"span",19),p._uU(6),p.ALo(7,"i18n"),p.qZA(),p._uU(8,"\n    "),p.qZA()),2&e&&(p.xp6(2),p.s9C("title",p.lcZ(3,2,"loading")),p.xp6(4),p.Oqu(p.lcZ(7,4,"loading")))}function gn(e,i){if(1&e){const e=p.EpF();p.TgZ(0,"bit-search",20),p.NdJ("ngModelChange",(function(i){p.CHM(e);const t=p.oxw();return p.KtG(t.onSearchTextChanged(i))})),p.ALo(1,"i18n"),p.qZA()}if(2&e){const e=p.oxw();p.Q6J("ngModel",e.searchText)("placeholder",p.lcZ(1,2,"searchCollection"))}}function fn(e,i){if(1&e){const e=p.EpF();p.TgZ(0,"div",24),p._uU(1,"\n      "),p.TgZ(2,"button",25),p.ALo(3,"i18n"),p._uU(4),p.ALo(5,"i18n"),p._UZ(6,"i",26),p._uU(7,"\n      "),p.qZA(),p._uU(8,"\n      "),p.TgZ(9,"bit-menu",27,28),p._uU(11,"\n        "),p.TgZ(12,"button",13),p.NdJ("click",(function(){p.CHM(e);const i=p.oxw(2);return p.KtG(i.addCipher())})),p._uU(13,"\n          "),p._UZ(14,"i",29),p._uU(15),p.ALo(16,"i18n"),p.qZA(),p._uU(17,"\n        "),p.TgZ(18,"button",13),p.NdJ("click",(function(){p.CHM(e);const i=p.oxw(2);return p.KtG(i.addCollection())})),p._uU(19,"\n          "),p._UZ(20,"i",30),p._uU(21),p.ALo(22,"i18n"),p.qZA(),p._uU(23,"\n      "),p.qZA(),p._uU(24,"\n    "),p.qZA()}if(2&e){const e=p.MAs(10);p.xp6(2),p.s9C("appA11yTitle",p.lcZ(3,5,"new")),p.Q6J("bitMenuTriggerFor",e),p.xp6(2),p.hij("\n        ",p.lcZ(5,7,"new"),""),p.xp6(11),p.hij("\n          ",p.lcZ(16,9,"item"),"\n        "),p.xp6(6),p.hij("\n          ",p.lcZ(22,11,"collection"),"\n        ")}}function mn(e,i){if(1&e){const e=p.EpF();p.TgZ(0,"button",31),p.NdJ("click",(function(){p.CHM(e);const i=p.oxw(2);return p.KtG(i.addCipher())})),p._uU(1,"\n      "),p._UZ(2,"i",32),p._uU(3),p.ALo(4,"i18n"),p.qZA()}2&e&&(p.xp6(3),p.hij("\n      ",p.lcZ(4,1,"newItem"),"\n    "))}function bn(e,i){if(1&e){const e=p.EpF();p.TgZ(0,"button",31),p.NdJ("click",(function(){p.CHM(e);const i=p.oxw(2);return p.KtG(i.addCollection())})),p._uU(1,"\n      "),p._UZ(2,"i",32),p._uU(3),p.ALo(4,"i18n"),p.qZA()}2&e&&(p.xp6(3),p.hij("\n      ",p.lcZ(4,1,"newCollection"),"\n    "))}function vn(e,i){if(1&e&&(p.TgZ(0,"div",21),p._uU(1,"\n    "),p.YNc(2,fn,25,13,"div",22),p._uU(3,"\n    "),p.YNc(4,mn,5,3,"button",23),p._uU(5,"\n\n    "),p.YNc(6,bn,5,3,"button",23),p._uU(7,"\n  "),p.qZA()),2&e){const e=p.oxw();p.xp6(2),p.Q6J("ngIf",e.canCreateCipher&&e.canCreateCollection),p.xp6(2),p.Q6J("ngIf",e.canCreateCipher&&!e.canCreateCollection),p.xp6(2),p.Q6J("ngIf",e.canCreateCollection&&!e.canCreateCipher)}}class Un{constructor(e,i,t,n,o,l){this.organizationService=e,this.i18nService=i,this.dialogService=t,this.collectionAdminService=n,this.router=o,this.configService=l,this.All=Di.oT,this.Unassigned=Di.JK,this.onAddCipher=new p.vpe,this.onAddCollection=new p.vpe,this.onEditCollection=new p.vpe,this.onDeleteCollection=new p.vpe,this.searchTextChanged=new p.vpe,this.CollectionDialogTabType=ii.sn,this.organizations$=this.organizationService.organizations$,this.flexibleCollectionsV1Enabled=!1,this.restrictProviderAccessFlag=!1}ngOnInit(){return en(this,void 0,void 0,(function*(){this.flexibleCollectionsV1Enabled=yield(0,wi.z)(this.configService.getFeatureFlag$(F.T.FlexibleCollectionsV1)),this.restrictProviderAccessFlag=yield this.configService.getFeatureFlag(F.T.RestrictProviderAccess)}))}get title(){var e,i;const t=(null===(e=this.organization)||void 0===e?void 0:e.flexibleCollections)?this.i18nService.t("collections").toLowerCase():this.i18nService.t("vault").toLowerCase();return null!=this.collection?this.collection.node.name:this.filter.collectionId===Di.JK?this.i18nService.t("unassigned"):`${null===(i=this.organization)||void 0===i?void 0:i.name} ${t}`}get icon(){return void 0!==this.filter.collectionId?"bwi-collection":""}get showBreadcrumbs(){return void 0!==this.filter.collectionId&&this.filter.collectionId!==Di.oT}get collections(){if(null==this.collection)return[];const e=[this.collection];for(;null!=e[e.length-1].parent;)e.push(e[e.length-1].parent);return e.slice(1).reverse().map((e=>e.node))}showFreeOrgUpgradeDialog(){const e={title:this.i18nService.t("upgradeOrganization"),content:this.i18nService.t(this.organization.canEditSubscription?"freeOrgMaxCollectionReachedManageBilling":"freeOrgMaxCollectionReachedNoManageBilling",this.organization.maxCollections),type:"primary"};this.organization.canEditSubscription?e.acceptButtonText=this.i18nService.t("upgrade"):(e.acceptButtonText=this.i18nService.t("ok"),e.cancelButtonText=null);const i=this.dialogService.openSimpleDialogRef(e);(0,wi.z)(i.closed).then((e=>{e&&e&&this.organization.canEditSubscription&&this.router.navigate(["/organizations",this.organization.id,"billing","subscription"],{queryParams:{upgrade:!0}})}))}get canEditCollection(){return void 0!==this.collection&&this.collection.node.canEdit(this.organization,this.flexibleCollectionsV1Enabled)}addCipher(){this.onAddCipher.emit()}addCollection(){return en(this,void 0,void 0,(function*(){if(this.organization.planProductType===Ii.kv.Free){if((yield this.collectionAdminService.getAll(this.organization.id)).length===this.organization.maxCollections)return void this.showFreeOrgUpgradeDialog()}this.onAddCollection.emit()}))}editCollection(e,i){return en(this,void 0,void 0,(function*(){this.onEditCollection.emit({tab:e,readonly:i})}))}get canDeleteCollection(){return void 0!==this.collection&&this.collection.node.canDelete(this.organization,this.flexibleCollectionsV1Enabled)}get canViewCollectionInfo(){return this.collection.node.canViewCollectionInfo(this.organization,this.flexibleCollectionsV1Enabled)}get canCreateCollection(){var e;return null===(e=this.organization)||void 0===e?void 0:e.canCreateNewCollections}get canCreateCipher(){var e;return!(null===(e=this.organization)||void 0===e?void 0:e.isProviderUser)||!this.restrictProviderAccessFlag}deleteCollection(){this.onDeleteCollection.emit()}onSearchTextChanged(e){this.searchText=e,this.searchTextChanged.emit(e)}}Un.ɵfac=function(e){return new(e||Un)(p.Y36(a.Mn),p.Y36(P.D),p.Y36(D.x),p.Y36(L.m),p.Y36(r.F0),p.Y36(Q.E))},Un.ɵcmp=p.Xpm({type:Un,selectors:[["app-org-vault-header"]],inputs:{loading:"loading",filter:"filter",organization:"organization",collection:"collection",searchText:"searchText"},outputs:{onAddCipher:"onAddCipher",onAddCollection:"onAddCollection",onEditCollection:"onEditCollection",onDeleteCollection:"onDeleteCollection",searchTextChanged:"searchTextChanged"},decls:16,vars:7,consts:[[3,"title","icon"],["slot","breadcrumbs",4,"ngIf"],["slot","title-suffix"],[4,"ngIf"],["class","tw-grow",3,"ngModel","placeholder","ngModelChange",4,"ngIf"],["class","tw-shrink-0",4,"ngIf"],["slot","breadcrumbs"],["queryParamsHandling","merge",3,"route","queryParams"],["icon","bwi-collection","queryParamsHandling","merge",3,"route","queryParams",4,"ngFor","ngForOf"],["icon","bwi-collection","queryParamsHandling","merge",3,"route","queryParams"],["bitIconButton","bwi-angle-down","size","small","type","button","aria-haspopup","true",3,"bitMenuTriggerFor"],["editCollectionMenu",""],["type","button","bitMenuItem","",3,"click",4,"ngIf"],["type","button","bitMenuItem","",3,"click"],["aria-hidden","true",1,"bwi","bwi-fw","bwi-pencil-square"],["aria-hidden","true",1,"bwi","bwi-fw","bwi-users"],[1,"tw-text-danger"],["aria-hidden","true",1,"bwi","bwi-fw","bwi-trash"],["aria-hidden","true",1,"bwi","bwi-spinner","bwi-spin","text-muted",3,"title"],[1,"tw-sr-only"],[1,"tw-grow",3,"ngModel","placeholder","ngModelChange"],[1,"tw-shrink-0"],["appListDropdown","",4,"ngIf"],["type","button","bitButton","","buttonType","primary",3,"click",4,"ngIf"],["appListDropdown",""],["bitButton","","buttonType","primary","type","button","id","newItemDropdown",3,"bitMenuTriggerFor","appA11yTitle"],["aria-hidden","true",1,"bwi","bwi-angle-down","tw-ml-2"],["aria-labelledby","newItemDropdown"],["addOptions",""],["aria-hidden","true",1,"bwi","bwi-fw","bwi-globe"],["aria-hidden","true",1,"bwi","bwi-fw","bwi-collection"],["type","button","bitButton","","buttonType","primary",3,"click"],["aria-hidden","true",1,"bwi","bwi-plus","bwi-fw"]],template:function(e,i){1&e&&(p.TgZ(0,"app-header",0),p._uU(1,"\n  "),p.YNc(2,cn,14,9,"bit-breadcrumbs",1),p._uU(3,"\n\n  "),p.ynx(4,2),p._uU(5,"\n    "),p.YNc(6,hn,14,4,"ng-container",3),p._uU(7,"\n    "),p.YNc(8,pn,9,6,"small",3),p._uU(9,"\n  "),p.BQk(),p._uU(10,"\n\n  "),p.YNc(11,gn,2,4,"bit-search",4),p._uU(12,"\n\n  "),p.YNc(13,vn,8,3,"div",5),p._uU(14,"\n"),p.qZA(),p._uU(15,"\n")),2&e&&(p.Q6J("title",i.title)("icon",i.icon),p.xp6(2),p.Q6J("ngIf",i.showBreadcrumbs),p.xp6(4),p.Q6J("ngIf",null!=i.collection&&(i.canEditCollection||i.canDeleteCollection||i.canViewCollectionInfo)),p.xp6(2),p.Q6J("ngIf",i.loading),p.xp6(3),p.Q6J("ngIf",null==i.organization?null:i.organization.isProviderUser),p.xp6(2),p.Q6J("ngIf","trash"!==i.filter.type&&i.filter.collectionId!==i.Unassigned))},dependencies:[B.sg,B.O5,q.JJ,q.On,R.B,W.r,le.Q,ye.M,Te.t,Se.e,Me.k,Wt.n,Xt.L,Ee.g,B.i8,ae.C],encapsulation:2});var An=function(e,i,t,n){return new(t||(t=Promise))((function(o,l){function s(e){try{c(n.next(e))}catch(i){l(i)}}function r(e){try{c(n.throw(e))}catch(i){l(i)}}function c(e){var i;e.done?o(e.value):(i=e.value,i instanceof t?i:new t((function(e){e(i)}))).then(s,r)}c((n=n.apply(e,i||[])).next())}))};const Cn=["attachments"],Zn=["cipherAddEdit"],xn=["collectionsModal"];function wn(e,i){if(1&e){const e=p.EpF();p.TgZ(0,"div",11),p._uU(1,"\n    "),p.TgZ(2,"div",12),p._uU(3,"\n      "),p.TgZ(4,"div",13),p._uU(5,"\n        "),p.TgZ(6,"div",14),p._uU(7,"\n          "),p.TgZ(8,"app-organization-vault-filter",15),p.NdJ("searchTextChanged",(function(i){p.CHM(e);const t=p.oxw();return p.KtG(t.filterSearchText(i))})),p.ALo(9,"async"),p.qZA(),p._uU(10,"\n        "),p.qZA(),p._uU(11,"\n      "),p.qZA(),p._uU(12,"\n    "),p.qZA(),p._uU(13,"\n  "),p.qZA()}if(2&e){const e=p.oxw();p.xp6(8),p.Q6J("organization",e.organization)("activeFilter",e.activeFilter)("searchText",p.lcZ(9,3,e.currentSearchText$))}}function _n(e,i){if(1&e){const e=p.EpF();p.TgZ(0,"bit-toggle-group",16),p.NdJ("selectedChange",(function(i){p.CHM(e);const t=p.oxw();return p.KtG(t.addAccessToggle(i))})),p.ALo(1,"async"),p.ALo(2,"i18n"),p._uU(3,"\n      "),p.TgZ(4,"bit-toggle",17),p._uU(5),p.ALo(6,"i18n"),p.qZA(),p._uU(7,"\n\n      "),p.TgZ(8,"bit-toggle",17),p._uU(9),p.ALo(10,"i18n"),p.qZA(),p._uU(11,"\n    "),p.qZA()}if(2&e){const e=p.oxw();p.Q6J("selected",p.lcZ(1,6,e.addAccessStatus$)),p.uIk("aria-label",p.lcZ(2,8,"addAccessFilter")),p.xp6(4),p.Q6J("value",0),p.xp6(1),p.hij("\n        ",p.lcZ(6,10,"all"),"\n      "),p.xp6(3),p.Q6J("value",1),p.xp6(1),p.hij("\n        ",p.lcZ(10,12,"addAccess"),"\n      ")}}function yn(e,i){if(1&e&&(p.TgZ(0,"app-callout",18),p._uU(1),p.qZA()),2&e){const e=p.oxw();p.xp6(1),p.hij("\n      ",e.trashCleanupWarning,"\n    ")}}function Tn(e,i){if(1&e&&(p.TgZ(0,"div",19),p._uU(1,"\n        "),p._UZ(2,"bit-icon",20),p._uU(3,"\n        "),p.TgZ(4,"p"),p._uU(5),p.ALo(6,"i18n"),p.qZA(),p._uU(7,"\n      "),p.qZA()),2&e){const e=p.oxw(2);p.xp6(2),p.Q6J("icon",e.noItemIcon),p.xp6(3),p.Oqu(p.lcZ(6,2,"noPermissionToViewAllCollectionItems"))}}function Sn(e,i){if(1&e){const e=p.EpF();p.TgZ(0,"button",22),p.NdJ("click",(function(){p.CHM(e);const i=p.oxw(3);return p.KtG(i.addCipher())})),p._uU(1,"\n          "),p._UZ(2,"i",23),p._uU(3),p.ALo(4,"i18n"),p.qZA()}2&e&&(p.xp6(3),p.hij("\n          ",p.lcZ(4,1,"newItem"),"\n        "))}function In(e,i){if(1&e&&(p.TgZ(0,"div",19),p._uU(1,"\n        "),p._UZ(2,"bit-icon",20),p._uU(3,"\n        "),p.TgZ(4,"p"),p._uU(5),p.ALo(6,"i18n"),p.qZA(),p._uU(7,"\n        "),p.YNc(8,Sn,5,3,"button",21),p._uU(9,"\n      "),p.qZA()),2&e){const e=p.oxw(2);p.xp6(2),p.Q6J("icon",e.noItemIcon),p.xp6(3),p.Oqu(p.lcZ(6,3,"noItemsInList")),p.xp6(3),p.Q6J("ngIf","trash"!==e.filter.type&&e.filter.collectionId!==e.Unassigned)}}function qn(e,i){if(1&e&&(p.ynx(0),p._uU(1,"\n      "),p.YNc(2,Tn,8,4,"div",7),p._uU(3,"\n      "),p.YNc(4,In,10,5,"div",7),p.BQk()),2&e){const e=p.oxw();p.xp6(2),p.Q6J("ngIf",e.showMissingCollectionPermissionMessage),p.xp6(2),p.Q6J("ngIf",e.isEmpty&&!e.showMissingCollectionPermissionMessage&&!e.performingInitialLoad)}}function zn(e,i){if(1&e){const e=p.EpF();p.TgZ(0,"button",27),p.NdJ("click",(function(){p.CHM(e);const i=p.oxw(3);return p.KtG(i.addCipher())})),p._uU(1,"\n          "),p._UZ(2,"i",28),p._uU(3),p.ALo(4,"i18n"),p.qZA()}2&e&&(p.xp6(3),p.hij(" ",p.lcZ(4,1,"newItem"),"\n        "))}function En(e,i){if(1&e&&(p.TgZ(0,"bit-no-items"),p._uU(1,"\n        "),p.TgZ(2,"span",25),p._uU(3),p.ALo(4,"i18n"),p.qZA(),p._uU(5,"\n        "),p.YNc(6,zn,5,3,"button",26),p._uU(7,"\n      "),p.qZA()),2&e){const e=p.oxw(2);p.xp6(3),p.Oqu(p.lcZ(4,2,"noItemsInList")),p.xp6(3),p.Q6J("ngIf","trash"!==e.filter.type&&e.filter.collectionId!==e.Unassigned)}}function Mn(e,i){if(1&e){const e=p.EpF();p.TgZ(0,"collection-access-restricted",29),p.NdJ("viewCollectionClicked",(function(i){p.CHM(e);const t=p.oxw(2);return p.KtG(t.editCollection(t.selectedCollection.node,i.tab,i.readonly))})),p._uU(1,"\n      "),p.qZA()}if(2&e){const e=p.oxw(2);p.Q6J("canEditCollection",null==e.selectedCollection||null==e.selectedCollection.node?null:e.selectedCollection.node.canEdit(e.organization,e.flexibleCollectionsV1Enabled))("canViewCollectionInfo",null==e.selectedCollection||null==e.selectedCollection.node?null:e.selectedCollection.node.canViewCollectionInfo(e.organization,e.flexibleCollectionsV1Enabled))}}function Fn(e,i){if(1&e&&(p.ynx(0),p._uU(1,"\n      "),p.YNc(2,En,8,4,"bit-no-items",6),p._uU(3,"\n      "),p.YNc(4,Mn,2,2,"collection-access-restricted",24),p._uU(5,"\n    "),p.BQk()),2&e){const e=p.oxw();p.xp6(2),p.Q6J("ngIf",!e.showCollectionAccessRestricted),p.xp6(2),p.Q6J("ngIf",e.showCollectionAccessRestricted)}}function Jn(e,i){1&e&&(p.TgZ(0,"div",19),p._uU(1,"\n      "),p._UZ(2,"i",30),p.ALo(3,"i18n"),p._uU(4,"\n      "),p.TgZ(5,"span",31),p._uU(6),p.ALo(7,"i18n"),p.qZA(),p._uU(8,"\n    "),p.qZA()),2&e&&(p.xp6(2),p.s9C("title",p.lcZ(3,2,"loading")),p.xp6(4),p.Oqu(p.lcZ(7,4,"loading")))}function Ln(e,i){}function Yn(e,i){}function kn(e,i){}const Nn=function(e){return[e]},Pn=function(){return[]},On="OrgVaultComponent";var $n;!function(e){e[e.All=0]="All",e[e.AddAccess=1]="AddAccess"}($n||($n={}));class Dn{get flexibleCollectionsV1Enabled(){var e;return this._flexibleCollectionsV1FlagEnabled&&(null===(e=this.organization)||void 0===e?void 0:e.flexibleCollections)}get restrictProviderAccessEnabled(){return this._restrictProviderAccessFlagEnabled&&this.flexibleCollectionsV1Enabled}get hideVaultFilters(){var e;return this.restrictProviderAccessEnabled&&(null===(e=this.organization)||void 0===e?void 0:e.isProviderUser)}constructor(e,i,t,n,o,l,s,r,c,a,d,u,h,p,m,b,v,U,A,C,Z,x,w,_,y,T,S,I,q){this.route=e,this.organizationService=i,this.vaultFilterService=t,this.routedVaultFilterBridgeService=n,this.routedVaultFilterService=o,this.router=l,this.changeDetectorRef=s,this.syncService=r,this.i18nService=c,this.modalService=a,this.dialogService=d,this.messagingService=u,this.broadcasterService=h,this.ngZone=p,this.platformUtilsService=m,this.cipherService=b,this.passwordRepromptService=v,this.collectionAdminService=U,this.searchService=A,this.searchPipe=C,this.groupService=Z,this.logService=x,this.eventCollectionService=w,this.totpService=_,this.apiService=y,this.collectionService=T,this.organizationUserService=S,this.configService=I,this.toastService=q,this.Unassigned=Di.JK,this.trashCleanupWarning=null,this.activeFilter=new Li.l,this.showAddAccessToggle=!1,this.noItemIcon=Mi.o,this.performingInitialLoad=!0,this.refreshing=!1,this.processingEvent=!1,this.filter={},this.searchText$=new f.x,this.refresh$=new g.X(null),this.destroy$=new f.x,this.addAccessStatus$=new g.X(0),this.CollectionDialogTabType=ii.sn}ngOnInit(){return An(this,void 0,void 0,(function*(){this.trashCleanupWarning=this.i18nService.t(this.platformUtilsService.isSelfHost()?"trashCleanupWarningSelfHosted":"trashCleanupWarning"),this._flexibleCollectionsV1FlagEnabled=yield this.configService.getFeatureFlag(F.T.FlexibleCollectionsV1),this._restrictProviderAccessFlagEnabled=yield this.configService.getFeatureFlag(F.T.RestrictProviderAccess);const e=this.routedVaultFilterService.filter$,i=e.pipe((0,C.U)((e=>e.organizationId)),(0,_i.h)((e=>void 0!==e)),(0,yi.x)()),t=i.pipe((0,b.w)((e=>this.organizationService.get$(e))),(0,Z.R)(this.destroy$),(0,z.d)({refCount:!1,bufferSize:1})),n=(0,v.a)([t,this.route.queryParams]).pipe((0,w.P)(),(0,b.w)((([e])=>An(this,void 0,void 0,(function*(){this.organization=e,e.canEditAnyCollection(this.flexibleCollectionsV1Enabled)||(yield this.syncService.fullSync(!1))})))),(0,z.d)({refCount:!0,bufferSize:1}));this.broadcasterService.subscribe(On,(e=>{this.ngZone.run((()=>An(this,void 0,void 0,(function*(){if("syncCompleted"===e.command)e.successfully&&(this.refresh(),this.changeDetectorRef.detectChanges())}))))})),this.routedVaultFilterBridgeService.activeFilter$.pipe((0,Z.R)(this.destroy$)).subscribe((e=>{this.activeFilter=e,this.activeFilter.collectionId||(this.showAddAccessToggle=!1)})),this.searchText$.pipe((0,Ti.b)(200),(0,Z.R)(this.destroy$)).subscribe((e=>this.router.navigate([],{queryParams:{search:y.c.isNullOrEmpty(e)?null:e},queryParamsHandling:"merge",replaceUrl:!0}))),this.currentSearchText$=this.route.queryParams.pipe((0,C.U)((e=>e.search))),this.allCollectionsWithoutUnassigned$=(0,v.a)([i.pipe((0,b.w)((e=>this.collectionAdminService.getAll(e)))),(0,xi.P)((()=>this.collectionService.getAllDecrypted()))]).pipe((0,C.U)((([e,i])=>{const t=Object.fromEntries(i.map((e=>[e.id,e])));return e.map((e=>{const i=e.id,n=t[i];return n&&(e.manage=n.manage,e.readOnly=n.readOnly,e.hidePasswords=n.hidePasswords),e}))})),(0,z.d)({refCount:!0,bufferSize:1})),this.editableCollections$=this.allCollectionsWithoutUnassigned$.pipe((0,C.U)((e=>this.organization.isProviderUser&&this.restrictProviderAccessEnabled?[]:this.organization.canEditAllCiphers(this.flexibleCollectionsV1Enabled,this.restrictProviderAccessEnabled)?e:e.filter((e=>e.assigned&&!e.readOnly)))),(0,z.d)({refCount:!0,bufferSize:1}));const o=(0,v.a)([i,this.allCollectionsWithoutUnassigned$]).pipe((0,C.U)((([e,i])=>{const t=new Yi.e;return t.name=this.i18nService.t("unassigned"),t.id=Di.JK,t.organizationId=e,i.concat(t)}))),l=i.pipe((0,b.w)((e=>this.groupService.getAll(e))),(0,z.d)({refCount:!0,bufferSize:1})),s=t.pipe((0,A.b)((e=>An(this,void 0,void 0,(function*(){let i;return this.showAddAccessToggle&&!e||this.addAccessToggle(0),e.isProviderUser&&this.restrictProviderAccessEnabled?[]:(i=this.flexibleCollectionsV1Enabled?e.canEditAllCiphers(this.flexibleCollectionsV1Enabled,this.restrictProviderAccessEnabled)?yield this.cipherService.getAllFromApiForOrganization(e.id):yield this.cipherService.getManyFromApiForOrganization(e.id):e.canEditAllCiphers(this.flexibleCollectionsV1Enabled,this.restrictProviderAccessEnabled)?yield this.cipherService.getAllFromApiForOrganization(e.id):(yield this.cipherService.getAllDecrypted()).filter((i=>i.organizationId===e.id)),yield this.searchService.indexCiphers(i,e.id),i)}))))),r=s.pipe((0,C.U)((e=>Object.fromEntries(e.map((e=>[e.id,e]))))),(0,z.d)({refCount:!0,bufferSize:1})),c=o.pipe((0,C.U)((e=>(0,Gi.o)(e))),(0,z.d)({refCount:!0,bufferSize:1}));this.orgRevokedUsers=(yield this.organizationUserService.getAllUsers(yield(0,wi.z)(i))).data.filter((e=>-1===e.status));const a=(0,v.a)([c,e,this.currentSearchText$,this.addAccessStatus$]).pipe((0,_i.h)((([e,i])=>null!=e&&null!=i)),(0,A.b)((([e,i,t,n])=>An(this,void 0,void 0,(function*(){var o;if(i.collectionId===Di.JK||void 0===i.collectionId&&void 0!==i.type)return[];this.showAddAccessToggle=!1;let l=[];if(void 0===i.collectionId||i.collectionId===Di.oT)l=e.map((e=>e.node));else{const t=Ei.L.getTreeNodeObjectFromList(e,i.collectionId);l=null!==(o=null==t?void 0:t.children.map((e=>e.node)))&&void 0!==o?o:[]}return(yield this.searchService.isSearchable(t))&&(l=this.searchPipe.transform(l,t,(e=>e.name),(e=>e.id))),this.showAddAccessToggle=this.flexibleCollectionsV1Enabled&&!this.organization.allowAdminAccessToAllCollectionItems&&this.organization.canEditUnmanagedCollections()&&l.some((e=>e.unmanaged)),1===n&&this.showAddAccessToggle&&(l=l.filter((e=>e.unmanaged))),l})))),(0,Z.R)(this.destroy$),(0,z.d)({refCount:!0,bufferSize:1})),d=(0,v.a)([c,e]).pipe((0,_i.h)((([e,i])=>null!=e&&null!=i)),(0,C.U)((([e,i])=>{if(void 0!==i.collectionId&&i.collectionId!==Di.oT&&i.collectionId!==Di.JK)return Ei.L.getTreeNodeObjectFromList(e,i.collectionId)})),(0,z.d)({refCount:!0,bufferSize:1})),u=(0,v.a)([e,d,t]).pipe((0,C.U)((([e,i,t])=>t.isProviderUser&&this.restrictProviderAccessEnabled?null!=i||e.collectionId===Di.JK:e.collectionId===Di.JK&&!t.canEditUnassignedCiphers(this.restrictProviderAccessEnabled)||!t.canEditAllCiphers(this.flexibleCollectionsV1Enabled,this.restrictProviderAccessEnabled)&&null!=i&&!i.node.assigned)),(0,z.d)({refCount:!0,bufferSize:1})),h=(0,v.a)([s,e,this.currentSearchText$,u]).pipe((0,_i.h)((([e,i])=>null!=e&&null!=i)),(0,A.b)((([e,i,t,n])=>An(this,void 0,void 0,(function*(){if(void 0===i.collectionId&&void 0===i.type)return[];if(this.flexibleCollectionsV1Enabled&&n)return[];const o=(0,$i.E)(i);return(yield this.searchService.isSearchable(t))?yield this.searchService.searchCiphers(t,[o],e):e.filter(o)})))),(0,z.d)({refCount:!0,bufferSize:1})),p=(0,v.a)([e,d,t]).pipe((0,C.U)((([e,i,t])=>e.collectionId===Di.JK&&!t.canEditUnassignedCiphers(this.restrictProviderAccessEnabled)||null!=i&&!i.node.assigned&&!t.canEditAnyCollection(this.flexibleCollectionsV1Enabled))),(0,z.d)({refCount:!0,bufferSize:1}));n.pipe((0,b.w)((()=>(0,v.a)([this.route.queryParams,t]))),(0,b.w)((([e,i])=>An(this,void 0,void 0,(function*(){const t=Gn(e);if(!t)return;let n;n=this.flexibleCollectionsV1Enabled?i.canEditAllCiphers(!0,this.restrictProviderAccessEnabled)||null!=(yield(0,wi.z)(r))[t]:i.canEditAnyCollection(this.flexibleCollectionsV1Enabled)||null!=(yield this.cipherService.get(t)),n?yield this.editCipherId(t):(this.platformUtilsService.showToast("error",null,this.i18nService.t("unknownCipher")),yield this.router.navigate([],{queryParams:{cipherId:null,itemId:null},queryParamsHandling:"merge"}))})))),(0,Z.R)(this.destroy$)).subscribe(),n.pipe((0,b.w)((()=>(0,v.a)([this.route.queryParams,t,s]))),(0,b.w)((([e,i,t])=>An(this,void 0,void 0,(function*(){const n=e.viewEvents;if(!n)return;const o=t.find((e=>e.id===n));i.useEvents&&null!=o?this.viewEvents(o):(this.platformUtilsService.showToast("error",null,this.i18nService.t("unknownCipher")),this.router.navigate([],{queryParams:{viewEvents:null},queryParamsHandling:"merge"}))})))),(0,Z.R)(this.destroy$)).subscribe(),n.pipe((0,b.w)((()=>this.refresh$)),(0,m.b)((()=>this.refreshing=!0)),(0,b.w)((()=>(0,v.a)([t,e,o,l,h,a,d,p,u]))),(0,Z.R)(this.destroy$)).subscribe((([e,i,t,n,o,l,s,r,c])=>{this.organization=e,this.filter=i,this.allCollections=t,this.allGroups=n,this.ciphers=o,this.collections=l,this.selectedCollection=s,this.showMissingCollectionPermissionMessage=r,this.showCollectionAccessRestricted=c,this.isEmpty=0===(null==l?void 0:l.length)&&0===(null==o?void 0:o.length),this.vaultFilterService.reloadCollections(t),this.refreshing=!1,this.performingInitialLoad=!1}))}))}addAccessToggle(e){this.addAccessStatus$.next(e)}get loading(){return this.refreshing||this.processingEvent}ngOnDestroy(){this.broadcasterService.unsubscribe(On),this.destroy$.next(),this.destroy$.complete()}onVaultItemsEvent(e){return An(this,void 0,void 0,(function*(){this.processingEvent=!0;try{if("viewAttachments"===e.type)yield this.editCipherAttachments(e.item);else if("viewCipherCollections"===e.type)yield this.editCipherCollections(e.item);else if("clone"===e.type)yield this.cloneCipher(e.item);else if("restore"===e.type)1===e.items.length?yield this.restore(e.items[0]):yield this.bulkRestore(e.items);else if("delete"===e.type){const i=e.items.filter((e=>void 0===e.collection)).map((e=>e.cipher)),t=e.items.filter((e=>void 0===e.cipher)).map((e=>e.collection));1===i.length&&0===t.length?yield this.deleteCipher(i[0]):0===i.length&&1===t.length?yield this.deleteCollection(t[0]):yield this.bulkDelete(i,t,this.organization)}else"copyField"===e.type?yield this.copy(e.item,e.field):"editCollection"===e.type?yield this.editCollection(e.item,ii.sn.Info,e.readonly):"viewCollectionAccess"===e.type?yield this.editCollection(e.item,ii.sn.Access,e.readonly):"bulkEditCollectionAccess"===e.type?yield this.bulkEditCollectionAccess(e.items,this.organization):"assignToCollections"===e.type?yield this.bulkAssignToCollections(e.items):"viewEvents"===e.type&&(yield this.viewEvents(e.item))}finally{this.processingEvent=!1}}))}filterSearchText(e){this.searchText$.next(e)}editCipherAttachments(e){return An(this,void 0,void 0,(function*(){if(0!==(null==e?void 0:e.reprompt)&&!(yield this.passwordRepromptService.showPasswordPrompt()))return void this.go({cipherId:null,itemId:null});if(null==this.organization.maxStorageGb||0===this.organization.maxStorageGb)return void this.messagingService.send("upgradeOrganization",{organizationId:e.organizationId});let i=!1;const[t]=yield this.modalService.openViewRef(ut,this.attachmentsModalRef,(t=>{t.organization=this.organization,t.cipherId=e.id,t.onUploadedAttachment.pipe((0,Z.R)(this.destroy$)).subscribe((()=>i=!0)),t.onDeletedAttachment.pipe((0,Z.R)(this.destroy$)).subscribe((()=>i=!0))}));t.onClosed.pipe((0,Z.R)(this.destroy$)).subscribe((()=>{i&&this.refresh(),i=!1}))}))}editCipherCollections(e){return An(this,void 0,void 0,(function*(){let i=[];i=this.flexibleCollectionsV1Enabled?yield(0,wi.z)(this.allCollectionsWithoutUnassigned$.pipe((0,C.U)((e=>e.sort(((e,i)=>e.canEditItems(this.organization,!0,this.restrictProviderAccessEnabled)&&!i.canEditItems(this.organization,!0,this.restrictProviderAccessEnabled)?-1:!e.canEditItems(this.organization,!0,this.restrictProviderAccessEnabled)&&i.canEditItems(this.organization,!0,this.restrictProviderAccessEnabled)?1:e.name.localeCompare(i.name))))))):yield(0,wi.z)(this.allCollectionsWithoutUnassigned$);const t=(n=this.dialogService,o={data:{collectionIds:e.collectionIds,collections:i,organization:this.organization,cipherId:e.id}},n.open(Ft,o));var n,o;(yield(0,x.n)(t.closed))==Ni.Zl.Saved&&this.refresh()}))}addCipher(){return An(this,void 0,void 0,(function*(){let e=[];e=this.flexibleCollectionsV1Enabled?yield(0,wi.z)(this.editableCollections$):(yield(0,wi.z)(this.vaultFilterService.filteredCollections$)).filter((e=>!e.readOnly&&e.id!=Di.JK)),yield this.editCipher(null,(i=>{i.type=this.activeFilter.cipherType,i.collections=e,this.activeFilter.collectionId&&(i.collectionIds=[this.activeFilter.collectionId])}))}))}navigateToCipher(e){return An(this,void 0,void 0,(function*(){this.go({itemId:null==e?void 0:e.id})}))}editCipher(e,i){return An(this,void 0,void 0,(function*(){return this.editCipherId(null==e?void 0:e.id,i)}))}editCipherId(e,i){return An(this,void 0,void 0,(function*(){const t=yield this.cipherService.get(e);if(t&&0!==t.reprompt&&!(yield this.passwordRepromptService.showPasswordPrompt()))return void this.go({cipherId:null,itemId:null});const n=i=>{i.organization=this.organization,i.organizationId=this.organization.id,i.cipherId=e,i.onSavedCipher.pipe((0,Z.R)(this.destroy$)).subscribe((()=>{o.close(),this.refresh()})),i.onDeletedCipher.pipe((0,Z.R)(this.destroy$)).subscribe((()=>{o.close(),this.refresh()})),i.onRestoredCipher.pipe((0,Z.R)(this.destroy$)).subscribe((()=>{o.close(),this.refresh()}))},[o,l]=yield this.modalService.openViewRef(Qi.Z,this.cipherAddEditModalRef,null==i?n:e=>{n(e),i(e)});return o.onClosedPromise().then((()=>{this.go({cipherId:null,itemId:null})})),l}))}cloneCipher(e){var i;return An(this,void 0,void 0,(function*(){if(null===(i=e.login)||void 0===i?void 0:i.hasFido2Credentials){if(!(yield this.dialogService.openSimpleDialog({title:{key:"passkeyNotCopied"},content:{key:"passkeyNotCopiedAlert"},type:"info"})))return!1}let t=[];t=this.flexibleCollectionsV1Enabled?yield(0,wi.z)(this.editableCollections$):(yield(0,wi.z)(this.vaultFilterService.filteredCollections$)).filter((e=>!e.readOnly&&e.id!=Di.JK)),yield this.editCipher(e,(i=>{i.cloneMode=!0,i.collections=t,i.collectionIds=e.collectionIds}))}))}restore(e){var i;return An(this,void 0,void 0,(function*(){if(e.isDeleted)if(this.organization.permissions.editAnyCollection||!this.flexibleCollectionsV1Enabled||e.edit||this.organization.allowAdminAccessToAllCollectionItems){if(yield this.repromptCipher([e]))try{const t=(null===(i=this.organization)||void 0===i?void 0:i.canEditAnyCollection(this.flexibleCollectionsV1Enabled))||e.isUnassigned;yield this.cipherService.restoreWithServer(e.id,t),this.platformUtilsService.showToast("success",null,this.i18nService.t("restoredItem")),this.refresh()}catch(t){this.logService.error(t)}}else this.showMissingPermissionsError()}))}bulkRestore(e){return An(this,void 0,void 0,(function*(){if(!this.organization.permissions.editAnyCollection&&this.flexibleCollectionsV1Enabled&&e.some((e=>!e.edit&&!this.organization.allowAdminAccessToAllCollectionItems)))return void this.showMissingPermissionsError();if(!(yield this.repromptCipher(e)))return;const i=[],t=[];this.organization.canEditAllCiphers(this.flexibleCollectionsV1Enabled,this.restrictProviderAccessEnabled)?e.map((e=>{i.push(e.id)})):e.map((e=>{0===e.collectionIds.length?t.push(e.id):e.edit&&i.push(e.id)})),0!==t.length||0!==i.length?((t.length>0||i.length>0)&&(yield this.cipherService.restoreManyWithServer([...t,...i],this.organization.id)),this.platformUtilsService.showToast("success",null,this.i18nService.t("restoredItems")),this.refresh()):this.platformUtilsService.showToast("error",this.i18nService.t("errorOccurred"),this.i18nService.t("nothingSelected"))}))}deleteCipher(e){return An(this,void 0,void 0,(function*(){if(this.flexibleCollectionsV1Enabled&&!e.edit&&!this.organization.canEditAllCiphers(this.flexibleCollectionsV1Enabled,this.restrictProviderAccessEnabled))return void this.showMissingPermissionsError();if(!(yield this.repromptCipher([e])))return;const i=e.isDeleted;if(!(yield this.dialogService.openSimpleDialog({title:{key:i?"permanentlyDeleteItem":"deleteItem"},content:{key:i?"permanentlyDeleteItemConfirmation":"deleteItemConfirmation"},type:"warning"})))return!1;try{yield this.deleteCipherWithServer(e.id,i,e.isUnassigned),this.platformUtilsService.showToast("success",null,this.i18nService.t(i?"permanentlyDeletedItem":"deletedItem")),this.refresh()}catch(t){this.logService.error(t)}}))}deleteCollection(e){var i,t,n,o;return An(this,void 0,void 0,(function*(){if(!e.canDelete(this.organization,this.flexibleCollectionsV1Enabled))return void this.showMissingPermissionsError();if(yield this.dialogService.openSimpleDialog({title:e.name,content:{key:"deleteCollectionConfirmation"},type:"warning"}))try{yield this.apiService.deleteCollection(null===(i=this.organization)||void 0===i?void 0:i.id,e.id),this.platformUtilsService.showToast("success",null,this.i18nService.t("deletedCollectionId",e.name)),(null===(t=this.selectedCollection)||void 0===t?void 0:t.node.id)===e.id&&this.router.navigate([],{queryParams:{collectionId:null!==(o=null===(n=this.selectedCollection.parent)||void 0===n?void 0:n.node.id)&&void 0!==o?o:null},queryParamsHandling:"merge",replaceUrl:!0}),this.refresh()}catch(l){this.logService.error(l)}}))}bulkDelete(e,i,t){return An(this,void 0,void 0,(function*(){if(!(yield this.repromptCipher(e)))return;const n=[],o=[];if(e.map((e=>{e.isUnassigned?n.push(e.id):o.push(e.id)})),0===e.length&&0===i.length)return void this.platformUtilsService.showToast("error",null,this.i18nService.t("nothingSelected"));const l=null==i||i.every((e=>e.canDelete(t,this.flexibleCollectionsV1Enabled))),s=null==e||e.every((e=>e.edit))||this.organization.canEditAllCiphers(this.flexibleCollectionsV1Enabled,this.restrictProviderAccessEnabled);if(this.flexibleCollectionsV1Enabled&&(!s||!l))return void this.showMissingPermissionsError();const r=(0,ki.E)(this.dialogService,{data:{permanent:"trash"===this.filter.type,cipherIds:o,collections:i,organization:t,unassignedCiphers:n}});(yield(0,x.n)(r.closed))===ki.Jg.Deleted&&this.refresh()}))}copy(e,i){return An(this,void 0,void 0,(function*(){let t,n,o;if("username"===i)t="Username",n=e.login.username,o="username";else if("password"===i)t="Password",n=e.login.password,o="password";else{if("totp"!==i)return void this.platformUtilsService.showToast("info",null,this.i18nService.t("unexpectedError"));t="TOTP",n=yield this.totpService.getCode(e.login.totp),o="verificationCodeTotp"}this.passwordRepromptService.protectedFields().includes(t)&&!(yield this.repromptCipher([e]))||e.viewPassword&&(this.platformUtilsService.copyToClipboard(n,{window:window}),this.platformUtilsService.showToast("info",null,this.i18nService.t("valueCopied",this.i18nService.t(o))),"password"===i?this.eventCollectionService.collect(Ii.tw.Cipher_ClientCopiedPassword,e.id):"totp"===i&&this.eventCollectionService.collect(Ii.tw.Cipher_ClientCopiedHiddenField,e.id))}))}addCollection(){var e,i;return An(this,void 0,void 0,(function*(){const t=(0,ii.ku)(this.dialogService,{data:{organizationId:null===(e=this.organization)||void 0===e?void 0:e.id,parentCollectionId:null===(i=this.selectedCollection)||void 0===i?void 0:i.node.id,limitNestedCollections:!this.organization.canEditAnyCollection(this.flexibleCollectionsV1Enabled)}}),n=yield(0,x.n)(t.closed);n.action!==ii.a8.Saved&&n.action!==ii.a8.Deleted||this.refresh()}))}editCollection(e,i,t){var n,o,l,s;return An(this,void 0,void 0,(function*(){const r=(0,ii.ku)(this.dialogService,{data:{collectionId:null==e?void 0:e.id,organizationId:null===(n=this.organization)||void 0===n?void 0:n.id,initialTab:i,readonly:t,isAddAccessCollection:e.unmanaged,limitNestedCollections:!this.organization.canEditAnyCollection(this.flexibleCollectionsV1Enabled)}}),c=yield(0,x.n)(r.closed);c.action!==ii.a8.Saved&&c.action!==ii.a8.Deleted||(this.refresh(),c.action===ii.a8.Deleted&&(null===(o=this.selectedCollection)||void 0===o?void 0:o.node.id)===(null==e?void 0:e.id)&&this.router.navigate([],{queryParams:{collectionId:null!==(s=null===(l=this.selectedCollection.parent)||void 0===l?void 0:l.node.id)&&void 0!==s?s:null},queryParamsHandling:"merge",replaceUrl:!0}))}))}bulkEditCollectionAccess(e,i){var t;return An(this,void 0,void 0,(function*(){if(0===e.length)return void this.toastService.showToast({variant:"error",title:null,message:this.i18nService.t("noCollectionsSelected")});if(this.flexibleCollectionsV1Enabled&&e.some((e=>!e.canEdit(i,this.flexibleCollectionsV1Enabled))))return void this.showMissingPermissionsError();const n=wt.open(this.dialogService,{data:{collections:e,organizationId:null===(t=this.organization)||void 0===t?void 0:t.id}});(yield(0,x.n)(n.closed))===At.Saved&&this.refresh()}))}bulkAssignToCollections(e){var i,t,n;return An(this,void 0,void 0,(function*(){if(0===e.length)return void this.platformUtilsService.showToast("error",null,this.i18nService.t("nothingSelected"));let o;o=this.flexibleCollectionsV1Enabled?yield(0,wi.z)(this.editableCollections$):(yield(0,wi.z)(this.vaultFilterService.filteredCollections$)).filter((e=>e.id!=Di.JK));const l=Ut.open(this.dialogService,{data:{ciphers:e,organizationId:null===(i=this.organization)||void 0===i?void 0:i.id,availableCollections:o,activeCollection:null===(n=null===(t=this.activeFilter)||void 0===t?void 0:t.selectedCollectionNode)||void 0===n?void 0:n.node}});(yield(0,x.n)(l.closed))===ht.Saved&&this.refresh()}))}viewEvents(e){return An(this,void 0,void 0,(function*(){yield(0,Ji.Z)(this.dialogService,{data:{name:e.name,organizationId:this.organization.id,entityId:e.id,showUser:!0,entity:"cipher"}})}))}deleteCipherWithServer(e,i,t){var n;const o=(null===(n=this.organization)||void 0===n?void 0:n.canEditAllCiphers(this.flexibleCollectionsV1Enabled,this.restrictProviderAccessEnabled))||t;return i?this.cipherService.deleteWithServer(e,o):this.cipherService.softDeleteWithServer(e,o)}repromptCipher(e){return An(this,void 0,void 0,(function*(){const i=!e.find((e=>e.reprompt!==zi.N.None));return i||(yield this.passwordRepromptService.showPasswordPrompt())}))}refresh(){this.refresh$.next()}go(e=null){null==e&&(e={type:this.activeFilter.cipherType,collectionId:this.activeFilter.collectionId,deleted:this.activeFilter.isDeleted||null}),this.router.navigate([],{relativeTo:this.route,queryParams:e,queryParamsHandling:"merge",replaceUrl:!0})}showMissingPermissionsError(){this.toastService.showToast({variant:"error",title:null,message:this.i18nService.t("missingPermissions")})}}Dn.ɵfac=function(e){return new(e||Dn)(p.Y36(r.gz),p.Y36(a.Mn),p.Y36(hi.n),p.Y36(Pi.b),p.Y36(Oi.q),p.Y36(r.F0),p.Y36(p.sBO),p.Y36(Jt._),p.Y36(P.D),p.Y36(Si.Z),p.Y36(D.x),p.Y36(qi.o),p.Y36(Yt.A),p.Y36(p.R0b),p.Y36(O.P),p.Y36(vi.u),p.Y36(Fi.C),p.Y36(L.m),p.Y36(Ae.o),p.Y36(_.C),p.Y36(s.lT),p.Y36($.$),p.Y36(kt.j),p.Y36(Nt.w),p.Y36(k.s),p.Y36(Ce.a),p.Y36(N.t),p.Y36(Q.E),p.Y36(Lt.k))},Dn.ɵcmp=p.Xpm({type:Dn,selectors:[["app-org-vault"]],viewQuery:function(e,i){if(1&e&&(p.Gf(Cn,7,p.s_b),p.Gf(Zn,7,p.s_b),p.Gf(xn,7,p.s_b)),2&e){let e;p.iGM(e=p.CRH())&&(i.attachmentsModalRef=e.first),p.iGM(e=p.CRH())&&(i.cipherAddEditModalRef=e.first),p.iGM(e=p.CRH())&&(i.collectionsModalRef=e.first)}},features:[p._Bn([Oi.q,Pi.b])],decls:34,vars:42,consts:[[3,"filter","loading","organization","collection","searchText","onAddCipher","onAddCollection","onEditCollection","onDeleteCollection","searchTextChanged"],[1,"row"],["class","col-3",4,"ngIf"],[3,"selected","selectedChange",4,"ngIf"],["type","warning","icon","bwi bwi-exclamation-triangle",4,"ngIf"],[3,"ciphers","collections","allCollections","allOrganizations","allGroups","disabled","showOwner","showPermissionsColumn","showCollections","showGroups","showPremiumFeatures","showBulkMove","showBulkTrashOptions","useEvents","showAdminActions","showBulkEditCollectionAccess","showBulkAddToCollections","viewingOrgVault","flexibleCollectionsV1Enabled","addAccessStatus","addAccessToggle","restrictProviderAccess","onEvent"],[4,"ngIf"],["class","tw-mt-6 tw-flex tw-h-full tw-flex-col tw-items-center tw-justify-start",4,"ngIf"],["attachments",""],["cipherAddEdit",""],["collectionsModal",""],[1,"col-3"],[1,"groupings"],[1,"content"],[1,"inner-content"],[3,"organization","activeFilter","searchText","searchTextChanged"],[3,"selected","selectedChange"],[3,"value"],["type","warning","icon","bwi bwi-exclamation-triangle"],[1,"tw-mt-6","tw-flex","tw-h-full","tw-flex-col","tw-items-center","tw-justify-start"],["aria-hidden","true",3,"icon"],["type","button","buttonType","primary","bitButton","",3,"click",4,"ngIf"],["type","button","buttonType","primary","bitButton","",3,"click"],["aria-hidden","true",1,"bwi","bwi-plus","bwi-fw"],[3,"canEditCollection","canViewCollectionInfo","viewCollectionClicked",4,"ngIf"],["slot","title",1,"tw-mt-4","tw-block"],["slot","button","bitButton","","buttonType","primary","type","button",3,"click",4,"ngIf"],["slot","button","bitButton","","buttonType","primary","type","button",3,"click"],["aria-hidden","true",1,"bwi","bwi-plus"],[3,"canEditCollection","canViewCollectionInfo","viewCollectionClicked"],["aria-hidden","true",1,"bwi","bwi-spinner","bwi-spin","text-muted",3,"title"],[1,"sr-only"]],template:function(e,i){1&e&&(p.TgZ(0,"app-org-vault-header",0),p.NdJ("onAddCipher",(function(){return i.addCipher()}))("onAddCollection",(function(){return i.addCollection()}))("onEditCollection",(function(e){return i.editCollection(i.selectedCollection.node,e.tab,e.readonly)}))("onDeleteCollection",(function(){return i.deleteCollection(i.selectedCollection.node)}))("searchTextChanged",(function(e){return i.filterSearchText(e)})),p.ALo(1,"async"),p.qZA(),p._uU(2,"\n\n"),p.TgZ(3,"div",1),p._uU(4,"\n  "),p.YNc(5,wn,14,5,"div",2),p._uU(6,"\n  "),p.TgZ(7,"div"),p._uU(8,"\n    "),p.YNc(9,_n,12,14,"bit-toggle-group",3),p._uU(10,"\n    "),p.YNc(11,yn,2,1,"app-callout",4),p._uU(12,"\n    "),p.TgZ(13,"app-vault-items",5),p.NdJ("onEvent",(function(e){return i.onVaultItemsEvent(e)})),p.ALo(14,"async"),p._uU(15,"\n    "),p.qZA(),p._uU(16,"\n    "),p.YNc(17,qn,5,2,"ng-container",6),p._uU(18,"\n    "),p.YNc(19,Fn,6,2,"ng-container",6),p._uU(20,"\n    "),p.YNc(21,Jn,9,6,"div",7),p._uU(22,"\n  "),p.qZA(),p._uU(23,"\n"),p.qZA(),p._uU(24,"\n"),p.YNc(25,Ln,0,0,"ng-template",null,8,p.W1O),p._uU(27,"\n"),p.YNc(28,Yn,0,0,"ng-template",null,9,p.W1O),p._uU(30,"\n"),p.YNc(31,kn,0,0,"ng-template",null,10,p.W1O),p._uU(33,"\n")),2&e&&(p.Q6J("filter",i.filter)("loading",i.refreshing)("organization",i.organization)("collection",i.selectedCollection)("searchText",p.lcZ(1,35,i.currentSearchText$)),p.xp6(5),p.Q6J("ngIf",!i.hideVaultFilters),p.xp6(2),p.Tol(i.hideVaultFilters?"col-12":"col-9"),p.xp6(2),p.Q6J("ngIf",i.showAddAccessToggle&&i.activeFilter.selectedCollectionNode),p.xp6(2),p.Q6J("ngIf",i.activeFilter.isDeleted),p.xp6(2),p.Q6J("ciphers",i.ciphers)("collections",i.collections)("allCollections",i.allCollections)("allOrganizations",i.organization?p.VKq(39,Nn,i.organization):p.DdM(41,Pn))("allGroups",i.allGroups)("disabled",i.loading)("showOwner",!1)("showPermissionsColumn",!0)("showCollections",void 0!==i.filter.type)("showGroups",(null==i.organization?null:i.organization.useGroups)&&(void 0===i.filter.type&&void 0===i.filter.collectionId||void 0!==i.filter.collectionId))("showPremiumFeatures",null==i.organization?null:i.organization.useTotp)("showBulkMove",!1)("showBulkTrashOptions","trash"===i.filter.type)("useEvents",null==i.organization?null:i.organization.canAccessEventLogs)("showAdminActions",!0)("showBulkEditCollectionAccess",null==i.organization?null:i.organization.flexibleCollections)("showBulkAddToCollections",null==i.organization?null:i.organization.flexibleCollections)("viewingOrgVault",!0)("flexibleCollectionsV1Enabled",i.flexibleCollectionsV1Enabled)("addAccessStatus",p.lcZ(14,37,i.addAccessStatus$))("addAccessToggle",i.showAddAccessToggle)("restrictProviderAccess",i.restrictProviderAccessEnabled),p.xp6(4),p.Q6J("ngIf",!i.flexibleCollectionsV1Enabled),p.xp6(2),p.Q6J("ngIf",i.flexibleCollectionsV1Enabled&&!i.performingInitialLoad&&i.isEmpty),p.xp6(2),p.Q6J("ngIf",i.performingInitialLoad))},dependencies:[Vt,B.O5,Bt.O,W.r,Rt.G,jt.f,Ht.n,Kt.JS,ai,li.M,Un,B.Ov,ae.C],encapsulation:2});const Gn=e=>e.itemId||e.cipherId,Qn=[{path:"",component:Dn,canActivate:[d.G],data:{titleId:"vaults",organizationPermissions:a.Po}}];class Vn{}Vn.ɵfac=function(e){return new(e||Vn)},Vn.ɵmod=p.oAB({type:Vn}),Vn.ɵinj=p.cJS({imports:[r.Bz.forChild(Qn),r.Bz]});class Bn{}Bn.ɵfac=function(e){return new(e||Bn)},Bn.ɵmod=p.oAB({type:Bn}),Bn.ɵinj=p.cJS({imports:[Vn,Zi,We.m,Ke.f,ui.x,di.e,Xe.D,ei.D,Re.J,ti.z,ii.WK,ai,je.t,He.t]});const Rn=[{path:":organizationId",component:h.f,canActivate:[(0,Be.k)(),c.a1,d.G],data:{organizationPermissions:a.gW},children:[{path:"",pathMatch:"full",canActivate:[u.S],data:{autoRedirectCallback:function(e){if((0,a.Po)(e))return"vault";if((0,a.tt)(e))return"members";if((0,a.WW)(e))return"groups";if((0,a.$G)(e))return"reporting";if((0,a.DL)(e))return"settings";return}},children:[]},{path:"vault",loadChildren:()=>Bn},{path:"settings",loadChildren:()=>t.e(554).then(t.bind(t,86554)).then((e=>e.OrganizationSettingsModule))},{path:"members",loadChildren:()=>Promise.all([t.e(97),t.e(416)]).then(t.bind(t,12416)).then((e=>e.MembersModule))},{path:"groups",component:Ve,canActivate:[d.G],data:{titleId:"groups",organizationPermissions:a.WW}},{path:"reporting",loadChildren:()=>t.e(979).then(t.bind(t,10979)).then((e=>e.OrganizationReportingModule))}]}];class jn{}jn.ɵfac=function(e){return new(e||jn)},jn.ɵmod=p.oAB({type:jn}),jn.ɵinj=p.cJS({imports:[r.Bz.forChild(Rn),r.Bz]});var Hn=t(64984);class Kn{}Kn.ɵfac=function(e){return new(e||Kn)},Kn.ɵmod=p.oAB({type:Kn}),Kn.ɵinj=p.cJS({imports:[Hn.P,Y.k4,s.WO,jn,l.f]})},14309:function(e,i,t){t.d(i,{E2:function(){return l.E2},R9:function(){return n.R},XL:function(){return l.XL},d4:function(){return l.d4},hs:function(){return l.hs},k4:function(){return o.k},zD:function(){return l.zD}});var n=t(36689),o=t(1176),l=t(34632)},64984:function(e,i,t){t.d(i,{P:function(){return r}});var n=t(27420),o=t(85921),l=t(1176),s=t(85762);class r{}r.ɵfac=function(e){return new(e||r)},r.ɵmod=s.oAB({type:r}),r.ɵinj=s.cJS({imports:[o.m,l.k,n.t,o.m,l.k,n.t]})},53883:function(e,i,t){t.d(i,{Y:function(){return n}});class n{constructor(e){this.message=e.message,this.humanReadableMessage=e.humanReadableMessage,this.appIcon=e.appIcon,this.appName=e.appName,this.userId=e.userId,this.userName=e.userName,this.userEmail=e.userEmail,this.date=e.date,this.ip=e.ip,this.type=e.type,this.installationId=e.installationId,this.systemUser=e.systemUser,this.serviceAccountId=e.serviceAccountId}}}}]);
//# sourceMappingURL=838.71f9ce66bb518d55337b.js.map