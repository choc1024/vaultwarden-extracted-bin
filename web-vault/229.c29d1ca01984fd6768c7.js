"use strict";(self.webpackChunk_bitwarden_web_vault=self.webpackChunk_bitwarden_web_vault||[]).push([[229],{99229:function(t,e,i){i.d(e,{Y:function(){return k}});var n=i(58691),o=i(72407),r=i(75115),s=i(85762),l=i(78627),a=i(99721),c=i(87483),u=i(46811),p=i(66459),d=i(65071),f=i(53481),g=i(73369),h=i(28508),y=i(56945),b=i(46246),m=i(36338),x=i(81974),_=i(24083),U=i(81168),Z=i(24637),v=i(11512),w=i(54666),A=i(1e4),T=i(36179),F=i(44358),E=i(21656),q=i(21500),I=i(66079),P=i(28975),S=i(30469),O=i(58618),z=i(80263),Q=i(82933);function J(t,e){1&t&&(s.TgZ(0,"bit-callout",7),s.ALo(1,"i18n"),s._uU(2),s.ALo(3,"i18n"),s.qZA()),2&t&&(s.s9C("title",s.lcZ(1,2,"vaultExportDisabled")),s.xp6(2),s.hij("\n      ",s.lcZ(3,4,"personalVaultExportPolicyInEffect"),"\n    "))}function C(t,e){if(1&t&&s._UZ(0,"tools-export-scope-callout",8),2&t){const t=s.oxw();s.Q6J("organizationId",t.organizationId)}}function N(t,e){if(1&t&&s._UZ(0,"bit-option",12),2&t){const t=e.$implicit;s.Q6J("value",t.id)("label",t.name)}}function Y(t,e){if(1&t&&(s.TgZ(0,"bit-form-field"),s._uU(1,"\n        "),s.TgZ(2,"bit-label"),s._uU(3),s.ALo(4,"i18n"),s.qZA(),s._uU(5,"\n        "),s.TgZ(6,"bit-select",9),s._uU(7,"\n          "),s._UZ(8,"bit-option",10),s.ALo(9,"i18n"),s._uU(10,"\n          "),s.YNc(11,N,1,2,"bit-option",11),s.ALo(12,"async"),s._uU(13,"\n        "),s.qZA(),s._uU(14,"\n      "),s.qZA()),2&t){const t=s.oxw(2);s.xp6(3),s.Oqu(s.lcZ(4,3,"exportFrom")),s.xp6(5),s.Q6J("label",s.lcZ(9,5,"myVault")),s.xp6(3),s.Q6J("ngForOf",s.lcZ(12,7,t.organizations$))}}function L(t,e){if(1&t&&(s.ynx(0),s._uU(1,"\n      "),s.YNc(2,Y,15,9,"bit-form-field",3),s._uU(3,"\n    "),s.BQk()),2&t){const t=e.ngIf;s.xp6(2),s.Q6J("ngIf",t.length>0)}}function D(t,e){if(1&t&&s._UZ(0,"bit-option",13),2&t){const t=e.$implicit;s.Q6J("value",t.value)("label",t.name)}}function V(t,e){if(1&t){const t=s.EpF();s.ynx(0),s._uU(1,"\n        "),s.TgZ(2,"div",17),s._uU(3,"\n          "),s.TgZ(4,"bit-form-field"),s._uU(5,"\n            "),s.TgZ(6,"bit-label"),s._uU(7),s.ALo(8,"i18n"),s.qZA(),s._uU(9,"\n            "),s._UZ(10,"input",18),s._uU(11,"\n            "),s.TgZ(12,"button",19),s.NdJ("toggledChange",(function(e){s.CHM(t);const i=s.oxw(2);return s.KtG(i.showFilePassword=e)})),s.qZA(),s._uU(13,"\n            "),s.TgZ(14,"bit-hint"),s._uU(15),s.ALo(16,"i18n"),s.qZA(),s._uU(17,"\n          "),s.qZA(),s._uU(18,"\n          "),s.TgZ(19,"app-password-strength",20),s._uU(20,"\n          "),s.qZA(),s._uU(21,"\n        "),s.qZA(),s._uU(22,"\n        "),s.TgZ(23,"bit-form-field"),s._uU(24,"\n          "),s.TgZ(25,"bit-label"),s._uU(26),s.ALo(27,"i18n"),s.qZA(),s._uU(28,"\n          "),s._UZ(29,"input",21),s._uU(30,"\n          "),s.TgZ(31,"button",19),s.NdJ("toggledChange",(function(e){s.CHM(t);const i=s.oxw(2);return s.KtG(i.showFilePassword=e)})),s.qZA(),s._uU(32,"\n        "),s.qZA(),s._uU(33,"\n      "),s.BQk()}if(2&t){const t=s.oxw(2);s.xp6(7),s.Oqu(s.lcZ(8,7,"filePassword")),s.xp6(5),s.Q6J("toggled",t.showFilePassword),s.xp6(3),s.Oqu(s.lcZ(16,9,"exportPasswordDescription")),s.xp6(4),s.Q6J("password",t.filePassword)("showText",!0),s.xp6(7),s.Oqu(s.lcZ(27,11,"confirmFilePassword")),s.xp6(5),s.Q6J("toggled",t.showFilePassword)}}function B(t,e){if(1&t&&(s.ynx(0),s._uU(1,"\n      "),s.TgZ(2,"bit-radio-group",14),s._uU(3,"\n        "),s.TgZ(4,"bit-label"),s._uU(5),s.ALo(6,"i18n"),s.qZA(),s._uU(7,"\n\n        "),s.TgZ(8,"bit-radio-button",15),s._uU(9,"\n          "),s.TgZ(10,"bit-label"),s._uU(11),s.ALo(12,"i18n"),s.qZA(),s._uU(13,"\n          "),s.TgZ(14,"bit-hint"),s._uU(15),s.ALo(16,"i18n"),s.qZA(),s._uU(17,"\n        "),s.qZA(),s._uU(18,"\n\n        "),s.TgZ(19,"bit-radio-button",16),s._uU(20,"\n          "),s.TgZ(21,"bit-label"),s._uU(22),s.ALo(23,"i18n"),s.qZA(),s._uU(24,"\n          "),s.TgZ(25,"bit-hint"),s._uU(26),s.ALo(27,"i18n"),s.qZA(),s._uU(28,"\n        "),s.qZA(),s._uU(29,"\n      "),s.qZA(),s._uU(30,"\n\n      "),s.YNc(31,V,34,13,"ng-container",3),s._uU(32,"\n    "),s.BQk()),2&t){const t=s.oxw();s.xp6(5),s.Oqu(s.lcZ(6,8,"exportTypeHeading")),s.xp6(3),s.Q6J("value",t.encryptedExportType.AccountEncrypted),s.xp6(3),s.Oqu(s.lcZ(12,10,"accountRestricted")),s.xp6(4),s.Oqu(s.lcZ(16,12,"accountRestrictedOptionDescription")),s.xp6(4),s.Q6J("value",t.encryptedExportType.FileEncrypted),s.xp6(3),s.Oqu(s.lcZ(23,14,"passwordProtected")),s.xp6(4),s.Oqu(s.lcZ(27,16,"passwordProtectedOptionDescription")),s.xp6(5),s.Q6J("ngIf",t.fileEncryptionType==t.encryptedExportType.FileEncrypted)}}class k extends r.Y{constructor(t,e,i,n,o,r,s,l,a,c){super(t,e,i,n,o,r,s,l,a,c)}saved(){super.saved(),this.platformUtilsService.showToast("success",null,this.i18nService.t("exportSuccess"))}}k.ɵfac=function(t){return new(t||k)(s.Y36(l.D),s.Y36(a.P),s.Y36(o.qX),s.Y36(c.j),s.Y36(u.d),s.Y36(p.$),s.Y36(d.QS),s.Y36(f._),s.Y36(g.x),s.Y36(n.Mn))},k.ɵcmp=s.Xpm({type:k,selectors:[["app-export"]],features:[s.qOj],decls:33,vars:16,consts:[[3,"formGroup","bitSubmit"],["type","danger",3,"title",4,"ngIf"],[3,"organizationId",4,"ngIf"],[4,"ngIf"],["formControlName","format"],[3,"value","label",4,"ngFor","ngForOf"],["bitButton","","bitFormButton","","type","submit","buttonType","primary",3,"disabled"],["type","danger",3,"title"],[3,"organizationId"],["formControlName","vaultSelector"],["value","myVault","icon","bwi-user",3,"label"],["icon","bwi-business",3,"value","label",4,"ngFor","ngForOf"],["icon","bwi-business",3,"value","label"],[3,"value","label"],["formControlName","fileEncryptionType","aria-label","exportTypeHeading"],["id","AccountEncrypted","name","fileEncryptionType","checked","fileEncryptionType === encryptedExportType.AccountEncrypted",1,"tw-block",3,"value"],["id","FileEncrypted","name","fileEncryptionType","checked","fileEncryptionType === encryptedExportType.FileEncrypted",1,"tw-block",3,"value"],[1,"tw-mb-3"],["bitInput","","type","password","id","filePassword","formControlName","filePassword","name","password"],["type","button","bitSuffix","","bitIconButton","","bitPasswordInputToggle","",3,"toggled","toggledChange"],[3,"password","showText"],["bitInput","","type","password","id","confirmFilePassword","formControlName","confirmFilePassword","name","confirmFilePassword"]],template:function(t,e){1&t&&(s._UZ(0,"app-header"),s._uU(1,"\n\n"),s.TgZ(2,"bit-container"),s._uU(3,"\n  "),s.TgZ(4,"form",0),s._uU(5,"\n    "),s.YNc(6,J,4,6,"bit-callout",1),s._uU(7,"\n    "),s.YNc(8,C,1,1,"tools-export-scope-callout",2),s._uU(9,"\n\n    "),s.YNc(10,L,4,1,"ng-container",3),s.ALo(11,"async"),s._uU(12,"\n\n    "),s.TgZ(13,"bit-form-field"),s._uU(14,"\n      "),s.TgZ(15,"bit-label"),s._uU(16),s.ALo(17,"i18n"),s.qZA(),s._uU(18,"\n      "),s.TgZ(19,"bit-select",4),s._uU(20,"\n        "),s.YNc(21,D,1,2,"bit-option",5),s._uU(22,"\n      "),s.qZA(),s._uU(23,"\n    "),s.qZA(),s._uU(24,"\n\n    "),s.YNc(25,B,33,18,"ng-container",3),s._uU(26,"\n\n    "),s.TgZ(27,"button",6),s._uU(28),s.ALo(29,"i18n"),s.qZA(),s._uU(30,"\n  "),s.qZA(),s._uU(31,"\n"),s.qZA(),s._uU(32,"\n")),2&t&&(s.xp6(4),s.Q6J("formGroup",e.exportForm)("bitSubmit",e.submit),s.xp6(2),s.Q6J("ngIf",e.disabledByPolicy),s.xp6(2),s.Q6J("ngIf",!e.disabledByPolicy),s.xp6(2),s.Q6J("ngIf",s.lcZ(11,10,e.organizations$)),s.xp6(6),s.Oqu(s.lcZ(17,12,"fileFormat")),s.xp6(5),s.Q6J("ngForOf",e.formatOptions),s.xp6(4),s.Q6J("ngIf","encrypted_json"===e.format),s.xp6(2),s.Q6J("disabled",e.disabledByPolicy),s.xp6(1),s.hij("\n      ",s.lcZ(29,14,"confirmFormat"),"\n    "))},dependencies:[h.sg,h.O5,d._Y,d.Fj,d.JJ,d.JL,d.sg,d.u,y.Z,b.b,m.u,x.r,_.O,U.e,Z.d,v.G,w.w,A.e,T.u,F.M,E.Q,q._,I.w,P.H,S.x,O.k,z.N,h.Ov,Q.C],encapsulation:2})},80263:function(t,e,i){i.d(e,{N:function(){return h}});var n=i(28508),o=i(99042),r=i(92786),s=i(5344),l=i(58691),a=i(7266),c=i(85762),u=i(47724),p=i(82933),d=i(24083),f=function(t,e,i,n){return new(i||(i=Promise))((function(o,r){function s(t){try{a(n.next(t))}catch(e){r(e)}}function l(t){try{a(n.throw(t))}catch(e){r(e)}}function a(t){var e;t.done?o(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,l)}a((n=n.apply(t,e||[])).next())}))};function g(t,e){if(1&t&&(c.ynx(0),c._uU(1,"\n  "),c.TgZ(2,"bit-callout",1),c.ALo(3,"i18n"),c._uU(4),c.ALo(5,"i18n"),c.qZA(),c._uU(6,"\n"),c.BQk()),2&t){const t=c.oxw();c.xp6(2),c.s9C("title",c.lcZ(3,2,t.scopeConfig.title)),c.xp6(2),c.hij("\n    ",c.xi3(5,4,t.scopeConfig.description,t.scopeConfig.scopeIdentifier),"\n  ")}}class h{get organizationId(){return this._organizationId}set organizationId(t){this._organizationId=t,this.getScopeMessage(this._organizationId)}constructor(t,e){this.organizationService=t,this.accountService=e,this.show=!1}ngOnInit(){return f(this,void 0,void 0,(function*(){(yield this.organizationService.hasOrganizations())&&(yield this.getScopeMessage(this.organizationId),this.show=!0)}))}getScopeMessage(t){return f(this,void 0,void 0,(function*(){this.scopeConfig=null!=t?{title:"exportingOrganizationVaultTitle",description:"exportingOrganizationVaultDesc",scopeIdentifier:(yield this.organizationService.get(t)).name}:{title:"exportingPersonalVaultTitle",description:"exportingIndividualVaultDescription",scopeIdentifier:yield(0,o.z)(this.accountService.activeAccount$.pipe((0,r.U)((t=>null==t?void 0:t.email))))}}))}}h.ɵfac=function(t){return new(t||h)(c.Y36(l.Mn),c.Y36(u.BR))},h.ɵcmp=c.Xpm({type:h,selectors:[["tools-export-scope-callout"]],inputs:{organizationId:"organizationId"},standalone:!0,features:[c.jDz],decls:2,vars:1,consts:[[4,"ngIf"],["type","info",3,"title"]],template:function(t,e){1&t&&(c.YNc(0,g,7,7,"ng-container",0),c._uU(1,"\n")),2&t&&c.Q6J("ngIf",e.show)},dependencies:[n.ez,n.O5,s.b,p.C,a.d,d.O],encapsulation:2})},75115:function(t,e,i){i.d(e,{Y:function(){return ot},N:function(){return E.N}});var n,o=i(28508),r=i(85762),s=i(65071),l=i(54019),a=i(68362),c=i(62324),u=i(53634),p=i(92786),d=i(5344),f=i(56945),g=i(82245),h=i(58691),y=i(92614),b=i(51303),m=i(27646);!function(t){t[t.AccountEncrypted=0]="AccountEncrypted",t[t.FileEncrypted=1]="FileEncrypted"}(n||(n={}));var x=i(36338),_=i(49106),U=i(2012),Z=i(40925),v=i(41938),w=i(31393),A=i(7266),T=i(20953),F=i(72407),E=i(80263),q=i(78627),I=i(99721),P=i(87483),S=i(46811),O=i(66459),z=i(53481),Q=i(73369),J=i(82933),C=i(24637),N=i(11512),Y=i(54666),L=i(1e4),D=i(36179),V=i(44358),B=i(21656),k=i(28975),j=i(30469),$=i(24083),M=i(21500),G=i(66079),H=function(t,e,i,n){return new(i||(i=Promise))((function(o,r){function s(t){try{a(n.next(t))}catch(e){r(e)}}function l(t){try{a(n.throw(t))}catch(e){r(e)}}function a(t){var e;t.done?o(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,l)}a((n=n.apply(t,e||[])).next())}))};function R(t,e){1&t&&(r.TgZ(0,"bit-callout",6),r.ALo(1,"i18n"),r._uU(2),r.ALo(3,"i18n"),r.qZA()),2&t&&(r.s9C("title",r.lcZ(1,2,"vaultExportDisabled")),r.xp6(2),r.hij("\n  ",r.lcZ(3,4,"personalVaultExportPolicyInEffect"),"\n"))}function K(t,e){if(1&t&&r._UZ(0,"tools-export-scope-callout",7),2&t){const t=r.oxw();r.Q6J("organizationId",t.organizationId)}}function X(t,e){if(1&t&&r._UZ(0,"bit-option",11),2&t){const t=e.$implicit;r.Q6J("value",t.id)("label",t.name)}}function W(t,e){if(1&t&&(r.TgZ(0,"bit-form-field"),r._uU(1,"\n      "),r.TgZ(2,"bit-label"),r._uU(3),r.ALo(4,"i18n"),r.qZA(),r._uU(5,"\n      "),r.TgZ(6,"bit-select",8),r._uU(7,"\n        "),r._UZ(8,"bit-option",9),r.ALo(9,"i18n"),r._uU(10,"\n        "),r.YNc(11,X,1,2,"bit-option",10),r.ALo(12,"async"),r._uU(13,"\n      "),r.qZA(),r._uU(14,"\n    "),r.qZA()),2&t){const t=r.oxw(2);r.xp6(3),r.Oqu(r.lcZ(4,3,"exportFrom")),r.xp6(5),r.Q6J("label",r.lcZ(9,5,"myVault")),r.xp6(3),r.Q6J("ngForOf",r.lcZ(12,7,t.organizations$))}}function tt(t,e){if(1&t&&(r.ynx(0),r._uU(1,"\n    "),r.YNc(2,W,15,9,"bit-form-field",3),r._uU(3,"\n  "),r.BQk()),2&t){const t=e.ngIf;r.xp6(2),r.Q6J("ngIf",t.length>0)}}function et(t,e){if(1&t&&r._UZ(0,"bit-option",12),2&t){const t=e.$implicit;r.Q6J("value",t.value)("label",t.name)}}function it(t,e){if(1&t){const t=r.EpF();r.ynx(0),r._uU(1,"\n      "),r.TgZ(2,"div",16),r._uU(3,"\n        "),r.TgZ(4,"bit-form-field"),r._uU(5,"\n          "),r.TgZ(6,"bit-label"),r._uU(7),r.ALo(8,"i18n"),r.qZA(),r._uU(9,"\n          "),r._UZ(10,"input",17),r._uU(11,"\n          "),r.TgZ(12,"button",18),r.NdJ("toggledChange",(function(e){r.CHM(t);const i=r.oxw(2);return r.KtG(i.showFilePassword=e)})),r.qZA(),r._uU(13,"\n          "),r.TgZ(14,"bit-hint"),r._uU(15),r.ALo(16,"i18n"),r.qZA(),r._uU(17,"\n        "),r.qZA(),r._uU(18,"\n        "),r.TgZ(19,"app-password-strength",19),r._uU(20," "),r.qZA(),r._uU(21,"\n      "),r.qZA(),r._uU(22,"\n      "),r.TgZ(23,"bit-form-field"),r._uU(24,"\n        "),r.TgZ(25,"bit-label"),r._uU(26),r.ALo(27,"i18n"),r.qZA(),r._uU(28,"\n        "),r._UZ(29,"input",20),r._uU(30,"\n        "),r.TgZ(31,"button",18),r.NdJ("toggledChange",(function(e){r.CHM(t);const i=r.oxw(2);return r.KtG(i.showFilePassword=e)})),r.qZA(),r._uU(32,"\n      "),r.qZA(),r._uU(33,"\n    "),r.BQk()}if(2&t){const t=r.oxw(2);r.xp6(7),r.Oqu(r.lcZ(8,7,"filePassword")),r.xp6(5),r.Q6J("toggled",t.showFilePassword),r.xp6(3),r.Oqu(r.lcZ(16,9,"exportPasswordDescription")),r.xp6(4),r.Q6J("password",t.filePassword)("showText",!0),r.xp6(7),r.Oqu(r.lcZ(27,11,"confirmFilePassword")),r.xp6(5),r.Q6J("toggled",t.showFilePassword)}}function nt(t,e){if(1&t&&(r.ynx(0),r._uU(1,"\n    "),r.TgZ(2,"bit-radio-group",13),r._uU(3,"\n      "),r.TgZ(4,"bit-label"),r._uU(5),r.ALo(6,"i18n"),r.qZA(),r._uU(7,"\n\n      "),r.TgZ(8,"bit-radio-button",14),r._uU(9,"\n        "),r.TgZ(10,"bit-label"),r._uU(11),r.ALo(12,"i18n"),r.qZA(),r._uU(13,"\n        "),r.TgZ(14,"bit-hint"),r._uU(15),r.ALo(16,"i18n"),r.qZA(),r._uU(17,"\n      "),r.qZA(),r._uU(18,"\n\n      "),r.TgZ(19,"bit-radio-button",15),r._uU(20,"\n        "),r.TgZ(21,"bit-label"),r._uU(22),r.ALo(23,"i18n"),r.qZA(),r._uU(24,"\n        "),r.TgZ(25,"bit-hint"),r._uU(26),r.ALo(27,"i18n"),r.qZA(),r._uU(28,"\n      "),r.qZA(),r._uU(29,"\n    "),r.qZA(),r._uU(30,"\n\n    "),r.YNc(31,it,34,13,"ng-container",3),r._uU(32,"\n  "),r.BQk()),2&t){const t=r.oxw();r.xp6(5),r.Oqu(r.lcZ(6,8,"exportTypeHeading")),r.xp6(3),r.Q6J("value",t.encryptedExportType.AccountEncrypted),r.xp6(3),r.Oqu(r.lcZ(12,10,"accountRestricted")),r.xp6(4),r.Oqu(r.lcZ(16,12,"accountRestrictedOptionDescription")),r.xp6(4),r.Q6J("value",t.encryptedExportType.FileEncrypted),r.xp6(3),r.Oqu(r.lcZ(23,14,"passwordProtected")),r.xp6(4),r.Oqu(r.lcZ(27,16,"passwordProtectedOptionDescription")),r.xp6(5),r.Q6J("ngIf",t.fileEncryptionType==t.encryptedExportType.FileEncrypted)}}class ot{get disabledByPolicy(){return this._disabledByPolicy}constructor(t,e,i,o,a,c,u,p,d,f){this.i18nService=t,this.platformUtilsService=e,this.exportService=i,this.eventCollectionService=o,this.policyService=a,this.logService=c,this.formBuilder=u,this.fileDownloadService=p,this.dialogService=d,this.organizationService=f,this.formLoading=new r.vpe,this.formDisabled=new r.vpe,this.onSuccessfulExport=new r.vpe,this.onSaved=new r.vpe,this.encryptedExportType=n,this.filePasswordValue=null,this._disabledByPolicy=!1,this.organizationId=null,this.exportForm=this.formBuilder.group({vaultSelector:["myVault",{nonNullable:!0,validators:[s.kI.required]}],format:["json",s.kI.required],secret:[""],filePassword:["",s.kI.required],confirmFilePassword:["",s.kI.required],fileEncryptionType:[n.AccountEncrypted]}),this.formatOptions=[{name:".json",value:"json"},{name:".csv",value:"csv"},{name:".json (Encrypted)",value:"encrypted_json"}],this.destroy$=new l.x,this.submit=()=>H(this,void 0,void 0,(function*(){if(this.isFileEncryptedExport&&this.filePassword!=this.confirmFilePassword)return void this.platformUtilsService.showToast("error",this.i18nService.t("errorOccurred"),this.i18nService.t("filePasswordAndConfirmFilePasswordDoNotMatch"));if(this.exportForm.markAllAsTouched(),this.exportForm.invalid)return;if(this.disabledByPolicy)return void this.platformUtilsService.showToast("error",null,this.i18nService.t("personalVaultExportPolicyInEffect"));(yield this.verifyUser())&&(yield this.doExport())}))}ngOnInit(){return H(this,void 0,void 0,(function*(){if(this.exportForm.statusChanges.pipe((0,a.R)(this.destroy$)).subscribe((t=>{this.formDisabled.emit("DISABLED"===t)})),this.policyService.policyAppliesToActiveUser$(y.Mi.DisablePersonalVaultExport).pipe((0,a.R)(this.destroy$)).subscribe((t=>{this._disabledByPolicy=t,this.disabledByPolicy&&this.exportForm.disable()})),(0,c.T)(this.exportForm.get("format").valueChanges,this.exportForm.get("fileEncryptionType").valueChanges).pipe((0,u.O)(0),(0,a.R)(this.destroy$)).subscribe((()=>this.adjustValidators())),this.organizationId)return this.organizations$=this.organizationService.memberOrganizations$.pipe((0,p.U)((t=>t.filter((t=>t.id==this.organizationId))))),this.exportForm.controls.vaultSelector.patchValue(this.organizationId),void this.exportForm.controls.vaultSelector.disable();this.organizations$=this.organizationService.memberOrganizations$.pipe((0,p.U)((t=>t.filter((t=>t.flexibleCollections)).sort(m.c.getSortFunction(this.i18nService,"name"))))),this.exportForm.controls.vaultSelector.valueChanges.pipe((0,a.R)(this.destroy$)).subscribe((t=>{this.organizationId="myVault"!=t?t:void 0})),this.exportForm.controls.vaultSelector.setValue("myVault")}))}ngAfterViewInit(){this.bitSubmit.loading$.pipe((0,a.R)(this.destroy$)).subscribe((t=>{this.formLoading.emit(t)}))}ngOnDestroy(){this.destroy$.next()}get encryptedFormat(){return"encrypted_json"===this.format}get isFileEncryptedExport(){return"encrypted_json"===this.format&&this.fileEncryptionType===n.FileEncrypted}get isAccountEncryptedExport(){return"encrypted_json"===this.format&&this.fileEncryptionType===n.AccountEncrypted}doExport(){return H(this,void 0,void 0,(function*(){try{const t=yield this.getExportData();this.downloadFile(t),this.saved(),yield this.collectEvent(),this.exportForm.get("secret").setValue(""),this.exportForm.clearValidators()}catch(t){this.logService.error(t)}}))}saved(){this.onSaved.emit(),this.onSuccessfulExport.emit(this.organizationId)}verifyUser(){return H(this,void 0,void 0,(function*(){let t="exportWarningDesc";this.isFileEncryptedExport?t="fileEncryptedExportWarningDesc":this.isAccountEncryptedExport&&(t="encExportKeyWarningDesc");const e=yield g.NK.open(this.dialogService,{title:"confirmVaultExport",bodyText:t,confirmButtonOptions:{text:"exportVault",type:"primary"}});return"cancel"!==e.userAction&&(!!e.verificationSuccess||(e.noAvailableClientVerificationMethods,!1))}))}getExportData(){return H(this,void 0,void 0,(function*(){return m.c.isNullOrWhitespace(this.organizationId)?this.exportService.getExport(this.format,this.filePassword):this.exportService.getOrganizationExport(this.organizationId,this.format,this.filePassword,!0)}))}getFileName(t){this.organizationId&&(t="org");let e=this.format;return"encrypted_json"===this.format&&(t=null==t?"encrypted":"encrypted_"+t,e="json"),this.exportService.getFileName(t,e)}collectEvent(){return H(this,void 0,void 0,(function*(){return this.organizationId?yield this.eventCollectionService.collect(b.tw.Organization_ClientExportedVault,null,!1,this.organizationId):yield this.eventCollectionService.collect(b.tw.User_ClientExportedVault)}))}get format(){return this.exportForm.get("format").value}get filePassword(){return this.exportForm.get("filePassword").value}get confirmFilePassword(){return this.exportForm.get("confirmFilePassword").value}get fileEncryptionType(){return this.exportForm.get("fileEncryptionType").value}adjustValidators(){this.exportForm.get("confirmFilePassword").reset(),this.exportForm.get("filePassword").reset(),this.encryptedFormat&&this.fileEncryptionType==n.FileEncrypted?(this.exportForm.controls.filePassword.enable(),this.exportForm.controls.confirmFilePassword.enable()):(this.exportForm.controls.filePassword.disable(),this.exportForm.controls.confirmFilePassword.disable())}downloadFile(t){const e=this.getFileName();this.fileDownloadService.download({fileName:e,blobData:t,blobOptions:{type:"text/plain"}})}}ot.ɵfac=function(t){return new(t||ot)(r.Y36(q.D),r.Y36(I.P),r.Y36(F.qX),r.Y36(P.j),r.Y36(S.d),r.Y36(O.$),r.Y36(s.QS),r.Y36(z._),r.Y36(Q.x),r.Y36(h.Mn))},ot.ɵcmp=r.Xpm({type:ot,selectors:[["tools-export"]],viewQuery:function(t,e){if(1&t&&(r.Gf(x.u,5),r.Gf(f.Z,5)),2&t){let t;r.iGM(t=r.CRH())&&(e.bitSubmit=t.first),r.iGM(t=r.CRH())&&(e.passwordStrengthComponent=t.first)}},outputs:{formLoading:"formLoading",formDisabled:"formDisabled",onSuccessfulExport:"onSuccessfulExport",onSaved:"onSaved"},standalone:!0,features:[r.jDz],decls:24,vars:12,consts:[["type","danger",3,"title",4,"ngIf"],[3,"organizationId",4,"ngIf"],["id","export_form_exportForm",3,"formGroup","bitSubmit"],[4,"ngIf"],["formControlName","format"],[3,"value","label",4,"ngFor","ngForOf"],["type","danger",3,"title"],[3,"organizationId"],["formControlName","vaultSelector"],["value","myVault","icon","bwi-user",3,"label"],["icon","bwi-business",3,"value","label",4,"ngFor","ngForOf"],["icon","bwi-business",3,"value","label"],[3,"value","label"],["formControlName","fileEncryptionType","aria-label","exportTypeHeading"],["id","AccountEncrypted","name","fileEncryptionType","checked","fileEncryptionType === encryptedExportType.AccountEncrypted",1,"tw-block",3,"value"],["id","FileEncrypted","name","fileEncryptionType","checked","fileEncryptionType === encryptedExportType.FileEncrypted",1,"tw-block",3,"value"],[1,"tw-mb-3"],["bitInput","","type","password","id","filePassword","formControlName","filePassword","name","password"],["type","button","bitSuffix","","bitIconButton","","bitPasswordInputToggle","",3,"toggled","toggledChange"],[3,"password","showText"],["bitInput","","type","password","id","confirmFilePassword","formControlName","confirmFilePassword","name","confirmFilePassword"]],template:function(t,e){1&t&&(r.YNc(0,R,4,6,"bit-callout",0),r._uU(1,"\n"),r.YNc(2,K,1,1,"tools-export-scope-callout",1),r._uU(3,"\n\n"),r.TgZ(4,"form",2),r._uU(5,"\n  "),r.YNc(6,tt,4,1,"ng-container",3),r.ALo(7,"async"),r._uU(8,"\n\n  "),r.TgZ(9,"bit-form-field"),r._uU(10,"\n    "),r.TgZ(11,"bit-label"),r._uU(12),r.ALo(13,"i18n"),r.qZA(),r._uU(14,"\n    "),r.TgZ(15,"bit-select",4),r._uU(16,"\n      "),r.YNc(17,et,1,2,"bit-option",5),r._uU(18,"\n    "),r.qZA(),r._uU(19,"\n  "),r.qZA(),r._uU(20,"\n\n  "),r.YNc(21,nt,33,18,"ng-container",3),r._uU(22,"\n"),r.qZA(),r._uU(23,"\n")),2&t&&(r.Q6J("ngIf",e.disabledByPolicy),r.xp6(2),r.Q6J("ngIf",!e.disabledByPolicy),r.xp6(2),r.Q6J("formGroup",e.exportForm)("bitSubmit",e.submit),r.xp6(2),r.Q6J("ngIf",r.lcZ(7,8,e.organizations$)),r.xp6(6),r.Oqu(r.lcZ(13,10,"fileFormat")),r.xp6(5),r.Q6J("ngForOf",e.formatOptions),r.xp6(4),r.Q6J("ngIf","encrypted_json"===e.format))},dependencies:[o.ez,o.sg,o.O5,o.Ov,s.UX,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,d.b,f.Z,J.C,_.k,C.d,N.G,Y.w,L.e,D.u,V.M,U.G,x.u,Z.h,v.v,B.Q,w.A,k.H,j.x,A.d,$.O,T.c,M._,G.w,E.N],encapsulation:2})}}]);
//# sourceMappingURL=229.c29d1ca01984fd6768c7.js.map